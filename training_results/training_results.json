{
  "total_configs": 24,
  "successful": 23,
  "failed": 1,
  "success_rate": 95.83333333333334,
  "successful_configs": [
    "config_base",
    "config_base_mean",
    "config_base_quantiles",
    "config_base_shuffled",
    "config_base_std",
    "config_base_stdandmean",
    "config_normalized",
    "config_normalized_mean",
    "config_normalized_shuffled",
    "config_normalized_std",
    "config_normalized_stdandmean",
    "config_zeromean",
    "config_zeromean_mean",
    "config_zeromean_normalized",
    "config_zeromean_normalized_mean",
    "config_zeromean_normalized_quantiles",
    "config_zeromean_normalized_shuffled",
    "config_zeromean_normalized_std",
    "config_zeromean_normalized_stdandmean",
    "config_zeromean_quantiles",
    "config_zeromean_shuffled",
    "config_zeromean_std",
    "config_zeromean_stdandmean"
  ],
  "failed_configs": [
    "config_normalized_quantiles"
  ],
  "detailed_results": {
    "config_base": {
      "config_name": "config_base",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base.conf",
      "start_time": 1764709043.0911138,
      "status": "success",
      "duration": 91.81378054618835,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 20:57:25,396 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 20:57:25,397 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base.conf\n2025-12-02 20:57:25,398 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=False, aggregation=None\n2025-12-02 20:57:25,398 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 20:57:25,398 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 20:57:25,398 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 20:57:25,398 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 20:57:25,399 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 20:57:25,399 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base.conf\n2025-12-02 20:57:25,399 - __main__ - INFO - Training Configuration:\n2025-12-02 20:57:25,399 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 20:57:25,399 - __main__ - INFO -   Patch size: 10\n2025-12-02 20:57:25,399 - __main__ - INFO -   Batch size: 32\n2025-12-02 20:57:25,399 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 20:57:25,399 - __main__ - INFO -   Optimizer: adam\n2025-12-02 20:57:25,899 - __main__ - INFO - Using device: cuda\n2025-12-02 20:57:25,900 - __main__ - INFO - Using config hash: 0f3b0fea\n2025-12-02 20:57:25,900 - __main__ - INFO - Using run ID: 0f3b0fea\n2025-12-02 20:57:25,900 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea\n2025-12-02 20:57:25,909 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/config_0f3b0fea.json\n2025-12-02 20:57:25,911 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 20:57:25,914 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 20:57:26,885 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 20:57:27,082 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 20:57:27,091 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 20:57:27,091 - __main__ - INFO - Preparing data...\n2025-12-02 20:57:27,091 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 20:57:27,091 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 20:57:27,091 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 20:57:38,144 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 20:57:38,145 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 20:57:38,145 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 20:57:38,713 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 20:57:39,720 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 20:57:39,720 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 20:57:39,726 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 20:57:39,726 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 20:57:39,730 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 20:57:39,730 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 20:57:39,730 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 20:57:39,730 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 20:57:39,732 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 20:57:39,732 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 20:57:39,749 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 20:57:39,749 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 20:57:39,750 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 20:57:39,750 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 20:57:39,754 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 20:57:39,754 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 20:57:39,755 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 20:57:39,758 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 20:57:39,758 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 20:57:39,758 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 20:57:39,762 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 20:57:39,762 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 20:57:39,762 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 20:57:39,765 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 20:57:39,765 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 20:57:39,775 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 20:57:39,778 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 20:57:39,788 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 20:57:39,791 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 20:57:39,791 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 20:57:39,792 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 20:57:39,793 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 20:57:39,802 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 20:57:39,804 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 20:57:39,814 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 20:57:39,818 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 20:57:39,828 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 20:57:39,829 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 20:57:39,836 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 20:57:39,836 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 20:57:39,836 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 20:57:39,837 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 20:57:39,837 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 20:57:39,837 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 20:57:39,837 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 20:57:39,837 - __main__ - INFO - Loading train dataset...\n2025-12-02 20:57:39,837 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 20:57:39,989 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 20:57:40,950 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 20:57:41,491 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 20:57:41,553 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 20:57:41,569 - __main__ - INFO - Loaded 67828 train patches in 1.73s\n2025-12-02 20:57:41,572 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 20:57:41,572 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 20:57:41,572 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 20:57:41,577 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 20:57:41,584 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 20:57:41,590 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 20:57:41,596 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 20:57:41,664 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 20:57:41,736 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 20:57:41,736 - __main__ - INFO - Total available patches: 27408\n2025-12-02 20:57:41,736 - __main__ - INFO - Loading validation dataset...\n2025-12-02 20:57:41,736 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 20:57:41,748 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 20:57:42,113 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 20:57:42,207 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 20:57:42,225 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 20:57:42,229 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-02 20:57:42,230 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 20:57:42,231 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 20:57:42,231 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 20:57:42,232 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 20:57:42,234 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 20:57:42,236 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 20:57:42,238 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 20:57:42,257 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 20:57:42,272 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 20:57:42,273 - __main__ - INFO - Total available patches: 8572\n2025-12-02 20:57:42,273 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 20:57:42,273 - __main__ - INFO - Training batches: 857\n2025-12-02 20:57:42,273 - __main__ - INFO - Validation batches: 268\n2025-12-02 20:57:42,273 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 20:57:42,273 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 20:57:45,494 - __main__ - INFO - Epoch 1/50 (3.22s): Train Loss: 0.779728, Train Acc: 0.6567, Val Loss: 0.666590, Val Acc: 0.6861\n2025-12-02 20:57:45,508 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_1.pth\n2025-12-02 20:57:45,508 - __main__ - INFO - New best validation accuracy: 0.6861\n2025-12-02 20:57:48,343 - __main__ - INFO - Epoch 2/50 (2.83s): Train Loss: 0.710441, Train Acc: 0.6791, Val Loss: 0.646532, Val Acc: 0.7021\n2025-12-02 20:57:48,356 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_2.pth\n2025-12-02 20:57:48,356 - __main__ - INFO - New best validation accuracy: 0.7021\n2025-12-02 20:57:51,217 - __main__ - INFO - Epoch 3/50 (2.86s): Train Loss: 0.708865, Train Acc: 0.6799, Val Loss: 0.615143, Val Acc: 0.7182\n2025-12-02 20:57:51,230 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_3.pth\n2025-12-02 20:57:51,231 - __main__ - INFO - New best validation accuracy: 0.7182\n2025-12-02 20:57:54,140 - __main__ - INFO - Epoch 4/50 (2.91s): Train Loss: 0.706901, Train Acc: 0.6809, Val Loss: 0.626522, Val Acc: 0.7151\n2025-12-02 20:57:56,934 - __main__ - INFO - Epoch 5/50 (2.79s): Train Loss: 0.703444, Train Acc: 0.6840, Val Loss: 0.632183, Val Acc: 0.7003\n2025-12-02 20:57:59,798 - __main__ - INFO - Epoch 6/50 (2.86s): Train Loss: 0.699574, Train Acc: 0.6864, Val Loss: 0.623455, Val Acc: 0.7136\n2025-12-02 20:58:02,667 - __main__ - INFO - Epoch 7/50 (2.87s): Train Loss: 0.698029, Train Acc: 0.6861, Val Loss: 0.607100, Val Acc: 0.7274\n2025-12-02 20:58:02,679 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_7.pth\n2025-12-02 20:58:02,679 - __main__ - INFO - New best validation accuracy: 0.7274\n2025-12-02 20:58:05,533 - __main__ - INFO - Epoch 8/50 (2.85s): Train Loss: 0.694743, Train Acc: 0.6892, Val Loss: 0.717729, Val Acc: 0.6590\n2025-12-02 20:58:08,474 - __main__ - INFO - Epoch 9/50 (2.94s): Train Loss: 0.694426, Train Acc: 0.6926, Val Loss: 0.610109, Val Acc: 0.7207\n2025-12-02 20:58:11,346 - __main__ - INFO - Epoch 10/50 (2.87s): Train Loss: 0.692712, Train Acc: 0.6911, Val Loss: 0.667305, Val Acc: 0.6903\n2025-12-02 20:58:11,359 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/checkpoint_epoch_10.pth\n2025-12-02 20:58:14,136 - __main__ - INFO - Epoch 11/50 (2.78s): Train Loss: 0.692837, Train Acc: 0.6906, Val Loss: 0.612455, Val Acc: 0.7276\n2025-12-02 20:58:14,148 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_11.pth\n2025-12-02 20:58:14,148 - __main__ - INFO - New best validation accuracy: 0.7276\n2025-12-02 20:58:17,052 - __main__ - INFO - Epoch 12/50 (2.90s): Train Loss: 0.689178, Train Acc: 0.6923, Val Loss: 1.124995, Val Acc: 0.5499\n2025-12-02 20:58:19,753 - __main__ - INFO - Epoch 13/50 (2.70s): Train Loss: 0.691237, Train Acc: 0.6915, Val Loss: 0.681056, Val Acc: 0.6857\n2025-12-02 20:58:22,435 - __main__ - INFO - Epoch 14/50 (2.68s): Train Loss: 0.691391, Train Acc: 0.6922, Val Loss: 0.603397, Val Acc: 0.7339\n2025-12-02 20:58:22,447 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_14.pth\n2025-12-02 20:58:22,448 - __main__ - INFO - New best validation accuracy: 0.7339\n2025-12-02 20:58:25,200 - __main__ - INFO - Epoch 15/50 (2.75s): Train Loss: 0.688807, Train Acc: 0.6914, Val Loss: 0.602418, Val Acc: 0.7205\n2025-12-02 20:58:27,889 - __main__ - INFO - Epoch 16/50 (2.69s): Train Loss: 0.690243, Train Acc: 0.6936, Val Loss: 0.602098, Val Acc: 0.7270\n2025-12-02 20:58:30,655 - __main__ - INFO - Epoch 17/50 (2.76s): Train Loss: 0.685971, Train Acc: 0.6961, Val Loss: 0.775226, Val Acc: 0.6531\n2025-12-02 20:58:33,464 - __main__ - INFO - Epoch 18/50 (2.81s): Train Loss: 0.687874, Train Acc: 0.6922, Val Loss: 0.745665, Val Acc: 0.6638\n2025-12-02 20:58:36,237 - __main__ - INFO - Epoch 19/50 (2.77s): Train Loss: 0.686599, Train Acc: 0.6936, Val Loss: 0.601555, Val Acc: 0.7315\n2025-12-02 20:58:38,940 - __main__ - INFO - Epoch 20/50 (2.70s): Train Loss: 0.689823, Train Acc: 0.6979, Val Loss: 0.684230, Val Acc: 0.6594\n2025-12-02 20:58:38,953 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/checkpoint_epoch_20.pth\n2025-12-02 20:58:41,585 - __main__ - INFO - Epoch 21/50 (2.63s): Train Loss: 0.686984, Train Acc: 0.6933, Val Loss: 0.598304, Val Acc: 0.7308\n2025-12-02 20:58:44,234 - __main__ - INFO - Epoch 22/50 (2.65s): Train Loss: 0.689366, Train Acc: 0.6947, Val Loss: 0.617130, Val Acc: 0.7225\n2025-12-02 20:58:47,196 - __main__ - INFO - Epoch 23/50 (2.96s): Train Loss: 0.689550, Train Acc: 0.6957, Val Loss: 0.621772, Val Acc: 0.7171\n2025-12-02 20:58:49,869 - __main__ - INFO - Epoch 24/50 (2.67s): Train Loss: 0.682916, Train Acc: 0.6981, Val Loss: 0.687828, Val Acc: 0.6875\n2025-12-02 20:58:49,869 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 20:58:49,869 - __main__ - INFO - Training completed in 67.60s\n2025-12-02 20:58:49,869 - __main__ - INFO - Best validation accuracy: 0.7339\n2025-12-02 20:58:50,565 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/training_history_20251202_205849.png\n2025-12-02 20:58:51,288 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/logs/classification_report_20251202_205851.json\n2025-12-02 20:58:51,288 - __main__ - INFO - Classification Results:\n2025-12-02 20:58:51,288 - __main__ - INFO -   Class 1: Precision=0.491, Recall=0.781, F1=0.603\n2025-12-02 20:58:51,288 - __main__ - INFO -   Class 4: Precision=0.897, Recall=0.620, F1=0.733\n2025-12-02 20:58:51,288 - __main__ - INFO -   Class 6: Precision=0.950, Recall=0.911, F1=0.930\n2025-12-02 20:58:51,288 - __main__ - INFO -   Class 12: Precision=0.577, Recall=0.438, F1=0.498\n2025-12-02 20:58:51,520 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/confusion_matrix_20251202_205851.png\n2025-12-02 20:58:51,521 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 20:58:51,521 - __main__ - INFO - Evaluating on test set...\n2025-12-02 20:58:51,521 - __main__ - INFO - Loading test dataset...\n2025-12-02 20:58:51,522 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 20:58:51,536 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 20:58:52,088 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 20:58:52,204 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 20:58:52,236 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 20:58:52,243 - __main__ - INFO - Loaded 22857 test patches in 0.72s\n2025-12-02 20:58:52,245 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 20:58:52,245 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 20:58:52,245 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 20:58:52,246 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 20:58:52,249 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 20:58:52,251 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 20:58:52,253 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 20:58:52,281 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 20:58:52,301 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 20:58:52,301 - __main__ - INFO - Total available patches: 8936\n2025-12-02 20:58:52,301 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 20:58:52,932 - __main__ - INFO - Test Results: Loss=0.693176, Accuracy=0.6799\n2025-12-02 20:58:52,960 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/logs/test_classification_report_20251202_205852.json\n2025-12-02 20:58:53,175 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/test_confusion_matrix_20251202_205852.png\n2025-12-02 20:58:53,207 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/training_summary_20251202_205853.json\n2025-12-02 20:58:53,210 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/latest_results.txt\n2025-12-02 20:58:53,210 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 20:58:53,211 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/training_summary_20251202_205853.json\n2025-12-02 20:58:53,211 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 657792/27408 = 24.0000 (2400.00%)\n2025-12-02 20:58:53,211 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.7339, Test Acc=0.6799\n",
      "return_code": 0
    },
    "config_base_mean": {
      "config_name": "config_base_mean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_mean.conf",
      "start_time": 1764709139.913352,
      "status": "success",
      "duration": 93.10972809791565,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 20:59:02,267 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 20:59:02,268 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_mean.conf\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=False, aggregation=mean\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 20:59:02,270 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 20:59:02,270 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_mean.conf\n2025-12-02 20:59:02,270 - __main__ - INFO - Training Configuration:\n2025-12-02 20:59:02,270 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 20:59:02,270 - __main__ - INFO -   Patch size: 10\n2025-12-02 20:59:02,270 - __main__ - INFO -   Batch size: 32\n2025-12-02 20:59:02,270 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 20:59:02,270 - __main__ - INFO -   Optimizer: adam\n2025-12-02 20:59:02,767 - __main__ - INFO - Using device: cuda\n2025-12-02 20:59:02,768 - __main__ - INFO - Using config hash: d79f17c4\n2025-12-02 20:59:02,768 - __main__ - INFO - Using run ID: d79f17c4\n2025-12-02 20:59:02,768 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4\n2025-12-02 20:59:02,778 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/config_d79f17c4.json\n2025-12-02 20:59:02,786 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 20:59:02,788 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-02 20:59:03,769 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-02 20:59:03,857 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 20:59:03,857 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-02 20:59:03,857 - __main__ - INFO - Preparing data...\n2025-12-02 20:59:03,857 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 20:59:03,857 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 20:59:03,858 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 20:59:15,061 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 20:59:15,061 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 20:59:15,062 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 20:59:15,630 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 20:59:16,651 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 20:59:16,651 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 20:59:16,657 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 20:59:16,657 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 20:59:16,661 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 20:59:16,662 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 20:59:16,662 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 20:59:16,662 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 20:59:16,664 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 20:59:16,664 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 20:59:16,681 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 20:59:16,682 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 20:59:16,682 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 20:59:16,682 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 20:59:16,687 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 20:59:16,687 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 20:59:16,687 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 20:59:16,692 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 20:59:16,692 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 20:59:16,692 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 20:59:16,697 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 20:59:16,697 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 20:59:16,697 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 20:59:16,701 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 20:59:16,701 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 20:59:16,711 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 20:59:16,713 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 20:59:16,724 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 20:59:16,727 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 20:59:16,727 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 20:59:16,728 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 20:59:16,729 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 20:59:16,738 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 20:59:16,741 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 20:59:16,751 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 20:59:16,754 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 20:59:16,765 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 20:59:16,766 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 20:59:16,773 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 20:59:16,773 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 20:59:16,773 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 20:59:16,774 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 20:59:16,774 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 20:59:16,774 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 20:59:16,774 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 20:59:16,774 - __main__ - INFO - Loading train dataset...\n2025-12-02 20:59:16,774 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 20:59:16,926 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 20:59:17,889 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 20:59:18,418 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 20:59:18,480 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 20:59:18,495 - __main__ - INFO - Loaded 67828 train patches in 1.72s\n2025-12-02 20:59:18,498 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 20:59:18,498 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 20:59:18,498 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 20:59:18,502 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 20:59:18,509 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 20:59:18,515 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 20:59:18,521 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 20:59:18,585 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 20:59:18,649 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 20:59:18,649 - __main__ - INFO - Total available patches: 27408\n2025-12-02 20:59:18,649 - __main__ - INFO - Loading validation dataset...\n2025-12-02 20:59:18,649 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 20:59:18,662 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 20:59:19,016 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 20:59:19,111 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 20:59:19,130 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 20:59:19,135 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-02 20:59:19,136 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 20:59:19,136 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 20:59:19,136 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 20:59:19,137 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 20:59:19,140 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 20:59:19,141 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 20:59:19,144 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 20:59:19,163 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 20:59:19,179 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 20:59:19,179 - __main__ - INFO - Total available patches: 8572\n2025-12-02 20:59:19,179 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 20:59:19,179 - __main__ - INFO - Training batches: 857\n2025-12-02 20:59:19,179 - __main__ - INFO - Validation batches: 268\n2025-12-02 20:59:19,179 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 20:59:19,179 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 20:59:21,952 - __main__ - INFO - Epoch 1/50 (2.77s): Train Loss: 1.543391, Train Acc: 0.3163, Val Loss: 1.252596, Val Acc: 0.4801\n2025-12-02 20:59:21,962 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/best_model_epoch_1.pth\n2025-12-02 20:59:21,962 - __main__ - INFO - New best validation accuracy: 0.4801\n2025-12-02 20:59:24,612 - __main__ - INFO - Epoch 2/50 (2.65s): Train Loss: 1.166535, Train Acc: 0.4770, Val Loss: 1.043479, Val Acc: 0.5152\n2025-12-02 20:59:24,621 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/best_model_epoch_2.pth\n2025-12-02 20:59:24,621 - __main__ - INFO - New best validation accuracy: 0.5152\n2025-12-02 20:59:27,191 - __main__ - INFO - Epoch 3/50 (2.57s): Train Loss: 1.024723, Train Acc: 0.5169, Val Loss: 0.946512, Val Acc: 0.5572\n2025-12-02 20:59:27,199 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/best_model_epoch_3.pth\n2025-12-02 20:59:27,200 - __main__ - INFO - New best validation accuracy: 0.5572\n2025-12-02 20:59:29,918 - __main__ - INFO - Epoch 4/50 (2.72s): Train Loss: 0.970171, Train Acc: 0.5332, Val Loss: 0.904281, Val Acc: 0.5742\n2025-12-02 20:59:29,925 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/best_model_epoch_4.pth\n2025-12-02 20:59:29,925 - __main__ - INFO - New best validation accuracy: 0.5742\n2025-12-02 20:59:32,674 - __main__ - INFO - Epoch 5/50 (2.75s): Train Loss: 0.951084, Train Acc: 0.5429, Val Loss: 0.889847, Val Acc: 0.5664\n2025-12-02 20:59:35,516 - __main__ - INFO - Epoch 6/50 (2.84s): Train Loss: 0.944429, Train Acc: 0.5405, Val Loss: 0.888916, Val Acc: 0.5538\n2025-12-02 20:59:38,168 - __main__ - INFO - Epoch 7/50 (2.65s): Train Loss: 0.938908, Train Acc: 0.5434, Val Loss: 0.876625, Val Acc: 0.5687\n2025-12-02 20:59:40,746 - __main__ - INFO - Epoch 8/50 (2.58s): Train Loss: 0.936400, Train Acc: 0.5490, Val Loss: 0.882822, Val Acc: 0.5703\n2025-12-02 20:59:43,199 - __main__ - INFO - Epoch 9/50 (2.45s): Train Loss: 0.935309, Train Acc: 0.5492, Val Loss: 0.874492, Val Acc: 0.5738\n2025-12-02 20:59:45,679 - __main__ - INFO - Epoch 10/50 (2.48s): Train Loss: 0.932885, Train Acc: 0.5502, Val Loss: 0.882794, Val Acc: 0.5573\n2025-12-02 20:59:45,687 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/checkpoint_epoch_10.pth\n2025-12-02 20:59:48,279 - __main__ - INFO - Epoch 11/50 (2.59s): Train Loss: 0.931645, Train Acc: 0.5479, Val Loss: 0.871078, Val Acc: 0.5730\n2025-12-02 20:59:50,913 - __main__ - INFO - Epoch 12/50 (2.63s): Train Loss: 0.929372, Train Acc: 0.5477, Val Loss: 0.874738, Val Acc: 0.5770\n2025-12-02 20:59:50,921 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/best_model_epoch_12.pth\n2025-12-02 20:59:50,921 - __main__ - INFO - New best validation accuracy: 0.5770\n2025-12-02 20:59:54,079 - __main__ - INFO - Epoch 13/50 (3.16s): Train Loss: 0.930504, Train Acc: 0.5514, Val Loss: 0.868733, Val Acc: 0.5706\n2025-12-02 20:59:56,838 - __main__ - INFO - Epoch 14/50 (2.76s): Train Loss: 0.929084, Train Acc: 0.5507, Val Loss: 0.873939, Val Acc: 0.5734\n2025-12-02 20:59:59,544 - __main__ - INFO - Epoch 15/50 (2.71s): Train Loss: 0.928520, Train Acc: 0.5493, Val Loss: 0.867823, Val Acc: 0.5782\n2025-12-02 20:59:59,552 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/best_model_epoch_15.pth\n2025-12-02 20:59:59,553 - __main__ - INFO - New best validation accuracy: 0.5782\n2025-12-02 21:00:02,057 - __main__ - INFO - Epoch 16/50 (2.50s): Train Loss: 0.929411, Train Acc: 0.5505, Val Loss: 0.874774, Val Acc: 0.5720\n2025-12-02 21:00:04,625 - __main__ - INFO - Epoch 17/50 (2.57s): Train Loss: 0.929747, Train Acc: 0.5509, Val Loss: 0.874919, Val Acc: 0.5706\n2025-12-02 21:00:07,204 - __main__ - INFO - Epoch 18/50 (2.58s): Train Loss: 0.929075, Train Acc: 0.5505, Val Loss: 0.871783, Val Acc: 0.5742\n2025-12-02 21:00:09,951 - __main__ - INFO - Epoch 19/50 (2.75s): Train Loss: 0.928454, Train Acc: 0.5521, Val Loss: 0.868393, Val Acc: 0.5748\n2025-12-02 21:00:12,788 - __main__ - INFO - Epoch 20/50 (2.84s): Train Loss: 0.927142, Train Acc: 0.5548, Val Loss: 0.881013, Val Acc: 0.5665\n2025-12-02 21:00:12,797 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/models/checkpoint_epoch_20.pth\n2025-12-02 21:00:15,474 - __main__ - INFO - Epoch 21/50 (2.68s): Train Loss: 0.927509, Train Acc: 0.5511, Val Loss: 0.881992, Val Acc: 0.5666\n2025-12-02 21:00:19,253 - __main__ - INFO - Epoch 22/50 (3.78s): Train Loss: 0.926528, Train Acc: 0.5548, Val Loss: 0.865873, Val Acc: 0.5761\n2025-12-02 21:00:22,135 - __main__ - INFO - Epoch 23/50 (2.88s): Train Loss: 0.927520, Train Acc: 0.5497, Val Loss: 0.895647, Val Acc: 0.5586\n2025-12-02 21:00:24,840 - __main__ - INFO - Epoch 24/50 (2.70s): Train Loss: 0.927991, Train Acc: 0.5508, Val Loss: 0.875673, Val Acc: 0.5701\n2025-12-02 21:00:27,667 - __main__ - INFO - Epoch 25/50 (2.83s): Train Loss: 0.928807, Train Acc: 0.5532, Val Loss: 0.866433, Val Acc: 0.5763\n2025-12-02 21:00:27,667 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 21:00:27,667 - __main__ - INFO - Training completed in 68.49s\n2025-12-02 21:00:27,667 - __main__ - INFO - Best validation accuracy: 0.5782\n2025-12-02 21:00:28,332 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/plots/training_history_20251202_210027.png\n2025-12-02 21:00:29,028 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/logs/classification_report_20251202_210029.json\n2025-12-02 21:00:29,028 - __main__ - INFO - Classification Results:\n2025-12-02 21:00:29,028 - __main__ - INFO -   Class 1: Precision=0.361, Recall=0.216, F1=0.270\n2025-12-02 21:00:29,028 - __main__ - INFO -   Class 4: Precision=0.510, Recall=0.473, F1=0.491\n2025-12-02 21:00:29,028 - __main__ - INFO -   Class 6: Precision=0.878, Recall=0.940, F1=0.908\n2025-12-02 21:00:29,028 - __main__ - INFO -   Class 12: Precision=0.482, Recall=0.676, F1=0.563\n2025-12-02 21:00:29,263 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/plots/confusion_matrix_20251202_210029.png\n2025-12-02 21:00:29,265 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 21:00:29,265 - __main__ - INFO - Evaluating on test set...\n2025-12-02 21:00:29,265 - __main__ - INFO - Loading test dataset...\n2025-12-02 21:00:29,265 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 21:00:29,278 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 21:00:30,059 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 21:00:30,174 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 21:00:30,204 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 21:00:30,211 - __main__ - INFO - Loaded 22857 test patches in 0.95s\n2025-12-02 21:00:30,213 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 21:00:30,213 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 21:00:30,213 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 21:00:30,215 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 21:00:30,217 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 21:00:30,219 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 21:00:30,222 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 21:00:30,251 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:00:30,274 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:00:30,274 - __main__ - INFO - Total available patches: 8936\n2025-12-02 21:00:30,274 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 21:00:30,997 - __main__ - INFO - Test Results: Loss=0.857806, Accuracy=0.5810\n2025-12-02 21:00:31,020 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/logs/test_classification_report_20251202_210031.json\n2025-12-02 21:00:31,261 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/plots/test_confusion_matrix_20251202_210031.png\n2025-12-02 21:00:31,281 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/training_summary_20251202_210031.json\n2025-12-02 21:00:31,284 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/latest_results.txt\n2025-12-02 21:00:31,284 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 21:00:31,284 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d79f17c4/training_summary_20251202_210031.json\n2025-12-02 21:00:31,284 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 685200/27408 = 25.0000 (2500.00%)\n2025-12-02 21:00:31,284 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.5782, Test Acc=0.5810\n",
      "return_code": 0
    },
    "config_base_quantiles": {
      "config_name": "config_base_quantiles",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_quantiles.conf",
      "start_time": 1764709238.029837,
      "status": "success",
      "duration": 3047.219452381134,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 21:00:40,384 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 21:00:40,384 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_quantiles.conf\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=True, aggregation=None\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 21:00:40,386 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 21:00:40,386 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_quantiles.conf\n2025-12-02 21:00:40,386 - __main__ - INFO - Training Configuration:\n2025-12-02 21:00:40,386 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 21:00:40,387 - __main__ - INFO -   Patch size: 10\n2025-12-02 21:00:40,387 - __main__ - INFO -   Batch size: 32\n2025-12-02 21:00:40,387 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 21:00:40,387 - __main__ - INFO -   Optimizer: adam\n2025-12-02 21:00:40,888 - __main__ - INFO - Using device: cuda\n2025-12-02 21:00:40,889 - __main__ - INFO - Using config hash: c3e46692\n2025-12-02 21:00:40,889 - __main__ - INFO - Using run ID: c3e46692\n2025-12-02 21:00:40,889 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692\n2025-12-02 21:00:40,898 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/config_c3e46692.json\n2025-12-02 21:00:40,900 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 21:00:40,903 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 21:00:42,061 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 21:00:42,274 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 21:00:42,284 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 21:00:42,284 - __main__ - INFO - Preparing data...\n2025-12-02 21:00:42,284 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 21:00:42,284 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 21:00:42,284 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 21:00:53,691 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 21:00:53,692 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 21:00:53,692 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 21:00:54,339 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 21:00:55,893 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 21:00:55,894 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 21:00:55,901 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 21:00:55,901 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 21:00:55,905 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 21:00:55,905 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 21:00:55,905 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 21:00:55,905 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 21:00:55,908 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 21:00:55,909 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 21:00:55,927 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 21:00:55,927 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 21:00:55,928 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 21:00:55,928 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 21:00:55,933 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 21:00:55,933 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 21:00:55,933 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 21:00:55,937 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 21:00:55,937 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 21:00:55,937 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 21:00:55,940 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 21:00:55,940 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 21:00:55,941 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 21:00:55,944 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 21:00:55,944 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 21:00:55,956 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:00:55,958 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:00:55,970 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 21:00:55,974 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 21:00:55,974 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 21:00:55,975 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 21:00:55,976 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 21:00:55,985 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 21:00:55,988 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 21:00:55,999 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 21:00:56,003 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 21:00:56,015 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 21:00:56,016 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 21:00:56,024 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 21:00:56,024 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 21:00:56,024 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 21:00:56,025 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 21:00:56,025 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 21:00:56,025 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 21:00:56,025 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 21:00:56,025 - __main__ - INFO - Loading train dataset...\n2025-12-02 21:00:56,025 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 21:00:56,259 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 21:00:57,503 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 21:00:58,268 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 21:00:58,354 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 21:00:58,378 - __main__ - INFO - Loaded 67828 train patches in 2.35s\n2025-12-02 21:00:58,381 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 21:00:58,381 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 21:00:58,382 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 21:00:58,386 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 21:00:58,394 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 21:00:58,400 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 21:00:58,408 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 21:00:58,506 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:00:58,599 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:00:58,599 - __main__ - INFO - Total available patches: 27408\n2025-12-02 21:00:58,599 - __main__ - INFO - Loading validation dataset...\n2025-12-02 21:00:58,599 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 21:00:58,614 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 21:00:59,115 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 21:00:59,226 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 21:00:59,252 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 21:00:59,258 - __main__ - INFO - Loaded 22192 validation patches in 0.66s\n2025-12-02 21:00:59,259 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 21:00:59,259 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 21:00:59,259 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 21:00:59,261 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 21:00:59,263 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 21:00:59,265 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 21:00:59,268 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 21:00:59,296 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:00:59,317 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:00:59,317 - __main__ - INFO - Total available patches: 8572\n2025-12-02 21:00:59,317 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 21:00:59,317 - __main__ - INFO - Training batches: 857\n2025-12-02 21:00:59,317 - __main__ - INFO - Validation batches: 268\n2025-12-02 21:00:59,317 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 21:00:59,317 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 21:02:20,927 - __main__ - INFO - Epoch 1/50 (81.61s): Train Loss: 1.270838, Train Acc: 0.3739, Val Loss: 1.214045, Val Acc: 0.4214\n2025-12-02 21:02:20,943 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_1.pth\n2025-12-02 21:02:20,943 - __main__ - INFO - New best validation accuracy: 0.4214\n2025-12-02 21:03:42,554 - __main__ - INFO - Epoch 2/50 (81.61s): Train Loss: 1.214402, Train Acc: 0.4071, Val Loss: 1.195056, Val Acc: 0.4231\n2025-12-02 21:03:42,567 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_2.pth\n2025-12-02 21:03:42,568 - __main__ - INFO - New best validation accuracy: 0.4231\n2025-12-02 21:05:04,878 - __main__ - INFO - Epoch 3/50 (82.31s): Train Loss: 1.204726, Train Acc: 0.4174, Val Loss: 1.196614, Val Acc: 0.4215\n2025-12-02 21:06:27,384 - __main__ - INFO - Epoch 4/50 (82.51s): Train Loss: 1.199670, Train Acc: 0.4233, Val Loss: 1.283165, Val Acc: 0.3914\n2025-12-02 21:07:49,011 - __main__ - INFO - Epoch 5/50 (81.63s): Train Loss: 1.193331, Train Acc: 0.4261, Val Loss: 1.233866, Val Acc: 0.4041\n2025-12-02 21:09:10,734 - __main__ - INFO - Epoch 6/50 (81.72s): Train Loss: 1.195105, Train Acc: 0.4249, Val Loss: 1.176598, Val Acc: 0.4407\n2025-12-02 21:09:10,747 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_6.pth\n2025-12-02 21:09:10,747 - __main__ - INFO - New best validation accuracy: 0.4407\n2025-12-02 21:10:32,853 - __main__ - INFO - Epoch 7/50 (82.11s): Train Loss: 1.189741, Train Acc: 0.4330, Val Loss: 1.274334, Val Acc: 0.4012\n2025-12-02 21:11:54,729 - __main__ - INFO - Epoch 8/50 (81.88s): Train Loss: 1.190693, Train Acc: 0.4259, Val Loss: 1.174708, Val Acc: 0.4421\n2025-12-02 21:11:54,742 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_8.pth\n2025-12-02 21:11:54,742 - __main__ - INFO - New best validation accuracy: 0.4421\n2025-12-02 21:13:17,555 - __main__ - INFO - Epoch 9/50 (82.81s): Train Loss: 1.185394, Train Acc: 0.4325, Val Loss: 1.182635, Val Acc: 0.4510\n2025-12-02 21:13:17,567 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_9.pth\n2025-12-02 21:13:17,567 - __main__ - INFO - New best validation accuracy: 0.4510\n2025-12-02 21:14:38,781 - __main__ - INFO - Epoch 10/50 (81.21s): Train Loss: 1.188609, Train Acc: 0.4335, Val Loss: 1.172897, Val Acc: 0.4392\n2025-12-02 21:14:38,793 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/checkpoint_epoch_10.pth\n2025-12-02 21:16:01,243 - __main__ - INFO - Epoch 11/50 (82.45s): Train Loss: 1.182911, Train Acc: 0.4368, Val Loss: 1.202411, Val Acc: 0.4223\n2025-12-02 21:17:23,043 - __main__ - INFO - Epoch 12/50 (81.80s): Train Loss: 1.178787, Train Acc: 0.4421, Val Loss: 1.166064, Val Acc: 0.4539\n2025-12-02 21:17:23,056 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_12.pth\n2025-12-02 21:17:23,056 - __main__ - INFO - New best validation accuracy: 0.4539\n2025-12-02 21:18:45,173 - __main__ - INFO - Epoch 13/50 (82.12s): Train Loss: 1.176364, Train Acc: 0.4417, Val Loss: 1.167376, Val Acc: 0.4554\n2025-12-02 21:18:45,186 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_13.pth\n2025-12-02 21:18:45,186 - __main__ - INFO - New best validation accuracy: 0.4554\n2025-12-02 21:20:07,153 - __main__ - INFO - Epoch 14/50 (81.97s): Train Loss: 1.177774, Train Acc: 0.4415, Val Loss: 1.175019, Val Acc: 0.4293\n2025-12-02 21:21:28,942 - __main__ - INFO - Epoch 15/50 (81.79s): Train Loss: 1.174753, Train Acc: 0.4412, Val Loss: 1.159733, Val Acc: 0.4525\n2025-12-02 21:22:50,737 - __main__ - INFO - Epoch 16/50 (81.80s): Train Loss: 1.171627, Train Acc: 0.4453, Val Loss: 1.158866, Val Acc: 0.4580\n2025-12-02 21:22:50,750 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_16.pth\n2025-12-02 21:22:50,750 - __main__ - INFO - New best validation accuracy: 0.4580\n2025-12-02 21:24:12,943 - __main__ - INFO - Epoch 17/50 (82.19s): Train Loss: 1.170596, Train Acc: 0.4461, Val Loss: 1.179421, Val Acc: 0.4462\n2025-12-02 21:25:34,899 - __main__ - INFO - Epoch 18/50 (81.96s): Train Loss: 1.167834, Train Acc: 0.4489, Val Loss: 1.171554, Val Acc: 0.4411\n2025-12-02 21:26:57,171 - __main__ - INFO - Epoch 19/50 (82.27s): Train Loss: 1.169234, Train Acc: 0.4460, Val Loss: 1.193665, Val Acc: 0.4479\n2025-12-02 21:28:19,565 - __main__ - INFO - Epoch 20/50 (82.39s): Train Loss: 1.168217, Train Acc: 0.4485, Val Loss: 1.156051, Val Acc: 0.4588\n2025-12-02 21:28:19,578 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_20.pth\n2025-12-02 21:28:19,578 - __main__ - INFO - New best validation accuracy: 0.4588\n2025-12-02 21:28:19,587 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/checkpoint_epoch_20.pth\n2025-12-02 21:29:41,505 - __main__ - INFO - Epoch 21/50 (81.92s): Train Loss: 1.166428, Train Acc: 0.4489, Val Loss: 1.177600, Val Acc: 0.4451\n2025-12-02 21:31:03,423 - __main__ - INFO - Epoch 22/50 (81.92s): Train Loss: 1.167380, Train Acc: 0.4506, Val Loss: 1.156720, Val Acc: 0.4578\n2025-12-02 21:32:25,998 - __main__ - INFO - Epoch 23/50 (82.57s): Train Loss: 1.165546, Train Acc: 0.4483, Val Loss: 1.161106, Val Acc: 0.4549\n2025-12-02 21:33:48,000 - __main__ - INFO - Epoch 24/50 (82.00s): Train Loss: 1.164130, Train Acc: 0.4507, Val Loss: 1.158121, Val Acc: 0.4438\n2025-12-02 21:35:10,320 - __main__ - INFO - Epoch 25/50 (82.32s): Train Loss: 1.165014, Train Acc: 0.4477, Val Loss: 1.156807, Val Acc: 0.4586\n2025-12-02 21:36:32,669 - __main__ - INFO - Epoch 26/50 (82.35s): Train Loss: 1.161985, Train Acc: 0.4516, Val Loss: 1.161030, Val Acc: 0.4606\n2025-12-02 21:36:32,682 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/best_model_epoch_26.pth\n2025-12-02 21:36:32,682 - __main__ - INFO - New best validation accuracy: 0.4606\n2025-12-02 21:37:55,453 - __main__ - INFO - Epoch 27/50 (82.77s): Train Loss: 1.163768, Train Acc: 0.4523, Val Loss: 1.181741, Val Acc: 0.4459\n2025-12-02 21:39:16,859 - __main__ - INFO - Epoch 28/50 (81.41s): Train Loss: 1.163586, Train Acc: 0.4486, Val Loss: 1.157671, Val Acc: 0.4535\n2025-12-02 21:40:39,691 - __main__ - INFO - Epoch 29/50 (82.83s): Train Loss: 1.160545, Train Acc: 0.4538, Val Loss: 1.166209, Val Acc: 0.4479\n2025-12-02 21:42:01,463 - __main__ - INFO - Epoch 30/50 (81.77s): Train Loss: 1.163159, Train Acc: 0.4490, Val Loss: 1.157556, Val Acc: 0.4505\n2025-12-02 21:42:01,476 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/models/checkpoint_epoch_30.pth\n2025-12-02 21:43:23,125 - __main__ - INFO - Epoch 31/50 (81.65s): Train Loss: 1.161532, Train Acc: 0.4514, Val Loss: 1.157277, Val Acc: 0.4596\n2025-12-02 21:44:46,078 - __main__ - INFO - Epoch 32/50 (82.95s): Train Loss: 1.163047, Train Acc: 0.4507, Val Loss: 1.160778, Val Acc: 0.4437\n2025-12-02 21:46:07,672 - __main__ - INFO - Epoch 33/50 (81.59s): Train Loss: 1.162854, Train Acc: 0.4500, Val Loss: 1.164102, Val Acc: 0.4543\n2025-12-02 21:47:29,935 - __main__ - INFO - Epoch 34/50 (82.26s): Train Loss: 1.162477, Train Acc: 0.4522, Val Loss: 1.155330, Val Acc: 0.4545\n2025-12-02 21:49:03,450 - __main__ - INFO - Epoch 35/50 (93.51s): Train Loss: 1.163649, Train Acc: 0.4474, Val Loss: 1.161462, Val Acc: 0.4399\n2025-12-02 21:50:37,069 - __main__ - INFO - Epoch 36/50 (93.62s): Train Loss: 1.158176, Train Acc: 0.4536, Val Loss: 1.154829, Val Acc: 0.4477\n2025-12-02 21:50:37,069 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 21:50:37,069 - __main__ - INFO - Training completed in 2977.75s\n2025-12-02 21:50:37,069 - __main__ - INFO - Best validation accuracy: 0.4606\n2025-12-02 21:50:37,872 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/plots/training_history_20251202_215037.png\n2025-12-02 21:51:00,630 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/logs/classification_report_20251202_215100.json\n2025-12-02 21:51:00,630 - __main__ - INFO - Classification Results:\n2025-12-02 21:51:00,630 - __main__ - INFO -   Class 1: Precision=0.476, Recall=0.125, F1=0.197\n2025-12-02 21:51:00,630 - __main__ - INFO -   Class 4: Precision=0.465, Recall=0.779, F1=0.583\n2025-12-02 21:51:00,630 - __main__ - INFO -   Class 6: Precision=0.440, Recall=0.294, F1=0.353\n2025-12-02 21:51:00,630 - __main__ - INFO -   Class 12: Precision=0.425, Recall=0.593, F1=0.495\n2025-12-02 21:51:00,892 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/plots/confusion_matrix_20251202_215100.png\n2025-12-02 21:51:00,893 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 21:51:00,893 - __main__ - INFO - Evaluating on test set...\n2025-12-02 21:51:00,893 - __main__ - INFO - Loading test dataset...\n2025-12-02 21:51:00,893 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 21:51:00,905 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 21:51:01,381 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 21:51:01,494 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 21:51:01,520 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 21:51:01,524 - __main__ - INFO - Loaded 22857 test patches in 0.63s\n2025-12-02 21:51:01,527 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 21:51:01,527 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 21:51:01,527 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 21:51:01,528 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 21:51:01,531 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 21:51:01,533 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 21:51:01,536 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 21:51:01,557 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:51:01,573 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:51:01,574 - __main__ - INFO - Total available patches: 8936\n2025-12-02 21:51:01,574 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 21:51:23,421 - __main__ - INFO - Test Results: Loss=1.149856, Accuracy=0.4538\n2025-12-02 21:51:23,443 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/logs/test_classification_report_20251202_215123.json\n2025-12-02 21:51:23,682 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/plots/test_confusion_matrix_20251202_215123.png\n2025-12-02 21:51:23,729 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/training_summary_20251202_215123.json\n2025-12-02 21:51:23,732 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/latest_results.txt\n2025-12-02 21:51:23,732 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 21:51:23,732 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_c3e46692/training_summary_20251202_215123.json\n2025-12-02 21:51:23,732 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 986688/27408 = 36.0000 (3600.00%)\n2025-12-02 21:51:23,732 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4606, Test Acc=0.4538\n",
      "return_code": 0
    },
    "config_base_shuffled": {
      "config_name": "config_base_shuffled",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_shuffled.conf",
      "start_time": 1764712290.2587478,
      "status": "success",
      "duration": 96.25246095657349,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 21:51:32,888 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 21:51:32,888 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_shuffled.conf\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=True, zero_mean=False, normalized=False, quantiles=False, aggregation=None\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 21:51:32,891 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 21:51:32,892 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 21:51:32,892 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_shuffled.conf\n2025-12-02 21:51:32,892 - __main__ - INFO - Training Configuration:\n2025-12-02 21:51:32,892 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 21:51:32,892 - __main__ - INFO -   Patch size: 10\n2025-12-02 21:51:32,892 - __main__ - INFO -   Batch size: 32\n2025-12-02 21:51:32,892 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 21:51:32,892 - __main__ - INFO -   Optimizer: adam\n2025-12-02 21:51:33,547 - __main__ - INFO - Using device: cuda\n2025-12-02 21:51:33,550 - __main__ - INFO - Using config hash: 30e96a43\n2025-12-02 21:51:33,550 - __main__ - INFO - Using run ID: 30e96a43\n2025-12-02 21:51:33,550 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43\n2025-12-02 21:51:33,559 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/config_30e96a43.json\n2025-12-02 21:51:33,563 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 21:51:33,567 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 21:51:34,790 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 21:51:35,071 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 21:51:35,087 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 21:51:35,087 - __main__ - INFO - Preparing data...\n2025-12-02 21:51:35,087 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 21:51:35,087 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 21:51:35,088 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 21:51:46,732 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 21:51:46,732 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 21:51:46,734 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 21:51:47,381 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 21:51:48,941 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 21:51:48,942 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 21:51:48,949 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 21:51:48,949 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 21:51:48,953 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 21:51:48,953 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 21:51:48,953 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 21:51:48,954 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 21:51:48,957 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 21:51:48,958 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 21:51:48,978 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 21:51:48,978 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 21:51:48,979 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 21:51:48,979 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 21:51:48,985 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 21:51:48,985 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 21:51:48,985 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 21:51:48,989 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 21:51:48,989 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 21:51:48,990 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 21:51:48,994 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 21:51:48,994 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 21:51:48,994 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 21:51:48,998 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 21:51:48,998 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 21:51:49,010 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:51:49,013 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:51:49,025 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 21:51:49,029 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 21:51:49,029 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 21:51:49,030 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 21:51:49,031 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 21:51:49,040 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 21:51:49,043 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 21:51:49,054 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 21:51:49,058 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 21:51:49,070 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 21:51:49,071 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 21:51:49,078 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 21:51:49,079 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 21:51:49,079 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 21:51:49,079 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 21:51:49,079 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 21:51:49,079 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 21:51:49,079 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 21:51:49,080 - __main__ - INFO - Loading train dataset...\n2025-12-02 21:51:49,080 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 21:51:49,317 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 21:51:50,564 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 21:51:51,318 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 21:51:51,404 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 21:51:51,429 - __main__ - INFO - Loaded 67828 train patches in 2.35s\n2025-12-02 21:51:51,432 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 21:51:51,432 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 21:51:51,432 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 21:51:51,436 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 21:51:51,444 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 21:51:51,451 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 21:51:51,458 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 21:51:51,558 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:51:51,649 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:51:51,649 - __main__ - INFO - Total available patches: 27408\n2025-12-02 21:51:51,649 - __main__ - INFO - Loading validation dataset...\n2025-12-02 21:51:51,649 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 21:51:51,665 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 21:51:52,175 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 21:51:52,295 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 21:51:52,323 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 21:51:52,329 - __main__ - INFO - Loaded 22192 validation patches in 0.68s\n2025-12-02 21:51:52,330 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 21:51:52,330 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 21:51:52,330 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 21:51:52,331 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 21:51:52,334 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 21:51:52,336 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 21:51:52,338 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 21:51:52,366 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:51:52,387 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:51:52,388 - __main__ - INFO - Total available patches: 8572\n2025-12-02 21:51:52,388 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 21:51:52,388 - __main__ - INFO - Training batches: 857\n2025-12-02 21:51:52,388 - __main__ - INFO - Validation batches: 268\n2025-12-02 21:51:52,388 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 21:51:52,388 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 21:51:55,671 - __main__ - INFO - Epoch 1/50 (3.28s): Train Loss: 0.801859, Train Acc: 0.6420, Val Loss: 0.631021, Val Acc: 0.7072\n2025-12-02 21:51:55,685 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_1.pth\n2025-12-02 21:51:55,685 - __main__ - INFO - New best validation accuracy: 0.7072\n2025-12-02 21:51:58,663 - __main__ - INFO - Epoch 2/50 (2.98s): Train Loss: 0.712562, Train Acc: 0.6765, Val Loss: 0.627159, Val Acc: 0.7079\n2025-12-02 21:51:58,675 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_2.pth\n2025-12-02 21:51:58,675 - __main__ - INFO - New best validation accuracy: 0.7079\n2025-12-02 21:52:01,696 - __main__ - INFO - Epoch 3/50 (3.02s): Train Loss: 0.704745, Train Acc: 0.6798, Val Loss: 0.619849, Val Acc: 0.7114\n2025-12-02 21:52:01,707 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_3.pth\n2025-12-02 21:52:01,707 - __main__ - INFO - New best validation accuracy: 0.7114\n2025-12-02 21:52:04,806 - __main__ - INFO - Epoch 4/50 (3.10s): Train Loss: 0.703686, Train Acc: 0.6822, Val Loss: 0.689717, Val Acc: 0.6703\n2025-12-02 21:52:07,780 - __main__ - INFO - Epoch 5/50 (2.97s): Train Loss: 0.707165, Train Acc: 0.6821, Val Loss: 0.622613, Val Acc: 0.7117\n2025-12-02 21:52:07,793 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_5.pth\n2025-12-02 21:52:07,793 - __main__ - INFO - New best validation accuracy: 0.7117\n2025-12-02 21:52:10,878 - __main__ - INFO - Epoch 6/50 (3.08s): Train Loss: 0.697443, Train Acc: 0.6881, Val Loss: 0.707122, Val Acc: 0.6657\n2025-12-02 21:52:13,925 - __main__ - INFO - Epoch 7/50 (3.05s): Train Loss: 0.699772, Train Acc: 0.6843, Val Loss: 0.623403, Val Acc: 0.7115\n2025-12-02 21:52:16,949 - __main__ - INFO - Epoch 8/50 (3.02s): Train Loss: 0.700685, Train Acc: 0.6867, Val Loss: 0.615083, Val Acc: 0.7147\n2025-12-02 21:52:16,962 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_8.pth\n2025-12-02 21:52:16,962 - __main__ - INFO - New best validation accuracy: 0.7147\n2025-12-02 21:52:20,090 - __main__ - INFO - Epoch 9/50 (3.13s): Train Loss: 0.696907, Train Acc: 0.6874, Val Loss: 0.619221, Val Acc: 0.7143\n2025-12-02 21:52:23,128 - __main__ - INFO - Epoch 10/50 (3.04s): Train Loss: 0.697715, Train Acc: 0.6857, Val Loss: 0.614020, Val Acc: 0.7163\n2025-12-02 21:52:23,140 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_10.pth\n2025-12-02 21:52:23,140 - __main__ - INFO - New best validation accuracy: 0.7163\n2025-12-02 21:52:23,151 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/checkpoint_epoch_10.pth\n2025-12-02 21:52:26,220 - __main__ - INFO - Epoch 11/50 (3.07s): Train Loss: 0.699561, Train Acc: 0.6843, Val Loss: 0.609232, Val Acc: 0.7194\n2025-12-02 21:52:26,233 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_11.pth\n2025-12-02 21:52:26,233 - __main__ - INFO - New best validation accuracy: 0.7194\n2025-12-02 21:52:29,177 - __main__ - INFO - Epoch 12/50 (2.94s): Train Loss: 0.700443, Train Acc: 0.6856, Val Loss: 0.610479, Val Acc: 0.7210\n2025-12-02 21:52:29,189 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_12.pth\n2025-12-02 21:52:29,190 - __main__ - INFO - New best validation accuracy: 0.7210\n2025-12-02 21:52:32,213 - __main__ - INFO - Epoch 13/50 (3.02s): Train Loss: 0.697184, Train Acc: 0.6865, Val Loss: 0.606833, Val Acc: 0.7229\n2025-12-02 21:52:32,225 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/best_model_epoch_13.pth\n2025-12-02 21:52:32,225 - __main__ - INFO - New best validation accuracy: 0.7229\n2025-12-02 21:52:35,257 - __main__ - INFO - Epoch 14/50 (3.03s): Train Loss: 0.696882, Train Acc: 0.6868, Val Loss: 0.609593, Val Acc: 0.7220\n2025-12-02 21:52:38,129 - __main__ - INFO - Epoch 15/50 (2.87s): Train Loss: 0.695543, Train Acc: 0.6899, Val Loss: 0.616457, Val Acc: 0.7189\n2025-12-02 21:52:41,137 - __main__ - INFO - Epoch 16/50 (3.01s): Train Loss: 0.694586, Train Acc: 0.6899, Val Loss: 0.662295, Val Acc: 0.6899\n2025-12-02 21:52:44,200 - __main__ - INFO - Epoch 17/50 (3.06s): Train Loss: 0.697174, Train Acc: 0.6863, Val Loss: 0.631719, Val Acc: 0.7043\n2025-12-02 21:52:47,156 - __main__ - INFO - Epoch 18/50 (2.95s): Train Loss: 0.694569, Train Acc: 0.6879, Val Loss: 0.621748, Val Acc: 0.7106\n2025-12-02 21:52:50,142 - __main__ - INFO - Epoch 19/50 (2.99s): Train Loss: 0.692462, Train Acc: 0.6901, Val Loss: 0.611746, Val Acc: 0.7211\n2025-12-02 21:52:53,074 - __main__ - INFO - Epoch 20/50 (2.93s): Train Loss: 0.693541, Train Acc: 0.6905, Val Loss: 0.621175, Val Acc: 0.7173\n2025-12-02 21:52:53,086 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/models/checkpoint_epoch_20.pth\n2025-12-02 21:52:56,059 - __main__ - INFO - Epoch 21/50 (2.97s): Train Loss: 0.691114, Train Acc: 0.6919, Val Loss: 0.615516, Val Acc: 0.7149\n2025-12-02 21:52:59,027 - __main__ - INFO - Epoch 22/50 (2.97s): Train Loss: 0.692786, Train Acc: 0.6914, Val Loss: 0.619369, Val Acc: 0.7177\n2025-12-02 21:53:02,008 - __main__ - INFO - Epoch 23/50 (2.98s): Train Loss: 0.688847, Train Acc: 0.6909, Val Loss: 0.614523, Val Acc: 0.7137\n2025-12-02 21:53:02,008 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 21:53:02,008 - __main__ - INFO - Training completed in 69.62s\n2025-12-02 21:53:02,008 - __main__ - INFO - Best validation accuracy: 0.7229\n2025-12-02 21:53:02,693 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/plots/training_history_20251202_215302.png\n2025-12-02 21:53:03,416 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/logs/classification_report_20251202_215303.json\n2025-12-02 21:53:03,416 - __main__ - INFO - Classification Results:\n2025-12-02 21:53:03,416 - __main__ - INFO -   Class 1: Precision=0.651, Recall=0.290, F1=0.402\n2025-12-02 21:53:03,416 - __main__ - INFO -   Class 4: Precision=0.754, Recall=0.812, F1=0.782\n2025-12-02 21:53:03,416 - __main__ - INFO -   Class 6: Precision=0.919, Recall=0.965, F1=0.941\n2025-12-02 21:53:03,416 - __main__ - INFO -   Class 12: Precision=0.552, Recall=0.788, F1=0.649\n2025-12-02 21:53:03,628 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/plots/confusion_matrix_20251202_215303.png\n2025-12-02 21:53:03,629 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 21:53:03,629 - __main__ - INFO - Evaluating on test set...\n2025-12-02 21:53:03,629 - __main__ - INFO - Loading test dataset...\n2025-12-02 21:53:03,629 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 21:53:03,642 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 21:53:04,049 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 21:53:04,145 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 21:53:04,168 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 21:53:04,172 - __main__ - INFO - Loaded 22857 test patches in 0.54s\n2025-12-02 21:53:04,174 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 21:53:04,174 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 21:53:04,174 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 21:53:04,175 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 21:53:04,178 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 21:53:04,179 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 21:53:04,181 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 21:53:04,200 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:53:04,214 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:53:04,214 - __main__ - INFO - Total available patches: 8936\n2025-12-02 21:53:04,214 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 21:53:04,884 - __main__ - INFO - Test Results: Loss=0.615232, Accuracy=0.7073\n2025-12-02 21:53:04,903 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/logs/test_classification_report_20251202_215304.json\n2025-12-02 21:53:05,116 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/plots/test_confusion_matrix_20251202_215304.png\n2025-12-02 21:53:05,150 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/training_summary_20251202_215305.json\n2025-12-02 21:53:05,153 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/latest_results.txt\n2025-12-02 21:53:05,153 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 21:53:05,153 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_30e96a43/training_summary_20251202_215305.json\n2025-12-02 21:53:05,153 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 630384/27408 = 23.0000 (2300.00%)\n2025-12-02 21:53:05,153 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.7229, Test Acc=0.7073\n",
      "return_code": 0
    },
    "config_base_std": {
      "config_name": "config_base_std",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_std.conf",
      "start_time": 1764712391.5206132,
      "status": "success",
      "duration": 73.95868253707886,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 21:53:14,088 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 21:53:14,089 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_std.conf\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=False, aggregation=std\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 21:53:14,091 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 21:53:14,091 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_std.conf\n2025-12-02 21:53:14,091 - __main__ - INFO - Training Configuration:\n2025-12-02 21:53:14,091 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 21:53:14,091 - __main__ - INFO -   Patch size: 10\n2025-12-02 21:53:14,091 - __main__ - INFO -   Batch size: 32\n2025-12-02 21:53:14,091 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 21:53:14,091 - __main__ - INFO -   Optimizer: adam\n2025-12-02 21:53:14,694 - __main__ - INFO - Using device: cuda\n2025-12-02 21:53:14,697 - __main__ - INFO - Using config hash: 00ebd21a\n2025-12-02 21:53:14,697 - __main__ - INFO - Using run ID: 00ebd21a\n2025-12-02 21:53:14,697 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a\n2025-12-02 21:53:14,705 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/config_00ebd21a.json\n2025-12-02 21:53:14,709 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 21:53:14,711 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 21:53:14,711 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-02 21:53:14,712 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 21:53:14,712 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 21:53:14,712 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 21:53:14,712 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 21:53:14,712 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-02 21:53:15,694 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-02 21:53:15,782 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 21:53:15,783 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-02 21:53:15,783 - __main__ - INFO - Preparing data...\n2025-12-02 21:53:15,783 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 21:53:15,783 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 21:53:15,783 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 21:53:27,164 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 21:53:27,165 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 21:53:27,166 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 21:53:27,742 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 21:53:28,763 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 21:53:28,763 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 21:53:28,769 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 21:53:28,769 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 21:53:28,773 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 21:53:28,773 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 21:53:28,773 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 21:53:28,774 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 21:53:28,776 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 21:53:28,776 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 21:53:28,794 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 21:53:28,794 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 21:53:28,795 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 21:53:28,795 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 21:53:28,800 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 21:53:28,800 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 21:53:28,800 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 21:53:28,804 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 21:53:28,804 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 21:53:28,805 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 21:53:28,808 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 21:53:28,809 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 21:53:28,809 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 21:53:28,813 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 21:53:28,813 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 21:53:28,823 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:53:28,825 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:53:28,836 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 21:53:28,839 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 21:53:28,839 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 21:53:28,840 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 21:53:28,841 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 21:53:28,850 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 21:53:28,853 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 21:53:28,863 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 21:53:28,867 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 21:53:28,878 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 21:53:28,886 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 21:53:28,886 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 21:53:28,886 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 21:53:28,886 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 21:53:28,886 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 21:53:28,887 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 21:53:28,887 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 21:53:28,887 - __main__ - INFO - Loading train dataset...\n2025-12-02 21:53:28,887 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 21:53:29,041 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 21:53:30,022 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 21:53:30,781 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 21:53:30,866 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 21:53:30,891 - __main__ - INFO - Loaded 67828 train patches in 2.00s\n2025-12-02 21:53:30,894 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 21:53:30,894 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 21:53:30,894 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 21:53:30,898 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 21:53:30,906 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 21:53:30,913 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 21:53:30,920 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 21:53:31,022 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:53:31,113 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:53:31,113 - __main__ - INFO - Total available patches: 27408\n2025-12-02 21:53:31,113 - __main__ - INFO - Loading validation dataset...\n2025-12-02 21:53:31,113 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 21:53:31,128 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 21:53:31,632 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 21:53:31,749 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 21:53:31,776 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 21:53:31,783 - __main__ - INFO - Loaded 22192 validation patches in 0.67s\n2025-12-02 21:53:31,784 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 21:53:31,784 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 21:53:31,784 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 21:53:31,785 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 21:53:31,788 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 21:53:31,790 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 21:53:31,792 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 21:53:31,820 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:53:31,842 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:53:31,842 - __main__ - INFO - Total available patches: 8572\n2025-12-02 21:53:31,842 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 21:53:31,842 - __main__ - INFO - Training batches: 857\n2025-12-02 21:53:31,842 - __main__ - INFO - Validation batches: 268\n2025-12-02 21:53:31,842 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 21:53:31,842 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 21:53:34,757 - __main__ - INFO - Epoch 1/50 (2.91s): Train Loss: 1.379281, Train Acc: 0.3115, Val Loss: 1.296878, Val Acc: 0.4137\n2025-12-02 21:53:34,768 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/models/best_model_epoch_1.pth\n2025-12-02 21:53:34,768 - __main__ - INFO - New best validation accuracy: 0.4137\n2025-12-02 21:53:37,504 - __main__ - INFO - Epoch 2/50 (2.74s): Train Loss: 1.292567, Train Acc: 0.3763, Val Loss: 1.256758, Val Acc: 0.4092\n2025-12-02 21:53:40,041 - __main__ - INFO - Epoch 3/50 (2.54s): Train Loss: 1.272406, Train Acc: 0.3985, Val Loss: 1.246727, Val Acc: 0.4136\n2025-12-02 21:53:42,687 - __main__ - INFO - Epoch 4/50 (2.65s): Train Loss: 1.268308, Train Acc: 0.4027, Val Loss: 1.242748, Val Acc: 0.4188\n2025-12-02 21:53:42,695 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/models/best_model_epoch_4.pth\n2025-12-02 21:53:42,695 - __main__ - INFO - New best validation accuracy: 0.4188\n2025-12-02 21:53:45,505 - __main__ - INFO - Epoch 5/50 (2.81s): Train Loss: 1.263941, Train Acc: 0.4062, Val Loss: 1.247165, Val Acc: 0.4164\n2025-12-02 21:53:48,400 - __main__ - INFO - Epoch 6/50 (2.89s): Train Loss: 1.262655, Train Acc: 0.4046, Val Loss: 1.241347, Val Acc: 0.4224\n2025-12-02 21:53:48,408 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/models/best_model_epoch_6.pth\n2025-12-02 21:53:48,408 - __main__ - INFO - New best validation accuracy: 0.4224\n2025-12-02 21:53:51,029 - __main__ - INFO - Epoch 7/50 (2.62s): Train Loss: 1.260514, Train Acc: 0.4090, Val Loss: 1.240624, Val Acc: 0.4206\n2025-12-02 21:53:53,673 - __main__ - INFO - Epoch 8/50 (2.64s): Train Loss: 1.260654, Train Acc: 0.4079, Val Loss: 1.236749, Val Acc: 0.4228\n2025-12-02 21:53:53,681 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/models/best_model_epoch_8.pth\n2025-12-02 21:53:53,681 - __main__ - INFO - New best validation accuracy: 0.4228\n2025-12-02 21:53:56,315 - __main__ - INFO - Epoch 9/50 (2.63s): Train Loss: 1.258993, Train Acc: 0.4076, Val Loss: 1.238425, Val Acc: 0.4210\n2025-12-02 21:53:59,013 - __main__ - INFO - Epoch 10/50 (2.70s): Train Loss: 1.259369, Train Acc: 0.4103, Val Loss: 1.243907, Val Acc: 0.4153\n2025-12-02 21:53:59,021 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/models/checkpoint_epoch_10.pth\n2025-12-02 21:54:01,683 - __main__ - INFO - Epoch 11/50 (2.66s): Train Loss: 1.257649, Train Acc: 0.4113, Val Loss: 1.236943, Val Acc: 0.4204\n2025-12-02 21:54:04,390 - __main__ - INFO - Epoch 12/50 (2.71s): Train Loss: 1.258214, Train Acc: 0.4109, Val Loss: 1.240585, Val Acc: 0.4160\n2025-12-02 21:54:07,326 - __main__ - INFO - Epoch 13/50 (2.94s): Train Loss: 1.257001, Train Acc: 0.4094, Val Loss: 1.237789, Val Acc: 0.4197\n2025-12-02 21:54:09,909 - __main__ - INFO - Epoch 14/50 (2.58s): Train Loss: 1.258457, Train Acc: 0.4101, Val Loss: 1.235830, Val Acc: 0.4211\n2025-12-02 21:54:12,547 - __main__ - INFO - Epoch 15/50 (2.64s): Train Loss: 1.257183, Train Acc: 0.4125, Val Loss: 1.238016, Val Acc: 0.4204\n2025-12-02 21:54:15,162 - __main__ - INFO - Epoch 16/50 (2.62s): Train Loss: 1.257230, Train Acc: 0.4130, Val Loss: 1.237707, Val Acc: 0.4208\n2025-12-02 21:54:17,772 - __main__ - INFO - Epoch 17/50 (2.61s): Train Loss: 1.257522, Train Acc: 0.4086, Val Loss: 1.240121, Val Acc: 0.4193\n2025-12-02 21:54:20,467 - __main__ - INFO - Epoch 18/50 (2.69s): Train Loss: 1.258487, Train Acc: 0.4099, Val Loss: 1.238112, Val Acc: 0.4193\n2025-12-02 21:54:20,467 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 21:54:20,467 - __main__ - INFO - Training completed in 48.62s\n2025-12-02 21:54:20,467 - __main__ - INFO - Best validation accuracy: 0.4228\n2025-12-02 21:54:21,169 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/plots/training_history_20251202_215420.png\n2025-12-02 21:54:21,855 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/logs/classification_report_20251202_215421.json\n2025-12-02 21:54:21,855 - __main__ - INFO - Classification Results:\n2025-12-02 21:54:21,855 - __main__ - INFO -   Class 1: Precision=0.391, Recall=0.245, F1=0.301\n2025-12-02 21:54:21,855 - __main__ - INFO -   Class 4: Precision=0.554, Recall=0.595, F1=0.574\n2025-12-02 21:54:21,855 - __main__ - INFO -   Class 6: Precision=0.354, Recall=0.646, F1=0.458\n2025-12-02 21:54:21,855 - __main__ - INFO -   Class 12: Precision=0.403, Recall=0.192, F1=0.260\n2025-12-02 21:54:22,064 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/plots/confusion_matrix_20251202_215421.png\n2025-12-02 21:54:22,065 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 21:54:22,065 - __main__ - INFO - Evaluating on test set...\n2025-12-02 21:54:22,065 - __main__ - INFO - Loading test dataset...\n2025-12-02 21:54:22,065 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 21:54:22,077 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 21:54:22,582 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 21:54:22,680 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 21:54:22,703 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 21:54:22,707 - __main__ - INFO - Loaded 22857 test patches in 0.64s\n2025-12-02 21:54:22,710 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 21:54:22,710 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 21:54:22,710 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 21:54:22,711 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 21:54:22,713 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 21:54:22,715 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 21:54:22,717 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 21:54:22,736 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:54:22,752 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:54:22,752 - __main__ - INFO - Total available patches: 8936\n2025-12-02 21:54:22,753 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 21:54:23,488 - __main__ - INFO - Test Results: Loss=1.254036, Accuracy=0.4113\n2025-12-02 21:54:23,515 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/logs/test_classification_report_20251202_215423.json\n2025-12-02 21:54:23,747 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/plots/test_confusion_matrix_20251202_215423.png\n2025-12-02 21:54:23,768 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/training_summary_20251202_215423.json\n2025-12-02 21:54:23,771 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/latest_results.txt\n2025-12-02 21:54:23,771 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 21:54:23,771 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_00ebd21a/training_summary_20251202_215423.json\n2025-12-02 21:54:23,771 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 493344/27408 = 18.0000 (1800.00%)\n2025-12-02 21:54:23,771 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4228, Test Acc=0.4113\n",
      "return_code": 0
    },
    "config_base_stdandmean": {
      "config_name": "config_base_stdandmean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_stdandmean.conf",
      "start_time": 1764712470.4861486,
      "status": "success",
      "duration": 78.81921291351318,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 21:54:33,040 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 21:54:33,040 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_stdandmean.conf\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=False, aggregation=stdandmean\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 21:54:33,042 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 21:54:33,043 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 21:54:33,043 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 21:54:33,043 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_stdandmean.conf\n2025-12-02 21:54:33,043 - __main__ - INFO - Training Configuration:\n2025-12-02 21:54:33,043 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 21:54:33,043 - __main__ - INFO -   Patch size: 10\n2025-12-02 21:54:33,043 - __main__ - INFO -   Batch size: 32\n2025-12-02 21:54:33,043 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 21:54:33,043 - __main__ - INFO -   Optimizer: adam\n2025-12-02 21:54:33,690 - __main__ - INFO - Using device: cuda\n2025-12-02 21:54:33,693 - __main__ - INFO - Using config hash: 51c54b17\n2025-12-02 21:54:33,693 - __main__ - INFO - Using run ID: 51c54b17\n2025-12-02 21:54:33,693 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17\n2025-12-02 21:54:33,702 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/config_51c54b17.json\n2025-12-02 21:54:33,706 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 4\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 21:54:33,709 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 580\n2025-12-02 21:54:34,695 - __main__ - INFO - Model initialized with 580 parameters\n2025-12-02 21:54:34,779 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 21:54:34,780 - __main__ - WARNING - Could not create model summary: Expected 4 input features, got 200\n2025-12-02 21:54:34,780 - __main__ - INFO - Preparing data...\n2025-12-02 21:54:34,780 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 21:54:34,780 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 21:54:34,780 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 21:54:45,866 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 21:54:45,867 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 21:54:45,868 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 21:54:46,441 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 21:54:47,455 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 21:54:47,455 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 21:54:47,461 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 21:54:47,461 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 21:54:47,465 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 21:54:47,465 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 21:54:47,465 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 21:54:47,466 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 21:54:47,468 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 21:54:47,468 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 21:54:47,485 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 21:54:47,485 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 21:54:47,485 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 21:54:47,486 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 21:54:47,490 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 21:54:47,490 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 21:54:47,490 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 21:54:47,493 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 21:54:47,493 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 21:54:47,494 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 21:54:47,497 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 21:54:47,497 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 21:54:47,497 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 21:54:47,501 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 21:54:47,501 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 21:54:47,511 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:54:47,513 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:54:47,524 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 21:54:47,527 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 21:54:47,527 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 21:54:47,528 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 21:54:47,528 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 21:54:47,537 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 21:54:47,540 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 21:54:47,550 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 21:54:47,554 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 21:54:47,564 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 21:54:47,565 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 21:54:47,572 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 21:54:47,573 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 21:54:47,573 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 21:54:47,573 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 21:54:47,573 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 21:54:47,573 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 21:54:47,573 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 21:54:47,573 - __main__ - INFO - Loading train dataset...\n2025-12-02 21:54:47,574 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 21:54:47,725 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 21:54:48,670 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 21:54:49,198 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 21:54:49,259 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 21:54:49,274 - __main__ - INFO - Loaded 67828 train patches in 1.70s\n2025-12-02 21:54:49,277 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 21:54:49,277 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 21:54:49,277 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 21:54:49,281 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 21:54:49,288 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 21:54:49,294 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 21:54:49,301 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 21:54:49,365 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:54:49,431 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:54:49,431 - __main__ - INFO - Total available patches: 27408\n2025-12-02 21:54:49,431 - __main__ - INFO - Loading validation dataset...\n2025-12-02 21:54:49,431 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 21:54:49,444 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 21:54:49,804 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 21:54:49,898 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 21:54:49,917 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 21:54:49,921 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-02 21:54:49,922 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 21:54:49,922 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 21:54:49,922 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 21:54:49,924 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 21:54:49,926 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 21:54:49,928 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 21:54:49,930 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 21:54:49,948 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:54:49,965 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:54:49,965 - __main__ - INFO - Total available patches: 8572\n2025-12-02 21:54:49,966 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 21:54:49,966 - __main__ - INFO - Training batches: 857\n2025-12-02 21:54:49,966 - __main__ - INFO - Validation batches: 268\n2025-12-02 21:54:49,966 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 21:54:49,966 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 21:54:52,800 - __main__ - INFO - Epoch 1/50 (2.83s): Train Loss: 1.416116, Train Acc: 0.3977, Val Loss: 1.055956, Val Acc: 0.5139\n2025-12-02 21:54:52,809 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_1.pth\n2025-12-02 21:54:52,809 - __main__ - INFO - New best validation accuracy: 0.5139\n2025-12-02 21:54:55,621 - __main__ - INFO - Epoch 2/50 (2.81s): Train Loss: 1.036212, Train Acc: 0.5424, Val Loss: 0.920582, Val Acc: 0.6165\n2025-12-02 21:54:55,629 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_2.pth\n2025-12-02 21:54:55,629 - __main__ - INFO - New best validation accuracy: 0.6165\n2025-12-02 21:54:58,448 - __main__ - INFO - Epoch 3/50 (2.82s): Train Loss: 0.926802, Train Acc: 0.5870, Val Loss: 0.834742, Val Acc: 0.6365\n2025-12-02 21:54:58,456 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_3.pth\n2025-12-02 21:54:58,456 - __main__ - INFO - New best validation accuracy: 0.6365\n2025-12-02 21:55:00,934 - __main__ - INFO - Epoch 4/50 (2.48s): Train Loss: 0.863102, Train Acc: 0.6130, Val Loss: 0.783515, Val Acc: 0.6416\n2025-12-02 21:55:00,941 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_4.pth\n2025-12-02 21:55:00,941 - __main__ - INFO - New best validation accuracy: 0.6416\n2025-12-02 21:55:03,468 - __main__ - INFO - Epoch 5/50 (2.53s): Train Loss: 0.834509, Train Acc: 0.6215, Val Loss: 0.765217, Val Acc: 0.6465\n2025-12-02 21:55:03,475 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_5.pth\n2025-12-02 21:55:03,475 - __main__ - INFO - New best validation accuracy: 0.6465\n2025-12-02 21:55:06,331 - __main__ - INFO - Epoch 6/50 (2.86s): Train Loss: 0.823170, Train Acc: 0.6235, Val Loss: 0.768602, Val Acc: 0.6352\n2025-12-02 21:55:08,874 - __main__ - INFO - Epoch 7/50 (2.54s): Train Loss: 0.816591, Train Acc: 0.6248, Val Loss: 0.754669, Val Acc: 0.6493\n2025-12-02 21:55:08,882 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_7.pth\n2025-12-02 21:55:08,882 - __main__ - INFO - New best validation accuracy: 0.6493\n2025-12-02 21:55:11,622 - __main__ - INFO - Epoch 8/50 (2.74s): Train Loss: 0.810901, Train Acc: 0.6264, Val Loss: 0.740532, Val Acc: 0.6513\n2025-12-02 21:55:11,631 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_8.pth\n2025-12-02 21:55:11,631 - __main__ - INFO - New best validation accuracy: 0.6513\n2025-12-02 21:55:14,379 - __main__ - INFO - Epoch 9/50 (2.75s): Train Loss: 0.810988, Train Acc: 0.6286, Val Loss: 0.741797, Val Acc: 0.6510\n2025-12-02 21:55:17,016 - __main__ - INFO - Epoch 10/50 (2.64s): Train Loss: 0.807569, Train Acc: 0.6324, Val Loss: 0.744270, Val Acc: 0.6515\n2025-12-02 21:55:17,024 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/best_model_epoch_10.pth\n2025-12-02 21:55:17,024 - __main__ - INFO - New best validation accuracy: 0.6515\n2025-12-02 21:55:17,028 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/models/checkpoint_epoch_10.pth\n2025-12-02 21:55:19,699 - __main__ - INFO - Epoch 11/50 (2.67s): Train Loss: 0.808458, Train Acc: 0.6297, Val Loss: 0.737497, Val Acc: 0.6492\n2025-12-02 21:55:22,329 - __main__ - INFO - Epoch 12/50 (2.63s): Train Loss: 0.805838, Train Acc: 0.6305, Val Loss: 0.763573, Val Acc: 0.6384\n2025-12-02 21:55:25,425 - __main__ - INFO - Epoch 13/50 (3.10s): Train Loss: 0.802966, Train Acc: 0.6338, Val Loss: 0.740761, Val Acc: 0.6501\n2025-12-02 21:55:28,134 - __main__ - INFO - Epoch 14/50 (2.71s): Train Loss: 0.804911, Train Acc: 0.6341, Val Loss: 0.746612, Val Acc: 0.6480\n2025-12-02 21:55:30,971 - __main__ - INFO - Epoch 15/50 (2.84s): Train Loss: 0.805158, Train Acc: 0.6318, Val Loss: 0.734555, Val Acc: 0.6512\n2025-12-02 21:55:33,466 - __main__ - INFO - Epoch 16/50 (2.49s): Train Loss: 0.804370, Train Acc: 0.6322, Val Loss: 0.756003, Val Acc: 0.6414\n2025-12-02 21:55:36,190 - __main__ - INFO - Epoch 17/50 (2.72s): Train Loss: 0.801119, Train Acc: 0.6330, Val Loss: 0.741668, Val Acc: 0.6449\n2025-12-02 21:55:38,998 - __main__ - INFO - Epoch 18/50 (2.81s): Train Loss: 0.801671, Train Acc: 0.6314, Val Loss: 0.765491, Val Acc: 0.6347\n2025-12-02 21:55:41,684 - __main__ - INFO - Epoch 19/50 (2.69s): Train Loss: 0.800278, Train Acc: 0.6342, Val Loss: 0.758137, Val Acc: 0.6385\n2025-12-02 21:55:44,329 - __main__ - INFO - Epoch 20/50 (2.64s): Train Loss: 0.801362, Train Acc: 0.6340, Val Loss: 0.743545, Val Acc: 0.6491\n2025-12-02 21:55:44,329 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 21:55:44,329 - __main__ - INFO - Training completed in 54.36s\n2025-12-02 21:55:44,329 - __main__ - INFO - Best validation accuracy: 0.6515\n2025-12-02 21:55:45,057 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/plots/training_history_20251202_215544.png\n2025-12-02 21:55:45,742 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/logs/classification_report_20251202_215545.json\n2025-12-02 21:55:45,742 - __main__ - INFO - Classification Results:\n2025-12-02 21:55:45,742 - __main__ - INFO -   Class 1: Precision=0.497, Recall=0.547, F1=0.521\n2025-12-02 21:55:45,742 - __main__ - INFO -   Class 4: Precision=0.697, Recall=0.619, F1=0.655\n2025-12-02 21:55:45,742 - __main__ - INFO -   Class 6: Precision=0.848, Recall=0.969, F1=0.905\n2025-12-02 21:55:45,742 - __main__ - INFO -   Class 12: Precision=0.531, Recall=0.462, F1=0.494\n2025-12-02 21:55:45,973 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/plots/confusion_matrix_20251202_215545.png\n2025-12-02 21:55:45,975 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 21:55:45,975 - __main__ - INFO - Evaluating on test set...\n2025-12-02 21:55:45,975 - __main__ - INFO - Loading test dataset...\n2025-12-02 21:55:45,975 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 21:55:45,986 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 21:55:46,488 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 21:55:46,584 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 21:55:46,606 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 21:55:46,610 - __main__ - INFO - Loaded 22857 test patches in 0.64s\n2025-12-02 21:55:46,612 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 21:55:46,612 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 21:55:46,612 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 21:55:46,614 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 21:55:46,616 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 21:55:46,618 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 21:55:46,620 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 21:55:46,640 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:55:46,656 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:55:46,656 - __main__ - INFO - Total available patches: 8936\n2025-12-02 21:55:46,656 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 21:55:47,359 - __main__ - INFO - Test Results: Loss=0.748307, Accuracy=0.6519\n2025-12-02 21:55:47,380 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/logs/test_classification_report_20251202_215547.json\n2025-12-02 21:55:47,597 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/plots/test_confusion_matrix_20251202_215547.png\n2025-12-02 21:55:47,630 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/training_summary_20251202_215547.json\n2025-12-02 21:55:47,633 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/latest_results.txt\n2025-12-02 21:55:47,633 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 21:55:47,633 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_51c54b17/training_summary_20251202_215547.json\n2025-12-02 21:55:47,633 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 548160/27408 = 20.0000 (2000.00%)\n2025-12-02 21:55:47,633 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.6515, Test Acc=0.6519\n",
      "return_code": 0
    },
    "config_normalized": {
      "config_name": "config_normalized",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized.conf",
      "start_time": 1764712554.312394,
      "status": "success",
      "duration": 226.28394722938538,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 21:55:56,799 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 21:55:56,799 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized.conf\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=True, quantiles=False, aggregation=None\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 21:55:56,801 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 21:55:56,802 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 21:55:56,802 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 21:55:56,802 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 21:55:56,802 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 21:55:56,802 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 21:55:56,802 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized.conf\n2025-12-02 21:55:56,802 - __main__ - INFO - Training Configuration:\n2025-12-02 21:55:56,802 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 21:55:56,802 - __main__ - INFO -   Patch size: 10\n2025-12-02 21:55:56,802 - __main__ - INFO -   Batch size: 32\n2025-12-02 21:55:56,802 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 21:55:56,802 - __main__ - INFO -   Optimizer: adam\n2025-12-02 21:55:57,456 - __main__ - INFO - Using device: cuda\n2025-12-02 21:55:57,458 - __main__ - INFO - Using config hash: 596294b3\n2025-12-02 21:55:57,458 - __main__ - INFO - Using run ID: 596294b3\n2025-12-02 21:55:57,458 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3\n2025-12-02 21:55:57,467 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/config_596294b3.json\n2025-12-02 21:55:57,471 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 21:55:57,474 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 21:55:58,646 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 21:55:58,867 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 21:55:58,879 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 21:55:58,879 - __main__ - INFO - Preparing data...\n2025-12-02 21:55:58,879 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 21:55:58,879 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 21:55:58,879 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 21:56:10,325 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 21:56:10,326 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 21:56:10,327 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 21:56:10,974 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 21:56:12,522 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 21:56:12,522 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 21:56:12,532 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 21:56:12,532 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 21:56:12,537 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 21:56:12,537 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 21:56:12,537 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 21:56:12,537 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 21:56:12,540 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 21:56:12,540 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 21:56:12,559 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 21:56:12,559 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 21:56:12,560 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 21:56:12,560 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 21:56:12,566 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 21:56:12,566 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 21:56:12,566 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 21:56:12,570 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 21:56:12,571 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 21:56:12,571 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 21:56:12,575 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 21:56:12,575 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 21:56:12,575 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 21:56:12,579 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 21:56:12,580 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 21:56:12,592 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:56:12,594 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 21:56:12,607 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 21:56:12,610 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 21:56:12,610 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 21:56:12,611 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 21:56:12,612 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 21:56:12,622 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 21:56:12,624 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 21:56:12,635 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 21:56:12,639 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 21:56:12,652 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 21:56:12,653 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 21:56:12,653 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 21:56:12,653 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 21:56:12,653 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 21:56:12,653 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 21:56:12,653 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 21:56:12,654 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 21:56:12,661 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 21:56:12,662 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 21:56:12,662 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 21:56:12,662 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 21:56:12,662 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 21:56:12,662 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 21:56:12,663 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 21:56:12,663 - __main__ - INFO - Loading train dataset...\n2025-12-02 21:56:12,663 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 21:56:12,902 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 21:56:14,144 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 21:56:14,897 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 21:56:14,982 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 21:56:15,006 - __main__ - INFO - Loaded 67828 train patches in 2.34s\n2025-12-02 21:56:15,009 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 21:56:15,010 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 21:56:15,010 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 21:56:15,014 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 21:56:15,022 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 21:56:15,029 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 21:56:15,036 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 21:56:15,134 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:56:15,224 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 21:56:15,224 - __main__ - INFO - Total available patches: 27408\n2025-12-02 21:56:15,224 - __main__ - INFO - Loading validation dataset...\n2025-12-02 21:56:15,224 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 21:56:15,240 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 21:56:15,735 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 21:56:15,847 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 21:56:15,873 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 21:56:15,880 - __main__ - INFO - Loaded 22192 validation patches in 0.66s\n2025-12-02 21:56:15,881 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 21:56:15,881 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 21:56:15,881 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 21:56:15,882 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 21:56:15,885 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 21:56:15,887 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 21:56:15,889 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 21:56:15,918 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:56:15,940 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 21:56:15,940 - __main__ - INFO - Total available patches: 8572\n2025-12-02 21:56:15,940 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 21:56:15,940 - __main__ - INFO - Training batches: 857\n2025-12-02 21:56:15,940 - __main__ - INFO - Validation batches: 268\n2025-12-02 21:56:15,940 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 21:56:15,940 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 21:56:21,476 - __main__ - INFO - Epoch 1/50 (5.54s): Train Loss: 1.036868, Train Acc: 0.4566, Val Loss: 1.085222, Val Acc: 0.4573\n2025-12-02 21:56:21,490 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_1.pth\n2025-12-02 21:56:21,490 - __main__ - INFO - New best validation accuracy: 0.4573\n2025-12-02 21:56:26,803 - __main__ - INFO - Epoch 2/50 (5.31s): Train Loss: 0.985449, Train Acc: 0.4967, Val Loss: 1.007466, Val Acc: 0.4563\n2025-12-02 21:56:32,109 - __main__ - INFO - Epoch 3/50 (5.31s): Train Loss: 0.969878, Train Acc: 0.5130, Val Loss: 0.971536, Val Acc: 0.4938\n2025-12-02 21:56:32,120 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_3.pth\n2025-12-02 21:56:32,121 - __main__ - INFO - New best validation accuracy: 0.4938\n2025-12-02 21:56:37,289 - __main__ - INFO - Epoch 4/50 (5.17s): Train Loss: 0.954025, Train Acc: 0.5293, Val Loss: 1.074816, Val Acc: 0.4837\n2025-12-02 21:56:42,398 - __main__ - INFO - Epoch 5/50 (5.11s): Train Loss: 0.942527, Train Acc: 0.5369, Val Loss: 0.894422, Val Acc: 0.5929\n2025-12-02 21:56:42,410 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_5.pth\n2025-12-02 21:56:42,410 - __main__ - INFO - New best validation accuracy: 0.5929\n2025-12-02 21:56:47,534 - __main__ - INFO - Epoch 6/50 (5.12s): Train Loss: 0.923417, Train Acc: 0.5501, Val Loss: 1.044449, Val Acc: 0.4883\n2025-12-02 21:56:52,772 - __main__ - INFO - Epoch 7/50 (5.24s): Train Loss: 0.915226, Train Acc: 0.5606, Val Loss: 0.843729, Val Acc: 0.6197\n2025-12-02 21:56:52,784 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_7.pth\n2025-12-02 21:56:52,784 - __main__ - INFO - New best validation accuracy: 0.6197\n2025-12-02 21:56:58,073 - __main__ - INFO - Epoch 8/50 (5.29s): Train Loss: 0.905537, Train Acc: 0.5691, Val Loss: 0.844649, Val Acc: 0.6186\n2025-12-02 21:57:03,342 - __main__ - INFO - Epoch 9/50 (5.27s): Train Loss: 0.901081, Train Acc: 0.5724, Val Loss: 0.841887, Val Acc: 0.6053\n2025-12-02 21:57:08,570 - __main__ - INFO - Epoch 10/50 (5.23s): Train Loss: 0.893436, Train Acc: 0.5740, Val Loss: 0.892227, Val Acc: 0.5733\n2025-12-02 21:57:08,582 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/checkpoint_epoch_10.pth\n2025-12-02 21:57:14,685 - __main__ - INFO - Epoch 11/50 (6.10s): Train Loss: 0.888550, Train Acc: 0.5801, Val Loss: 0.855682, Val Acc: 0.5920\n2025-12-02 21:57:19,882 - __main__ - INFO - Epoch 12/50 (5.20s): Train Loss: 0.882537, Train Acc: 0.5811, Val Loss: 0.937166, Val Acc: 0.5266\n2025-12-02 21:57:25,035 - __main__ - INFO - Epoch 13/50 (5.15s): Train Loss: 0.885187, Train Acc: 0.5853, Val Loss: 0.832941, Val Acc: 0.6312\n2025-12-02 21:57:25,047 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_13.pth\n2025-12-02 21:57:25,047 - __main__ - INFO - New best validation accuracy: 0.6312\n2025-12-02 21:57:30,216 - __main__ - INFO - Epoch 14/50 (5.17s): Train Loss: 0.878285, Train Acc: 0.5863, Val Loss: 0.826397, Val Acc: 0.6326\n2025-12-02 21:57:30,228 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_14.pth\n2025-12-02 21:57:30,228 - __main__ - INFO - New best validation accuracy: 0.6326\n2025-12-02 21:57:35,390 - __main__ - INFO - Epoch 15/50 (5.16s): Train Loss: 0.874352, Train Acc: 0.5919, Val Loss: 0.987873, Val Acc: 0.5338\n2025-12-02 21:57:40,487 - __main__ - INFO - Epoch 16/50 (5.10s): Train Loss: 0.876120, Train Acc: 0.5898, Val Loss: 0.875911, Val Acc: 0.6031\n2025-12-02 21:57:45,708 - __main__ - INFO - Epoch 17/50 (5.22s): Train Loss: 0.874402, Train Acc: 0.5911, Val Loss: 0.931953, Val Acc: 0.5699\n2025-12-02 21:57:50,758 - __main__ - INFO - Epoch 18/50 (5.05s): Train Loss: 0.871126, Train Acc: 0.5893, Val Loss: 0.807922, Val Acc: 0.6508\n2025-12-02 21:57:50,768 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_18.pth\n2025-12-02 21:57:50,768 - __main__ - INFO - New best validation accuracy: 0.6508\n2025-12-02 21:57:55,846 - __main__ - INFO - Epoch 19/50 (5.08s): Train Loss: 0.873765, Train Acc: 0.5915, Val Loss: 0.891247, Val Acc: 0.5871\n2025-12-02 21:58:00,998 - __main__ - INFO - Epoch 20/50 (5.15s): Train Loss: 0.869080, Train Acc: 0.5920, Val Loss: 0.829984, Val Acc: 0.6263\n2025-12-02 21:58:01,008 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/checkpoint_epoch_20.pth\n2025-12-02 21:58:06,110 - __main__ - INFO - Epoch 21/50 (5.10s): Train Loss: 0.865782, Train Acc: 0.5965, Val Loss: 0.918515, Val Acc: 0.5581\n2025-12-02 21:58:11,260 - __main__ - INFO - Epoch 22/50 (5.15s): Train Loss: 0.863463, Train Acc: 0.5967, Val Loss: 0.791991, Val Acc: 0.6500\n2025-12-02 21:58:16,482 - __main__ - INFO - Epoch 23/50 (5.22s): Train Loss: 0.861476, Train Acc: 0.5991, Val Loss: 0.941198, Val Acc: 0.5290\n2025-12-02 21:58:21,562 - __main__ - INFO - Epoch 24/50 (5.08s): Train Loss: 0.863141, Train Acc: 0.5998, Val Loss: 0.851562, Val Acc: 0.6253\n2025-12-02 21:58:26,796 - __main__ - INFO - Epoch 25/50 (5.23s): Train Loss: 0.854723, Train Acc: 0.6052, Val Loss: 0.862640, Val Acc: 0.6067\n2025-12-02 21:58:32,031 - __main__ - INFO - Epoch 26/50 (5.23s): Train Loss: 0.855717, Train Acc: 0.6078, Val Loss: 0.878172, Val Acc: 0.5842\n2025-12-02 21:58:37,286 - __main__ - INFO - Epoch 27/50 (5.26s): Train Loss: 0.856388, Train Acc: 0.6054, Val Loss: 0.828278, Val Acc: 0.6107\n2025-12-02 21:58:42,546 - __main__ - INFO - Epoch 28/50 (5.26s): Train Loss: 0.852883, Train Acc: 0.6065, Val Loss: 0.788407, Val Acc: 0.6547\n2025-12-02 21:58:42,558 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/best_model_epoch_28.pth\n2025-12-02 21:58:42,558 - __main__ - INFO - New best validation accuracy: 0.6547\n2025-12-02 21:58:47,719 - __main__ - INFO - Epoch 29/50 (5.16s): Train Loss: 0.852580, Train Acc: 0.6069, Val Loss: 0.793658, Val Acc: 0.6498\n2025-12-02 21:58:52,970 - __main__ - INFO - Epoch 30/50 (5.25s): Train Loss: 0.851296, Train Acc: 0.6097, Val Loss: 0.892065, Val Acc: 0.5931\n2025-12-02 21:58:52,982 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/models/checkpoint_epoch_30.pth\n2025-12-02 21:58:58,230 - __main__ - INFO - Epoch 31/50 (5.25s): Train Loss: 0.849054, Train Acc: 0.6089, Val Loss: 0.885759, Val Acc: 0.5470\n2025-12-02 21:59:03,441 - __main__ - INFO - Epoch 32/50 (5.21s): Train Loss: 0.847896, Train Acc: 0.6086, Val Loss: 0.782137, Val Acc: 0.6536\n2025-12-02 21:59:08,667 - __main__ - INFO - Epoch 33/50 (5.23s): Train Loss: 0.845244, Train Acc: 0.6074, Val Loss: 0.845345, Val Acc: 0.5918\n2025-12-02 21:59:13,785 - __main__ - INFO - Epoch 34/50 (5.12s): Train Loss: 0.846430, Train Acc: 0.6078, Val Loss: 0.796309, Val Acc: 0.6413\n2025-12-02 21:59:19,052 - __main__ - INFO - Epoch 35/50 (5.27s): Train Loss: 0.845337, Train Acc: 0.6103, Val Loss: 0.845211, Val Acc: 0.5967\n2025-12-02 21:59:24,311 - __main__ - INFO - Epoch 36/50 (5.26s): Train Loss: 0.844080, Train Acc: 0.6110, Val Loss: 0.775561, Val Acc: 0.6531\n2025-12-02 21:59:29,532 - __main__ - INFO - Epoch 37/50 (5.22s): Train Loss: 0.839855, Train Acc: 0.6149, Val Loss: 0.815183, Val Acc: 0.6220\n2025-12-02 21:59:34,619 - __main__ - INFO - Epoch 38/50 (5.09s): Train Loss: 0.845474, Train Acc: 0.6097, Val Loss: 0.834699, Val Acc: 0.6084\n2025-12-02 21:59:34,619 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 21:59:34,619 - __main__ - INFO - Training completed in 198.68s\n2025-12-02 21:59:34,619 - __main__ - INFO - Best validation accuracy: 0.6547\n2025-12-02 21:59:35,318 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/plots/training_history_20251202_215934.png\n2025-12-02 21:59:36,704 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/logs/classification_report_20251202_215936.json\n2025-12-02 21:59:36,704 - __main__ - INFO - Classification Results:\n2025-12-02 21:59:36,704 - __main__ - INFO -   Class 1: Precision=0.569, Recall=0.441, F1=0.497\n2025-12-02 21:59:36,704 - __main__ - INFO -   Class 4: Precision=0.572, Recall=0.800, F1=0.667\n2025-12-02 21:59:36,704 - __main__ - INFO -   Class 6: Precision=0.903, Recall=0.489, F1=0.635\n2025-12-02 21:59:36,704 - __main__ - INFO -   Class 12: Precision=0.548, Recall=0.704, F1=0.616\n2025-12-02 21:59:36,934 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/plots/confusion_matrix_20251202_215936.png\n2025-12-02 21:59:36,935 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 21:59:36,935 - __main__ - INFO - Evaluating on test set...\n2025-12-02 21:59:36,935 - __main__ - INFO - Loading test dataset...\n2025-12-02 21:59:36,935 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 21:59:36,947 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 21:59:37,358 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 21:59:37,453 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 21:59:37,477 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 21:59:37,481 - __main__ - INFO - Loaded 22857 test patches in 0.55s\n2025-12-02 21:59:37,483 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 21:59:37,483 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 21:59:37,483 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 21:59:37,485 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 21:59:37,487 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 21:59:37,489 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 21:59:37,491 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 21:59:37,510 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:59:37,525 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 21:59:37,525 - __main__ - INFO - Total available patches: 8936\n2025-12-02 21:59:37,525 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 21:59:38,949 - __main__ - INFO - Test Results: Loss=0.829599, Accuracy=0.5995\n2025-12-02 21:59:38,973 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/logs/test_classification_report_20251202_215938.json\n2025-12-02 21:59:39,201 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/plots/test_confusion_matrix_20251202_215938.png\n2025-12-02 21:59:39,236 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/training_summary_20251202_215939.json\n2025-12-02 21:59:39,239 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/latest_results.txt\n2025-12-02 21:59:39,239 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 21:59:39,239 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_596294b3/training_summary_20251202_215939.json\n2025-12-02 21:59:39,239 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 1041504/27408 = 38.0000 (3800.00%)\n2025-12-02 21:59:39,239 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.6547, Test Acc=0.5995\n",
      "return_code": 0
    },
    "config_normalized_mean": {
      "config_name": "config_normalized_mean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_mean.conf",
      "start_time": 1764712785.60357,
      "status": "success",
      "duration": 174.48336553573608,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 21:59:48,127 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 21:59:48,127 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_mean.conf\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=True, quantiles=False, aggregation=mean\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 21:59:48,130 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 21:59:48,130 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_mean.conf\n2025-12-02 21:59:48,130 - __main__ - INFO - Training Configuration:\n2025-12-02 21:59:48,130 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 21:59:48,130 - __main__ - INFO -   Patch size: 10\n2025-12-02 21:59:48,130 - __main__ - INFO -   Batch size: 32\n2025-12-02 21:59:48,130 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 21:59:48,130 - __main__ - INFO -   Optimizer: adam\n2025-12-02 21:59:48,776 - __main__ - INFO - Using device: cuda\n2025-12-02 21:59:48,779 - __main__ - INFO - Using config hash: b7d44125\n2025-12-02 21:59:48,779 - __main__ - INFO - Using run ID: b7d44125\n2025-12-02 21:59:48,779 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125\n2025-12-02 21:59:48,788 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/config_b7d44125.json\n2025-12-02 21:59:48,792 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 21:59:48,794 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-02 21:59:49,970 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-02 21:59:50,061 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 21:59:50,061 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-02 21:59:50,062 - __main__ - INFO - Preparing data...\n2025-12-02 21:59:50,062 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 21:59:50,062 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 21:59:50,062 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 22:00:01,562 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 22:00:01,562 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 22:00:01,563 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 22:00:02,220 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 22:00:03,761 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 22:00:03,762 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 22:00:03,769 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 22:00:03,769 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 22:00:03,773 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 22:00:03,773 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 22:00:03,773 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 22:00:03,773 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 22:00:03,777 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 22:00:03,778 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 22:00:03,797 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 22:00:03,797 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 22:00:03,797 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 22:00:03,798 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 22:00:03,803 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 22:00:03,803 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 22:00:03,804 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 22:00:03,808 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 22:00:03,808 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 22:00:03,808 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 22:00:03,812 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 22:00:03,812 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 22:00:03,812 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 22:00:03,816 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 22:00:03,816 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 22:00:03,829 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 22:00:03,831 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 22:00:03,844 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 22:00:03,848 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 22:00:03,848 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 22:00:03,849 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 22:00:03,849 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 22:00:03,859 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 22:00:03,862 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 22:00:03,873 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 22:00:03,878 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 22:00:03,890 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 22:00:03,891 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 22:00:03,899 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 22:00:03,900 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 22:00:03,900 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 22:00:03,900 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 22:00:03,900 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 22:00:03,901 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 22:00:03,901 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 22:00:03,901 - __main__ - INFO - Loading train dataset...\n2025-12-02 22:00:03,901 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 22:00:04,139 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 22:00:05,386 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 22:00:06,150 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 22:00:06,236 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 22:00:06,261 - __main__ - INFO - Loaded 67828 train patches in 2.36s\n2025-12-02 22:00:06,264 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 22:00:06,264 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 22:00:06,264 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 22:00:06,268 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 22:00:06,276 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 22:00:06,283 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 22:00:06,290 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 22:00:06,388 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 22:00:06,481 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 22:00:06,481 - __main__ - INFO - Total available patches: 27408\n2025-12-02 22:00:06,481 - __main__ - INFO - Loading validation dataset...\n2025-12-02 22:00:06,481 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 22:00:06,497 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 22:00:06,995 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 22:00:07,110 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 22:00:07,138 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 22:00:07,146 - __main__ - INFO - Loaded 22192 validation patches in 0.66s\n2025-12-02 22:00:07,147 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 22:00:07,147 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 22:00:07,147 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 22:00:07,149 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 22:00:07,151 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 22:00:07,153 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 22:00:07,156 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 22:00:07,186 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 22:00:07,207 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 22:00:07,207 - __main__ - INFO - Total available patches: 8572\n2025-12-02 22:00:07,207 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 22:00:07,208 - __main__ - INFO - Training batches: 857\n2025-12-02 22:00:07,208 - __main__ - INFO - Validation batches: 268\n2025-12-02 22:00:07,208 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 22:00:07,208 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 22:00:12,876 - __main__ - INFO - Epoch 1/50 (5.67s): Train Loss: 1.324579, Train Acc: 0.3305, Val Loss: 1.205211, Val Acc: 0.3994\n2025-12-02 22:00:12,887 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_1.pth\n2025-12-02 22:00:12,887 - __main__ - INFO - New best validation accuracy: 0.3994\n2025-12-02 22:00:18,347 - __main__ - INFO - Epoch 2/50 (5.46s): Train Loss: 1.186530, Train Acc: 0.3928, Val Loss: 1.143478, Val Acc: 0.4021\n2025-12-02 22:00:18,355 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_2.pth\n2025-12-02 22:00:18,355 - __main__ - INFO - New best validation accuracy: 0.4021\n2025-12-02 22:00:23,739 - __main__ - INFO - Epoch 3/50 (5.38s): Train Loss: 1.164945, Train Acc: 0.4025, Val Loss: 1.139725, Val Acc: 0.4172\n2025-12-02 22:00:23,748 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_3.pth\n2025-12-02 22:00:23,748 - __main__ - INFO - New best validation accuracy: 0.4172\n2025-12-02 22:00:29,260 - __main__ - INFO - Epoch 4/50 (5.51s): Train Loss: 1.160716, Train Acc: 0.4026, Val Loss: 1.141894, Val Acc: 0.4089\n2025-12-02 22:00:34,900 - __main__ - INFO - Epoch 5/50 (5.64s): Train Loss: 1.159007, Train Acc: 0.4065, Val Loss: 1.139144, Val Acc: 0.4126\n2025-12-02 22:00:40,262 - __main__ - INFO - Epoch 6/50 (5.36s): Train Loss: 1.158919, Train Acc: 0.4048, Val Loss: 1.136195, Val Acc: 0.4167\n2025-12-02 22:00:45,691 - __main__ - INFO - Epoch 7/50 (5.43s): Train Loss: 1.157788, Train Acc: 0.4046, Val Loss: 1.135068, Val Acc: 0.4179\n2025-12-02 22:00:45,698 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_7.pth\n2025-12-02 22:00:45,698 - __main__ - INFO - New best validation accuracy: 0.4179\n2025-12-02 22:00:50,883 - __main__ - INFO - Epoch 8/50 (5.19s): Train Loss: 1.157166, Train Acc: 0.4070, Val Loss: 1.134592, Val Acc: 0.4200\n2025-12-02 22:00:50,892 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_8.pth\n2025-12-02 22:00:50,892 - __main__ - INFO - New best validation accuracy: 0.4200\n2025-12-02 22:00:56,314 - __main__ - INFO - Epoch 9/50 (5.42s): Train Loss: 1.157246, Train Acc: 0.4078, Val Loss: 1.141146, Val Acc: 0.4152\n2025-12-02 22:01:01,766 - __main__ - INFO - Epoch 10/50 (5.45s): Train Loss: 1.155609, Train Acc: 0.4111, Val Loss: 1.142551, Val Acc: 0.4133\n2025-12-02 22:01:01,775 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/checkpoint_epoch_10.pth\n2025-12-02 22:01:07,108 - __main__ - INFO - Epoch 11/50 (5.33s): Train Loss: 1.156820, Train Acc: 0.4100, Val Loss: 1.136467, Val Acc: 0.4103\n2025-12-02 22:01:12,427 - __main__ - INFO - Epoch 12/50 (5.32s): Train Loss: 1.156414, Train Acc: 0.4096, Val Loss: 1.136364, Val Acc: 0.4231\n2025-12-02 22:01:12,434 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_12.pth\n2025-12-02 22:01:12,434 - __main__ - INFO - New best validation accuracy: 0.4231\n2025-12-02 22:01:18,594 - __main__ - INFO - Epoch 13/50 (6.16s): Train Loss: 1.156190, Train Acc: 0.4074, Val Loss: 1.138561, Val Acc: 0.4119\n2025-12-02 22:01:24,047 - __main__ - INFO - Epoch 14/50 (5.45s): Train Loss: 1.154968, Train Acc: 0.4052, Val Loss: 1.134728, Val Acc: 0.4161\n2025-12-02 22:01:29,171 - __main__ - INFO - Epoch 15/50 (5.12s): Train Loss: 1.155514, Train Acc: 0.4066, Val Loss: 1.133880, Val Acc: 0.4197\n2025-12-02 22:01:34,478 - __main__ - INFO - Epoch 16/50 (5.31s): Train Loss: 1.155043, Train Acc: 0.4095, Val Loss: 1.134334, Val Acc: 0.4200\n2025-12-02 22:01:39,742 - __main__ - INFO - Epoch 17/50 (5.26s): Train Loss: 1.156011, Train Acc: 0.4116, Val Loss: 1.134792, Val Acc: 0.4250\n2025-12-02 22:01:39,751 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/best_model_epoch_17.pth\n2025-12-02 22:01:39,751 - __main__ - INFO - New best validation accuracy: 0.4250\n2025-12-02 22:01:45,155 - __main__ - INFO - Epoch 18/50 (5.40s): Train Loss: 1.155826, Train Acc: 0.4107, Val Loss: 1.136829, Val Acc: 0.4196\n2025-12-02 22:01:50,417 - __main__ - INFO - Epoch 19/50 (5.26s): Train Loss: 1.155868, Train Acc: 0.4102, Val Loss: 1.134053, Val Acc: 0.4178\n2025-12-02 22:01:55,626 - __main__ - INFO - Epoch 20/50 (5.21s): Train Loss: 1.154924, Train Acc: 0.4079, Val Loss: 1.135450, Val Acc: 0.4216\n2025-12-02 22:01:55,634 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/models/checkpoint_epoch_20.pth\n2025-12-02 22:02:01,006 - __main__ - INFO - Epoch 21/50 (5.37s): Train Loss: 1.156145, Train Acc: 0.4091, Val Loss: 1.135360, Val Acc: 0.4165\n2025-12-02 22:02:06,819 - __main__ - INFO - Epoch 22/50 (5.81s): Train Loss: 1.153974, Train Acc: 0.4108, Val Loss: 1.135026, Val Acc: 0.4185\n2025-12-02 22:02:12,263 - __main__ - INFO - Epoch 23/50 (5.44s): Train Loss: 1.153037, Train Acc: 0.4094, Val Loss: 1.136655, Val Acc: 0.4157\n2025-12-02 22:02:17,566 - __main__ - INFO - Epoch 24/50 (5.30s): Train Loss: 1.154289, Train Acc: 0.4119, Val Loss: 1.133958, Val Acc: 0.4225\n2025-12-02 22:02:22,856 - __main__ - INFO - Epoch 25/50 (5.29s): Train Loss: 1.155252, Train Acc: 0.4116, Val Loss: 1.136904, Val Acc: 0.4197\n2025-12-02 22:02:28,427 - __main__ - INFO - Epoch 26/50 (5.57s): Train Loss: 1.154110, Train Acc: 0.4092, Val Loss: 1.134331, Val Acc: 0.4186\n2025-12-02 22:02:33,746 - __main__ - INFO - Epoch 27/50 (5.32s): Train Loss: 1.154291, Train Acc: 0.4163, Val Loss: 1.136127, Val Acc: 0.4209\n2025-12-02 22:02:33,746 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 22:02:33,746 - __main__ - INFO - Training completed in 146.54s\n2025-12-02 22:02:33,746 - __main__ - INFO - Best validation accuracy: 0.4250\n2025-12-02 22:02:34,452 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/plots/training_history_20251202_220233.png\n2025-12-02 22:02:35,890 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/logs/classification_report_20251202_220235.json\n2025-12-02 22:02:35,891 - __main__ - INFO - Classification Results:\n2025-12-02 22:02:35,891 - __main__ - INFO -   Class 1: Precision=0.500, Recall=0.451, F1=0.474\n2025-12-02 22:02:35,891 - __main__ - INFO -   Class 4: Precision=0.467, Recall=0.301, F1=0.366\n2025-12-02 22:02:35,891 - __main__ - INFO -   Class 6: Precision=0.399, Recall=0.497, F1=0.443\n2025-12-02 22:02:35,891 - __main__ - INFO -   Class 12: Precision=0.360, Recall=0.434, F1=0.394\n2025-12-02 22:02:36,101 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/plots/confusion_matrix_20251202_220235.png\n2025-12-02 22:02:36,102 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 22:02:36,102 - __main__ - INFO - Evaluating on test set...\n2025-12-02 22:02:36,102 - __main__ - INFO - Loading test dataset...\n2025-12-02 22:02:36,102 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 22:02:36,115 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 22:02:36,684 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 22:02:36,782 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 22:02:36,806 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 22:02:36,810 - __main__ - INFO - Loaded 22857 test patches in 0.71s\n2025-12-02 22:02:36,812 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 22:02:36,812 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 22:02:36,812 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 22:02:36,814 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 22:02:36,816 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 22:02:36,818 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 22:02:36,820 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 22:02:36,839 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 22:02:36,858 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 22:02:36,858 - __main__ - INFO - Total available patches: 8936\n2025-12-02 22:02:36,858 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 22:02:38,347 - __main__ - INFO - Test Results: Loss=1.141876, Accuracy=0.4080\n2025-12-02 22:02:38,368 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/logs/test_classification_report_20251202_220238.json\n2025-12-02 22:02:38,592 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/plots/test_confusion_matrix_20251202_220238.png\n2025-12-02 22:02:38,614 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/training_summary_20251202_220238.json\n2025-12-02 22:02:38,617 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/latest_results.txt\n2025-12-02 22:02:38,617 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 22:02:38,617 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b7d44125/training_summary_20251202_220238.json\n2025-12-02 22:02:38,617 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 740016/27408 = 27.0000 (2700.00%)\n2025-12-02 22:02:38,617 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4250, Test Acc=0.4080\n",
      "return_code": 0
    },
    "config_normalized_quantiles": {
      "config_name": "config_normalized_quantiles",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_quantiles.conf",
      "start_time": 1764712965.094531,
      "status": "timeout",
      "duration": 3600,
      "error_message": "Training timed out after 1 hour",
      "stdout": "",
      "stderr": ""
    },
    "config_normalized_shuffled": {
      "config_name": "config_normalized_shuffled",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_shuffled.conf",
      "start_time": 1764716570.2086477,
      "status": "success",
      "duration": 288.41931223869324,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:02:53,018 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:02:53,018 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_shuffled.conf\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=True, zero_mean=False, normalized=True, quantiles=False, aggregation=None\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:02:53,021 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 23:02:53,021 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_shuffled.conf\n2025-12-02 23:02:53,021 - __main__ - INFO - Training Configuration:\n2025-12-02 23:02:53,021 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:02:53,021 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:02:53,021 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:02:53,021 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 23:02:53,021 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:02:53,667 - __main__ - INFO - Using device: cuda\n2025-12-02 23:02:53,670 - __main__ - INFO - Using config hash: e4ff94e0\n2025-12-02 23:02:53,670 - __main__ - INFO - Using run ID: e4ff94e0\n2025-12-02 23:02:53,670 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0\n2025-12-02 23:02:53,679 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/config_e4ff94e0.json\n2025-12-02 23:02:53,683 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 23:02:53,686 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 23:02:53,686 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 23:02:53,686 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 23:02:53,686 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 23:02:53,686 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 23:02:53,686 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 23:02:53,687 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 23:02:53,687 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 23:02:53,687 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 23:02:54,676 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 23:02:54,888 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 23:02:54,897 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 23:02:54,897 - __main__ - INFO - Preparing data...\n2025-12-02 23:02:54,898 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:02:54,898 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:02:54,898 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:03:05,962 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:03:05,963 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:03:05,964 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:03:06,535 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:03:07,546 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:03:07,546 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:03:07,559 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:03:07,559 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:03:07,563 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:03:07,563 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:03:07,563 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:03:07,563 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:03:07,566 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:03:07,566 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:03:08,173 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:03:08,173 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:03:08,174 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:03:08,174 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:03:08,180 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:03:08,180 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:03:08,180 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:03:08,184 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:03:08,184 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:03:08,184 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:03:08,188 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:03:08,188 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:03:08,188 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:03:08,192 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:03:08,192 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:03:08,203 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:03:08,205 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:03:08,215 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:03:08,219 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:03:08,219 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:03:08,220 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:03:08,220 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:03:08,229 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:03:08,232 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:03:08,242 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:03:08,245 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:03:08,255 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:03:08,256 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:03:08,263 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:03:08,263 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:03:08,263 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:03:08,264 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:03:08,264 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:03:08,264 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:03:08,264 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:03:08,264 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:03:08,264 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:03:08,418 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:03:09,364 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:03:09,901 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:03:09,962 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:03:09,978 - __main__ - INFO - Loaded 67828 train patches in 1.71s\n2025-12-02 23:03:09,981 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:03:09,981 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:03:09,981 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:03:09,985 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:03:09,991 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:03:09,997 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:03:10,003 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:03:10,066 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:03:10,131 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:03:10,131 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:03:10,131 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:03:10,131 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:03:10,145 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:03:10,503 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:03:10,596 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:03:10,616 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:03:10,620 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-02 23:03:10,621 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:03:10,621 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:03:10,621 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:03:10,622 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:03:10,625 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:03:10,627 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:03:10,629 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:03:10,647 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:03:10,662 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:03:10,662 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:03:10,662 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:03:10,662 - __main__ - INFO - Training batches: 857\n2025-12-02 23:03:10,662 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:03:10,662 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:03:10,662 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:03:16,118 - __main__ - INFO - Epoch 1/50 (5.46s): Train Loss: 1.049539, Train Acc: 0.4512, Val Loss: 0.981609, Val Acc: 0.4741\n2025-12-02 23:03:16,131 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_1.pth\n2025-12-02 23:03:16,131 - __main__ - INFO - New best validation accuracy: 0.4741\n2025-12-02 23:03:21,359 - __main__ - INFO - Epoch 2/50 (5.23s): Train Loss: 1.008737, Train Acc: 0.4648, Val Loss: 0.968367, Val Acc: 0.5037\n2025-12-02 23:03:21,371 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_2.pth\n2025-12-02 23:03:21,371 - __main__ - INFO - New best validation accuracy: 0.5037\n2025-12-02 23:03:26,664 - __main__ - INFO - Epoch 3/50 (5.29s): Train Loss: 0.994009, Train Acc: 0.4773, Val Loss: 0.966454, Val Acc: 0.5138\n2025-12-02 23:03:26,676 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_3.pth\n2025-12-02 23:03:26,676 - __main__ - INFO - New best validation accuracy: 0.5138\n2025-12-02 23:03:31,816 - __main__ - INFO - Epoch 4/50 (5.14s): Train Loss: 0.992977, Train Acc: 0.4837, Val Loss: 0.964633, Val Acc: 0.5138\n2025-12-02 23:03:36,916 - __main__ - INFO - Epoch 5/50 (5.10s): Train Loss: 0.986541, Train Acc: 0.4858, Val Loss: 0.982950, Val Acc: 0.5117\n2025-12-02 23:03:42,107 - __main__ - INFO - Epoch 6/50 (5.19s): Train Loss: 0.988251, Train Acc: 0.4918, Val Loss: 0.960918, Val Acc: 0.5219\n2025-12-02 23:03:42,119 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_6.pth\n2025-12-02 23:03:42,119 - __main__ - INFO - New best validation accuracy: 0.5219\n2025-12-02 23:03:47,448 - __main__ - INFO - Epoch 7/50 (5.33s): Train Loss: 0.980476, Train Acc: 0.4979, Val Loss: 0.953827, Val Acc: 0.5289\n2025-12-02 23:03:47,460 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_7.pth\n2025-12-02 23:03:47,460 - __main__ - INFO - New best validation accuracy: 0.5289\n2025-12-02 23:03:52,670 - __main__ - INFO - Epoch 8/50 (5.21s): Train Loss: 0.975423, Train Acc: 0.5024, Val Loss: 0.944220, Val Acc: 0.5314\n2025-12-02 23:03:52,682 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_8.pth\n2025-12-02 23:03:52,683 - __main__ - INFO - New best validation accuracy: 0.5314\n2025-12-02 23:03:57,858 - __main__ - INFO - Epoch 9/50 (5.17s): Train Loss: 0.972557, Train Acc: 0.5116, Val Loss: 0.953149, Val Acc: 0.5222\n2025-12-02 23:04:03,156 - __main__ - INFO - Epoch 10/50 (5.30s): Train Loss: 0.967457, Train Acc: 0.5164, Val Loss: 0.939282, Val Acc: 0.5413\n2025-12-02 23:04:03,168 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_10.pth\n2025-12-02 23:04:03,168 - __main__ - INFO - New best validation accuracy: 0.5413\n2025-12-02 23:04:03,177 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/checkpoint_epoch_10.pth\n2025-12-02 23:04:08,454 - __main__ - INFO - Epoch 11/50 (5.28s): Train Loss: 0.969501, Train Acc: 0.5207, Val Loss: 0.940685, Val Acc: 0.5407\n2025-12-02 23:04:13,739 - __main__ - INFO - Epoch 12/50 (5.28s): Train Loss: 0.962931, Train Acc: 0.5275, Val Loss: 0.960777, Val Acc: 0.5518\n2025-12-02 23:04:13,752 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_12.pth\n2025-12-02 23:04:13,752 - __main__ - INFO - New best validation accuracy: 0.5518\n2025-12-02 23:04:19,081 - __main__ - INFO - Epoch 13/50 (5.33s): Train Loss: 0.961022, Train Acc: 0.5248, Val Loss: 0.917475, Val Acc: 0.5660\n2025-12-02 23:04:19,093 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_13.pth\n2025-12-02 23:04:19,093 - __main__ - INFO - New best validation accuracy: 0.5660\n2025-12-02 23:04:24,293 - __main__ - INFO - Epoch 14/50 (5.20s): Train Loss: 0.962034, Train Acc: 0.5267, Val Loss: 0.923385, Val Acc: 0.5686\n2025-12-02 23:04:24,306 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_14.pth\n2025-12-02 23:04:24,306 - __main__ - INFO - New best validation accuracy: 0.5686\n2025-12-02 23:04:29,497 - __main__ - INFO - Epoch 15/50 (5.19s): Train Loss: 0.960750, Train Acc: 0.5301, Val Loss: 0.923464, Val Acc: 0.5498\n2025-12-02 23:04:34,675 - __main__ - INFO - Epoch 16/50 (5.18s): Train Loss: 0.956692, Train Acc: 0.5335, Val Loss: 0.923608, Val Acc: 0.5381\n2025-12-02 23:04:39,826 - __main__ - INFO - Epoch 17/50 (5.15s): Train Loss: 0.957131, Train Acc: 0.5389, Val Loss: 0.964027, Val Acc: 0.5157\n2025-12-02 23:04:45,029 - __main__ - INFO - Epoch 18/50 (5.20s): Train Loss: 0.951943, Train Acc: 0.5385, Val Loss: 0.926599, Val Acc: 0.5516\n2025-12-02 23:04:50,301 - __main__ - INFO - Epoch 19/50 (5.27s): Train Loss: 0.951176, Train Acc: 0.5377, Val Loss: 0.920263, Val Acc: 0.5625\n2025-12-02 23:04:55,585 - __main__ - INFO - Epoch 20/50 (5.28s): Train Loss: 0.947629, Train Acc: 0.5407, Val Loss: 0.909953, Val Acc: 0.5714\n2025-12-02 23:04:55,598 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_20.pth\n2025-12-02 23:04:55,598 - __main__ - INFO - New best validation accuracy: 0.5714\n2025-12-02 23:04:55,606 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/checkpoint_epoch_20.pth\n2025-12-02 23:05:00,844 - __main__ - INFO - Epoch 21/50 (5.24s): Train Loss: 0.945398, Train Acc: 0.5455, Val Loss: 0.980143, Val Acc: 0.5314\n2025-12-02 23:05:06,079 - __main__ - INFO - Epoch 22/50 (5.23s): Train Loss: 0.948131, Train Acc: 0.5438, Val Loss: 0.901598, Val Acc: 0.5772\n2025-12-02 23:05:06,092 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_22.pth\n2025-12-02 23:05:06,092 - __main__ - INFO - New best validation accuracy: 0.5772\n2025-12-02 23:05:11,289 - __main__ - INFO - Epoch 23/50 (5.20s): Train Loss: 0.942885, Train Acc: 0.5473, Val Loss: 0.915821, Val Acc: 0.5631\n2025-12-02 23:05:16,675 - __main__ - INFO - Epoch 24/50 (5.39s): Train Loss: 0.943011, Train Acc: 0.5445, Val Loss: 0.962287, Val Acc: 0.5245\n2025-12-02 23:05:21,849 - __main__ - INFO - Epoch 25/50 (5.17s): Train Loss: 0.935900, Train Acc: 0.5535, Val Loss: 0.916008, Val Acc: 0.5492\n2025-12-02 23:05:27,083 - __main__ - INFO - Epoch 26/50 (5.23s): Train Loss: 0.938353, Train Acc: 0.5524, Val Loss: 0.941026, Val Acc: 0.5495\n2025-12-02 23:05:32,242 - __main__ - INFO - Epoch 27/50 (5.16s): Train Loss: 0.933953, Train Acc: 0.5572, Val Loss: 0.890585, Val Acc: 0.5902\n2025-12-02 23:05:32,254 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_27.pth\n2025-12-02 23:05:32,254 - __main__ - INFO - New best validation accuracy: 0.5902\n2025-12-02 23:05:37,330 - __main__ - INFO - Epoch 28/50 (5.08s): Train Loss: 0.933383, Train Acc: 0.5566, Val Loss: 0.912297, Val Acc: 0.5787\n2025-12-02 23:05:42,553 - __main__ - INFO - Epoch 29/50 (5.22s): Train Loss: 0.927289, Train Acc: 0.5621, Val Loss: 0.905891, Val Acc: 0.5813\n2025-12-02 23:05:47,956 - __main__ - INFO - Epoch 30/50 (5.40s): Train Loss: 0.927974, Train Acc: 0.5602, Val Loss: 0.921072, Val Acc: 0.5514\n2025-12-02 23:05:47,968 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/checkpoint_epoch_30.pth\n2025-12-02 23:05:53,161 - __main__ - INFO - Epoch 31/50 (5.19s): Train Loss: 0.926733, Train Acc: 0.5629, Val Loss: 0.875509, Val Acc: 0.5979\n2025-12-02 23:05:53,172 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_31.pth\n2025-12-02 23:05:53,172 - __main__ - INFO - New best validation accuracy: 0.5979\n2025-12-02 23:05:58,378 - __main__ - INFO - Epoch 32/50 (5.21s): Train Loss: 0.921960, Train Acc: 0.5634, Val Loss: 0.887393, Val Acc: 0.5839\n2025-12-02 23:06:03,622 - __main__ - INFO - Epoch 33/50 (5.24s): Train Loss: 0.922826, Train Acc: 0.5605, Val Loss: 0.891785, Val Acc: 0.5840\n2025-12-02 23:06:09,015 - __main__ - INFO - Epoch 34/50 (5.39s): Train Loss: 0.920537, Train Acc: 0.5632, Val Loss: 0.887004, Val Acc: 0.5895\n2025-12-02 23:06:14,280 - __main__ - INFO - Epoch 35/50 (5.27s): Train Loss: 0.923668, Train Acc: 0.5631, Val Loss: 0.873219, Val Acc: 0.5996\n2025-12-02 23:06:14,292 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_35.pth\n2025-12-02 23:06:14,292 - __main__ - INFO - New best validation accuracy: 0.5996\n2025-12-02 23:06:19,547 - __main__ - INFO - Epoch 36/50 (5.25s): Train Loss: 0.914261, Train Acc: 0.5733, Val Loss: 0.875001, Val Acc: 0.5933\n2025-12-02 23:06:24,796 - __main__ - INFO - Epoch 37/50 (5.25s): Train Loss: 0.913262, Train Acc: 0.5670, Val Loss: 0.905199, Val Acc: 0.5710\n2025-12-02 23:06:29,885 - __main__ - INFO - Epoch 38/50 (5.09s): Train Loss: 0.913000, Train Acc: 0.5727, Val Loss: 0.868528, Val Acc: 0.5967\n2025-12-02 23:06:35,230 - __main__ - INFO - Epoch 39/50 (5.34s): Train Loss: 0.914371, Train Acc: 0.5670, Val Loss: 0.946940, Val Acc: 0.5337\n2025-12-02 23:06:40,498 - __main__ - INFO - Epoch 40/50 (5.27s): Train Loss: 0.909711, Train Acc: 0.5733, Val Loss: 0.858317, Val Acc: 0.6157\n2025-12-02 23:06:40,507 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_40.pth\n2025-12-02 23:06:40,507 - __main__ - INFO - New best validation accuracy: 0.6157\n2025-12-02 23:06:40,513 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/checkpoint_epoch_40.pth\n2025-12-02 23:06:45,702 - __main__ - INFO - Epoch 41/50 (5.19s): Train Loss: 0.905836, Train Acc: 0.5729, Val Loss: 0.858214, Val Acc: 0.6161\n2025-12-02 23:06:45,713 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_41.pth\n2025-12-02 23:06:45,713 - __main__ - INFO - New best validation accuracy: 0.6161\n2025-12-02 23:06:50,927 - __main__ - INFO - Epoch 42/50 (5.21s): Train Loss: 0.906496, Train Acc: 0.5756, Val Loss: 0.882098, Val Acc: 0.6008\n2025-12-02 23:06:56,117 - __main__ - INFO - Epoch 43/50 (5.19s): Train Loss: 0.902112, Train Acc: 0.5759, Val Loss: 0.863458, Val Acc: 0.5973\n2025-12-02 23:07:01,385 - __main__ - INFO - Epoch 44/50 (5.27s): Train Loss: 0.900561, Train Acc: 0.5770, Val Loss: 0.857381, Val Acc: 0.6025\n2025-12-02 23:07:06,552 - __main__ - INFO - Epoch 45/50 (5.17s): Train Loss: 0.898787, Train Acc: 0.5799, Val Loss: 0.851515, Val Acc: 0.6123\n2025-12-02 23:07:11,741 - __main__ - INFO - Epoch 46/50 (5.19s): Train Loss: 0.902321, Train Acc: 0.5790, Val Loss: 0.848194, Val Acc: 0.6185\n2025-12-02 23:07:11,753 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/best_model_epoch_46.pth\n2025-12-02 23:07:11,753 - __main__ - INFO - New best validation accuracy: 0.6185\n2025-12-02 23:07:16,917 - __main__ - INFO - Epoch 47/50 (5.16s): Train Loss: 0.898359, Train Acc: 0.5788, Val Loss: 0.851106, Val Acc: 0.6123\n2025-12-02 23:07:22,125 - __main__ - INFO - Epoch 48/50 (5.21s): Train Loss: 0.896515, Train Acc: 0.5803, Val Loss: 0.903627, Val Acc: 0.5581\n2025-12-02 23:07:27,325 - __main__ - INFO - Epoch 49/50 (5.20s): Train Loss: 0.895103, Train Acc: 0.5826, Val Loss: 0.849305, Val Acc: 0.6154\n2025-12-02 23:07:32,568 - __main__ - INFO - Epoch 50/50 (5.24s): Train Loss: 0.891912, Train Acc: 0.5807, Val Loss: 0.847225, Val Acc: 0.6140\n2025-12-02 23:07:32,580 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/models/checkpoint_epoch_50.pth\n2025-12-02 23:07:32,580 - __main__ - INFO - Training completed in 261.92s\n2025-12-02 23:07:32,580 - __main__ - INFO - Best validation accuracy: 0.6185\n2025-12-02 23:07:33,294 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/plots/training_history_20251202_230732.png\n2025-12-02 23:07:34,701 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/logs/classification_report_20251202_230734.json\n2025-12-02 23:07:34,701 - __main__ - INFO - Classification Results:\n2025-12-02 23:07:34,701 - __main__ - INFO -   Class 1: Precision=0.535, Recall=0.550, F1=0.542\n2025-12-02 23:07:34,701 - __main__ - INFO -   Class 4: Precision=0.609, Recall=0.763, F1=0.678\n2025-12-02 23:07:34,701 - __main__ - INFO -   Class 6: Precision=0.806, Recall=0.618, F1=0.700\n2025-12-02 23:07:34,701 - __main__ - INFO -   Class 12: Precision=0.551, Recall=0.524, F1=0.537\n2025-12-02 23:07:34,912 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/plots/confusion_matrix_20251202_230734.png\n2025-12-02 23:07:34,913 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:07:34,913 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:07:34,913 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:07:34,913 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:07:34,925 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:07:35,334 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:07:35,429 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:07:35,453 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:07:35,457 - __main__ - INFO - Loaded 22857 test patches in 0.54s\n2025-12-02 23:07:35,459 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:07:35,459 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:07:35,459 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:07:35,460 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:07:35,462 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:07:35,464 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:07:35,466 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:07:35,485 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:07:35,500 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:07:35,500 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:07:35,500 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:07:36,943 - __main__ - INFO - Test Results: Loss=0.837270, Accuracy=0.6074\n2025-12-02 23:07:36,964 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/logs/test_classification_report_20251202_230736.json\n2025-12-02 23:07:37,196 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/plots/test_confusion_matrix_20251202_230736.png\n2025-12-02 23:07:37,233 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/training_summary_20251202_230737.json\n2025-12-02 23:07:37,236 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/latest_results.txt\n2025-12-02 23:07:37,236 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:07:37,236 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_e4ff94e0/training_summary_20251202_230737.json\n2025-12-02 23:07:37,236 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 1370400/27408 = 50.0000 (5000.00%)\n2025-12-02 23:07:37,236 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.6185, Test Acc=0.6074\n",
      "return_code": 0
    },
    "config_normalized_std": {
      "config_name": "config_normalized_std",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_std.conf",
      "start_time": 1764716863.6357725,
      "status": "success",
      "duration": 91.24854969978333,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:07:46,022 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:07:46,022 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_std.conf\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=True, quantiles=False, aggregation=std\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:07:46,025 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 23:07:46,025 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_std.conf\n2025-12-02 23:07:46,025 - __main__ - INFO - Training Configuration:\n2025-12-02 23:07:46,025 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:07:46,025 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:07:46,025 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:07:46,025 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 23:07:46,025 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:07:46,673 - __main__ - INFO - Using device: cuda\n2025-12-02 23:07:46,676 - __main__ - INFO - Using config hash: ddd63c46\n2025-12-02 23:07:46,676 - __main__ - INFO - Using run ID: ddd63c46\n2025-12-02 23:07:46,676 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46\n2025-12-02 23:07:46,684 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/config_ddd63c46.json\n2025-12-02 23:07:46,688 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 23:07:46,691 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-02 23:07:47,849 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-02 23:07:47,935 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 23:07:47,936 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-02 23:07:47,937 - __main__ - INFO - Preparing data...\n2025-12-02 23:07:47,937 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:07:47,937 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:07:47,937 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:07:59,487 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:07:59,487 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:07:59,488 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:08:00,134 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:08:01,691 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:08:01,691 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:08:01,699 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:08:01,699 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:08:01,703 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:08:01,703 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:08:01,703 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:08:01,703 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:08:01,706 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:08:01,707 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:08:01,726 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:08:01,726 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:08:01,727 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:08:01,727 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:08:01,733 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:08:01,733 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:08:01,733 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:08:01,738 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:08:01,738 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:08:01,738 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:08:01,742 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:08:01,742 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:08:01,742 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:08:01,746 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:08:01,746 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:08:01,758 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:08:01,761 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:08:01,773 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:08:01,777 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:08:01,777 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:08:01,778 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:08:01,778 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:08:01,788 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:08:01,791 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:08:01,802 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:08:01,806 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:08:01,818 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:08:01,819 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:08:01,827 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:08:01,828 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:08:01,828 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:08:01,828 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:08:01,828 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:08:01,828 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:08:01,828 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:08:01,829 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:08:01,829 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:08:02,062 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:08:03,299 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:08:04,051 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:08:04,137 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:08:04,161 - __main__ - INFO - Loaded 67828 train patches in 2.33s\n2025-12-02 23:08:04,164 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:08:04,164 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:08:04,164 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:08:04,169 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:08:04,176 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:08:04,183 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:08:04,190 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:08:04,288 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:08:04,381 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:08:04,381 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:08:04,381 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:08:04,381 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:08:04,396 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:08:04,914 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:08:05,033 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:08:05,060 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:08:05,067 - __main__ - INFO - Loaded 22192 validation patches in 0.69s\n2025-12-02 23:08:05,068 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:08:05,068 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:08:05,068 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:08:05,070 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:08:05,072 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:08:05,074 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:08:05,077 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:08:05,106 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:08:05,127 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:08:05,128 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:08:05,128 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:08:05,128 - __main__ - INFO - Training batches: 857\n2025-12-02 23:08:05,128 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:08:05,128 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:08:05,128 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:08:11,118 - __main__ - INFO - Epoch 1/50 (5.99s): Train Loss: 1.388953, Train Acc: 0.2504, Val Loss: 1.386475, Val Acc: 0.2500\n2025-12-02 23:08:11,129 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/models/best_model_epoch_1.pth\n2025-12-02 23:08:11,129 - __main__ - INFO - New best validation accuracy: 0.2500\n2025-12-02 23:08:16,764 - __main__ - INFO - Epoch 2/50 (5.63s): Train Loss: 1.387681, Train Acc: 0.2486, Val Loss: 1.386804, Val Acc: 0.2500\n2025-12-02 23:08:22,593 - __main__ - INFO - Epoch 3/50 (5.83s): Train Loss: 1.387022, Train Acc: 0.2511, Val Loss: 1.386551, Val Acc: 0.2500\n2025-12-02 23:08:28,145 - __main__ - INFO - Epoch 4/50 (5.55s): Train Loss: 1.386777, Train Acc: 0.2485, Val Loss: 1.386919, Val Acc: 0.2500\n2025-12-02 23:08:34,065 - __main__ - INFO - Epoch 5/50 (5.92s): Train Loss: 1.386519, Train Acc: 0.2492, Val Loss: 1.386469, Val Acc: 0.2500\n2025-12-02 23:08:39,637 - __main__ - INFO - Epoch 6/50 (5.57s): Train Loss: 1.386541, Train Acc: 0.2451, Val Loss: 1.386403, Val Acc: 0.2500\n2025-12-02 23:08:45,251 - __main__ - INFO - Epoch 7/50 (5.61s): Train Loss: 1.386497, Train Acc: 0.2491, Val Loss: 1.386307, Val Acc: 0.2500\n2025-12-02 23:08:50,831 - __main__ - INFO - Epoch 8/50 (5.58s): Train Loss: 1.386426, Train Acc: 0.2475, Val Loss: 1.386331, Val Acc: 0.2500\n2025-12-02 23:08:56,557 - __main__ - INFO - Epoch 9/50 (5.73s): Train Loss: 1.386414, Train Acc: 0.2467, Val Loss: 1.386328, Val Acc: 0.2500\n2025-12-02 23:09:02,325 - __main__ - INFO - Epoch 10/50 (5.77s): Train Loss: 1.386394, Train Acc: 0.2488, Val Loss: 1.386311, Val Acc: 0.2500\n2025-12-02 23:09:02,333 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/models/checkpoint_epoch_10.pth\n2025-12-02 23:09:08,042 - __main__ - INFO - Epoch 11/50 (5.71s): Train Loss: 1.386380, Train Acc: 0.2495, Val Loss: 1.386336, Val Acc: 0.2500\n2025-12-02 23:09:08,043 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 23:09:08,043 - __main__ - INFO - Training completed in 62.91s\n2025-12-02 23:09:08,043 - __main__ - INFO - Best validation accuracy: 0.2500\n2025-12-02 23:09:08,734 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/plots/training_history_20251202_230908.png\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-02 23:09:10,268 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/logs/classification_report_20251202_230910.json\n2025-12-02 23:09:10,268 - __main__ - INFO - Classification Results:\n2025-12-02 23:09:10,268 - __main__ - INFO -   Class 1: Precision=0.250, Recall=1.000, F1=0.400\n2025-12-02 23:09:10,268 - __main__ - INFO -   Class 4: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:09:10,268 - __main__ - INFO -   Class 6: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:09:10,268 - __main__ - INFO -   Class 12: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:09:10,500 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/plots/confusion_matrix_20251202_230910.png\n2025-12-02 23:09:10,502 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:09:10,502 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:09:10,502 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:09:10,502 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:09:10,514 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:09:10,960 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:09:11,292 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:09:11,315 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:09:11,319 - __main__ - INFO - Loaded 22857 test patches in 0.82s\n2025-12-02 23:09:11,322 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:09:11,322 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:09:11,322 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:09:11,323 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:09:11,326 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:09:11,327 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:09:11,329 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:09:11,349 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:09:11,365 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:09:11,365 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:09:11,365 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:09:12,900 - __main__ - INFO - Test Results: Loss=1.386345, Accuracy=0.2500\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-02 23:09:12,919 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/logs/test_classification_report_20251202_230912.json\n2025-12-02 23:09:13,153 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/plots/test_confusion_matrix_20251202_230912.png\n2025-12-02 23:09:13,190 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/training_summary_20251202_230913.json\n2025-12-02 23:09:13,193 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/latest_results.txt\n2025-12-02 23:09:13,193 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:09:13,194 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_ddd63c46/training_summary_20251202_230913.json\n2025-12-02 23:09:13,194 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 301488/27408 = 11.0000 (1100.00%)\n2025-12-02 23:09:13,194 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.2500, Test Acc=0.2500\n",
      "return_code": 0
    },
    "config_normalized_stdandmean": {
      "config_name": "config_normalized_stdandmean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_stdandmean.conf",
      "start_time": 1764716959.8931587,
      "status": "success",
      "duration": 231.28220176696777,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:09:22,375 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:09:22,375 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_stdandmean.conf\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=True, quantiles=False, aggregation=stdandmean\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:09:22,378 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 23:09:22,378 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_normalized_stdandmean.conf\n2025-12-02 23:09:22,378 - __main__ - INFO - Training Configuration:\n2025-12-02 23:09:22,378 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:09:22,378 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:09:22,378 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:09:22,378 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 23:09:22,378 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:09:23,024 - __main__ - INFO - Using device: cuda\n2025-12-02 23:09:23,026 - __main__ - INFO - Using config hash: 4f9586ab\n2025-12-02 23:09:23,026 - __main__ - INFO - Using run ID: 4f9586ab\n2025-12-02 23:09:23,026 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab\n2025-12-02 23:09:23,035 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/config_4f9586ab.json\n2025-12-02 23:09:23,039 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 4\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 23:09:23,042 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 580\n2025-12-02 23:09:24,017 - __main__ - INFO - Model initialized with 580 parameters\n2025-12-02 23:09:24,105 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 23:09:24,106 - __main__ - WARNING - Could not create model summary: Expected 4 input features, got 200\n2025-12-02 23:09:24,106 - __main__ - INFO - Preparing data...\n2025-12-02 23:09:24,106 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:09:24,106 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:09:24,107 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:09:35,312 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:09:35,312 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:09:35,313 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:09:35,889 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:09:36,919 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:09:36,920 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:09:36,926 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:09:36,926 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:09:36,931 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:09:36,931 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:09:36,931 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:09:36,931 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:09:36,934 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:09:36,934 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:09:36,952 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:09:36,952 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:09:36,952 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:09:36,953 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:09:36,957 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:09:36,957 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:09:36,957 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:09:36,961 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:09:36,961 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:09:36,961 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:09:36,965 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:09:36,965 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:09:36,965 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:09:36,969 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:09:36,969 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:09:36,979 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:09:36,982 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:09:36,992 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:09:36,995 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:09:36,995 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:09:36,996 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:09:36,997 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:09:37,006 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:09:37,008 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:09:37,018 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:09:37,022 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:09:37,033 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:09:37,034 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:09:37,040 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:09:37,041 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:09:37,041 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:09:37,041 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:09:37,041 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:09:37,041 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:09:37,041 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:09:37,042 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:09:37,042 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:09:37,191 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:09:38,132 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:09:38,656 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:09:38,717 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:09:38,732 - __main__ - INFO - Loaded 67828 train patches in 1.69s\n2025-12-02 23:09:38,735 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:09:38,735 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:09:38,735 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:09:38,739 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:09:38,746 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:09:38,752 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:09:38,758 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:09:38,820 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:09:38,884 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:09:38,884 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:09:38,884 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:09:38,885 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:09:38,897 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:09:39,249 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:09:39,342 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:09:39,361 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:09:39,365 - __main__ - INFO - Loaded 22192 validation patches in 0.48s\n2025-12-02 23:09:39,366 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:09:39,366 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:09:39,366 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:09:39,367 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:09:39,370 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:09:39,372 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:09:39,374 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:09:39,392 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:09:39,407 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:09:39,407 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:09:39,407 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:09:39,408 - __main__ - INFO - Training batches: 857\n2025-12-02 23:09:39,408 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:09:39,408 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:09:39,408 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:09:45,419 - __main__ - INFO - Epoch 1/50 (6.01s): Train Loss: 1.273432, Train Acc: 0.3571, Val Loss: 1.159943, Val Acc: 0.4057\n2025-12-02 23:09:45,428 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_1.pth\n2025-12-02 23:09:45,428 - __main__ - INFO - New best validation accuracy: 0.4057\n2025-12-02 23:09:51,095 - __main__ - INFO - Epoch 2/50 (5.67s): Train Loss: 1.169769, Train Acc: 0.3973, Val Loss: 1.139767, Val Acc: 0.4101\n2025-12-02 23:09:51,104 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_2.pth\n2025-12-02 23:09:51,104 - __main__ - INFO - New best validation accuracy: 0.4101\n2025-12-02 23:09:56,766 - __main__ - INFO - Epoch 3/50 (5.66s): Train Loss: 1.164885, Train Acc: 0.4011, Val Loss: 1.136256, Val Acc: 0.4132\n2025-12-02 23:09:56,774 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_3.pth\n2025-12-02 23:09:56,775 - __main__ - INFO - New best validation accuracy: 0.4132\n2025-12-02 23:10:02,596 - __main__ - INFO - Epoch 4/50 (5.82s): Train Loss: 1.160278, Train Acc: 0.4054, Val Loss: 1.139786, Val Acc: 0.3983\n2025-12-02 23:10:09,041 - __main__ - INFO - Epoch 5/50 (6.44s): Train Loss: 1.157465, Train Acc: 0.4052, Val Loss: 1.139285, Val Acc: 0.4053\n2025-12-02 23:10:14,820 - __main__ - INFO - Epoch 6/50 (5.78s): Train Loss: 1.157601, Train Acc: 0.4063, Val Loss: 1.138436, Val Acc: 0.4125\n2025-12-02 23:10:20,770 - __main__ - INFO - Epoch 7/50 (5.95s): Train Loss: 1.158549, Train Acc: 0.4076, Val Loss: 1.137747, Val Acc: 0.4152\n2025-12-02 23:10:20,777 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_7.pth\n2025-12-02 23:10:20,777 - __main__ - INFO - New best validation accuracy: 0.4152\n2025-12-02 23:10:26,485 - __main__ - INFO - Epoch 8/50 (5.71s): Train Loss: 1.156381, Train Acc: 0.4098, Val Loss: 1.134726, Val Acc: 0.4159\n2025-12-02 23:10:26,494 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_8.pth\n2025-12-02 23:10:26,494 - __main__ - INFO - New best validation accuracy: 0.4159\n2025-12-02 23:10:32,357 - __main__ - INFO - Epoch 9/50 (5.86s): Train Loss: 1.156957, Train Acc: 0.4078, Val Loss: 1.136142, Val Acc: 0.4172\n2025-12-02 23:10:32,365 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_9.pth\n2025-12-02 23:10:32,365 - __main__ - INFO - New best validation accuracy: 0.4172\n2025-12-02 23:10:38,061 - __main__ - INFO - Epoch 10/50 (5.70s): Train Loss: 1.155886, Train Acc: 0.4102, Val Loss: 1.134966, Val Acc: 0.4120\n2025-12-02 23:10:38,070 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/checkpoint_epoch_10.pth\n2025-12-02 23:10:43,805 - __main__ - INFO - Epoch 11/50 (5.74s): Train Loss: 1.156014, Train Acc: 0.4093, Val Loss: 1.137367, Val Acc: 0.4125\n2025-12-02 23:10:49,994 - __main__ - INFO - Epoch 12/50 (6.19s): Train Loss: 1.156324, Train Acc: 0.4084, Val Loss: 1.135254, Val Acc: 0.4215\n2025-12-02 23:10:50,002 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_12.pth\n2025-12-02 23:10:50,002 - __main__ - INFO - New best validation accuracy: 0.4215\n2025-12-02 23:10:55,843 - __main__ - INFO - Epoch 13/50 (5.84s): Train Loss: 1.154381, Train Acc: 0.4149, Val Loss: 1.137573, Val Acc: 0.4151\n2025-12-02 23:11:01,571 - __main__ - INFO - Epoch 14/50 (5.73s): Train Loss: 1.155168, Train Acc: 0.4068, Val Loss: 1.140347, Val Acc: 0.4168\n2025-12-02 23:11:07,523 - __main__ - INFO - Epoch 15/50 (5.95s): Train Loss: 1.155006, Train Acc: 0.4091, Val Loss: 1.134089, Val Acc: 0.4179\n2025-12-02 23:11:13,366 - __main__ - INFO - Epoch 16/50 (5.84s): Train Loss: 1.154626, Train Acc: 0.4098, Val Loss: 1.134543, Val Acc: 0.4154\n2025-12-02 23:11:19,083 - __main__ - INFO - Epoch 17/50 (5.72s): Train Loss: 1.155130, Train Acc: 0.4107, Val Loss: 1.135186, Val Acc: 0.4200\n2025-12-02 23:11:24,716 - __main__ - INFO - Epoch 18/50 (5.63s): Train Loss: 1.155550, Train Acc: 0.4096, Val Loss: 1.133921, Val Acc: 0.4220\n2025-12-02 23:11:24,725 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_18.pth\n2025-12-02 23:11:24,725 - __main__ - INFO - New best validation accuracy: 0.4220\n2025-12-02 23:11:30,571 - __main__ - INFO - Epoch 19/50 (5.85s): Train Loss: 1.154648, Train Acc: 0.4153, Val Loss: 1.134494, Val Acc: 0.4173\n2025-12-02 23:11:36,235 - __main__ - INFO - Epoch 20/50 (5.66s): Train Loss: 1.153733, Train Acc: 0.4136, Val Loss: 1.134076, Val Acc: 0.4202\n2025-12-02 23:11:36,244 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/checkpoint_epoch_20.pth\n2025-12-02 23:11:42,383 - __main__ - INFO - Epoch 21/50 (6.14s): Train Loss: 1.154155, Train Acc: 0.4159, Val Loss: 1.134560, Val Acc: 0.4172\n2025-12-02 23:11:48,337 - __main__ - INFO - Epoch 22/50 (5.95s): Train Loss: 1.153659, Train Acc: 0.4107, Val Loss: 1.135217, Val Acc: 0.4192\n2025-12-02 23:11:54,022 - __main__ - INFO - Epoch 23/50 (5.69s): Train Loss: 1.153060, Train Acc: 0.4129, Val Loss: 1.139206, Val Acc: 0.4204\n2025-12-02 23:11:59,838 - __main__ - INFO - Epoch 24/50 (5.82s): Train Loss: 1.152308, Train Acc: 0.4158, Val Loss: 1.137062, Val Acc: 0.4210\n2025-12-02 23:12:05,495 - __main__ - INFO - Epoch 25/50 (5.66s): Train Loss: 1.152481, Train Acc: 0.4143, Val Loss: 1.133310, Val Acc: 0.4256\n2025-12-02 23:12:05,504 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/best_model_epoch_25.pth\n2025-12-02 23:12:05,504 - __main__ - INFO - New best validation accuracy: 0.4256\n2025-12-02 23:12:11,255 - __main__ - INFO - Epoch 26/50 (5.75s): Train Loss: 1.153456, Train Acc: 0.4162, Val Loss: 1.134379, Val Acc: 0.4126\n2025-12-02 23:12:17,134 - __main__ - INFO - Epoch 27/50 (5.88s): Train Loss: 1.153289, Train Acc: 0.4141, Val Loss: 1.133029, Val Acc: 0.4256\n2025-12-02 23:12:22,833 - __main__ - INFO - Epoch 28/50 (5.70s): Train Loss: 1.152181, Train Acc: 0.4162, Val Loss: 1.132965, Val Acc: 0.4244\n2025-12-02 23:12:28,769 - __main__ - INFO - Epoch 29/50 (5.94s): Train Loss: 1.151597, Train Acc: 0.4131, Val Loss: 1.132780, Val Acc: 0.4238\n2025-12-02 23:12:34,426 - __main__ - INFO - Epoch 30/50 (5.66s): Train Loss: 1.152932, Train Acc: 0.4109, Val Loss: 1.133700, Val Acc: 0.4192\n2025-12-02 23:12:34,434 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/models/checkpoint_epoch_30.pth\n2025-12-02 23:12:40,182 - __main__ - INFO - Epoch 31/50 (5.75s): Train Loss: 1.152589, Train Acc: 0.4133, Val Loss: 1.132389, Val Acc: 0.4201\n2025-12-02 23:12:46,414 - __main__ - INFO - Epoch 32/50 (6.23s): Train Loss: 1.152361, Train Acc: 0.4123, Val Loss: 1.143227, Val Acc: 0.4199\n2025-12-02 23:12:52,201 - __main__ - INFO - Epoch 33/50 (5.79s): Train Loss: 1.151330, Train Acc: 0.4114, Val Loss: 1.132933, Val Acc: 0.4241\n2025-12-02 23:12:58,034 - __main__ - INFO - Epoch 34/50 (5.83s): Train Loss: 1.152510, Train Acc: 0.4098, Val Loss: 1.133257, Val Acc: 0.4225\n2025-12-02 23:13:03,877 - __main__ - INFO - Epoch 35/50 (5.84s): Train Loss: 1.152931, Train Acc: 0.4110, Val Loss: 1.143277, Val Acc: 0.4131\n2025-12-02 23:13:03,877 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 23:13:03,877 - __main__ - INFO - Training completed in 204.47s\n2025-12-02 23:13:03,877 - __main__ - INFO - Best validation accuracy: 0.4256\n2025-12-02 23:13:04,594 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/plots/training_history_20251202_231304.png\n2025-12-02 23:13:06,169 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/logs/classification_report_20251202_231306.json\n2025-12-02 23:13:06,169 - __main__ - INFO - Classification Results:\n2025-12-02 23:13:06,169 - __main__ - INFO -   Class 1: Precision=0.538, Recall=0.265, F1=0.355\n2025-12-02 23:13:06,169 - __main__ - INFO -   Class 4: Precision=0.453, Recall=0.189, F1=0.267\n2025-12-02 23:13:06,169 - __main__ - INFO -   Class 6: Precision=0.391, Recall=0.653, F1=0.489\n2025-12-02 23:13:06,169 - __main__ - INFO -   Class 12: Precision=0.385, Recall=0.545, F1=0.451\n2025-12-02 23:13:06,385 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/plots/confusion_matrix_20251202_231306.png\n2025-12-02 23:13:06,387 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:13:06,387 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:13:06,387 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:13:06,387 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:13:06,400 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:13:06,631 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:13:07,399 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:13:07,430 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:13:07,437 - __main__ - INFO - Loaded 22857 test patches in 1.05s\n2025-12-02 23:13:07,439 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:13:07,439 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:13:07,439 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:13:07,441 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:13:07,443 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:13:07,445 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:13:07,447 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:13:07,476 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:13:07,499 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:13:07,499 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:13:07,499 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:13:09,064 - __main__ - INFO - Test Results: Loss=1.148113, Accuracy=0.4116\n2025-12-02 23:13:09,084 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/logs/test_classification_report_20251202_231309.json\n2025-12-02 23:13:09,311 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/plots/test_confusion_matrix_20251202_231309.png\n2025-12-02 23:13:09,345 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/training_summary_20251202_231309.json\n2025-12-02 23:13:09,348 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/latest_results.txt\n2025-12-02 23:13:09,348 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:13:09,348 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_4f9586ab/training_summary_20251202_231309.json\n2025-12-02 23:13:09,348 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 959280/27408 = 35.0000 (3500.00%)\n2025-12-02 23:13:09,348 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4256, Test Acc=0.4116\n",
      "return_code": 0
    },
    "config_zeromean": {
      "config_name": "config_zeromean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean.conf",
      "start_time": 1764717196.185196,
      "status": "success",
      "duration": 83.28181266784668,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:13:18,490 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:13:18,491 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean.conf\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=False, quantiles=False, aggregation=None\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:13:18,493 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 23:13:18,493 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean.conf\n2025-12-02 23:13:18,493 - __main__ - INFO - Training Configuration:\n2025-12-02 23:13:18,493 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:13:18,493 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:13:18,493 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:13:18,493 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 23:13:18,493 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:13:18,989 - __main__ - INFO - Using device: cuda\n2025-12-02 23:13:18,992 - __main__ - INFO - Using config hash: fdcd1b4f\n2025-12-02 23:13:18,992 - __main__ - INFO - Using run ID: fdcd1b4f\n2025-12-02 23:13:18,992 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f\n2025-12-02 23:13:19,000 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/config_fdcd1b4f.json\n2025-12-02 23:13:19,005 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 23:13:19,008 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 23:13:19,988 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 23:13:20,195 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 23:13:20,204 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 23:13:20,204 - __main__ - INFO - Preparing data...\n2025-12-02 23:13:20,204 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:13:20,204 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:13:20,205 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:13:31,577 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:13:31,578 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:13:31,579 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:13:32,231 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:13:33,777 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:13:33,778 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:13:33,785 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:13:33,785 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:13:33,789 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:13:33,789 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:13:33,789 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:13:33,789 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:13:33,793 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:13:33,793 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:13:33,812 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:13:33,812 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:13:33,812 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:13:33,813 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:13:33,818 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:13:33,818 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:13:33,819 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:13:33,823 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:13:33,823 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:13:33,823 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:13:33,827 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:13:33,827 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:13:33,827 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:13:33,831 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:13:33,831 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:13:33,843 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:13:33,845 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:13:33,857 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:13:33,861 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:13:33,861 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:13:33,862 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:13:33,863 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:13:33,872 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:13:33,875 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:13:33,886 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:13:33,890 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:13:33,902 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:13:33,903 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:13:33,911 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:13:33,912 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:13:33,912 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:13:33,912 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:13:33,912 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:13:33,912 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:13:33,912 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:13:33,912 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:13:33,913 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:13:34,150 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:13:35,390 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:13:36,150 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:13:36,236 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:13:36,261 - __main__ - INFO - Loaded 67828 train patches in 2.35s\n2025-12-02 23:13:36,264 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:13:36,264 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:13:36,264 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:13:36,268 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:13:36,276 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:13:36,283 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:13:36,290 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:13:36,396 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:13:36,489 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:13:36,489 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:13:36,489 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:13:36,489 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:13:36,505 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:13:37,008 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:13:37,123 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:13:37,150 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:13:37,157 - __main__ - INFO - Loaded 22192 validation patches in 0.67s\n2025-12-02 23:13:37,158 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:13:37,158 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:13:37,158 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:13:37,159 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:13:37,162 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:13:37,164 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:13:37,166 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:13:37,195 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:13:37,217 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:13:37,217 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:13:37,217 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:13:37,217 - __main__ - INFO - Training batches: 857\n2025-12-02 23:13:37,217 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:13:37,217 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:13:37,217 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:13:40,730 - __main__ - INFO - Epoch 1/50 (3.51s): Train Loss: 1.068190, Train Acc: 0.5390, Val Loss: 0.968807, Val Acc: 0.5831\n2025-12-02 23:13:40,744 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/models/best_model_epoch_1.pth\n2025-12-02 23:13:40,744 - __main__ - INFO - New best validation accuracy: 0.5831\n2025-12-02 23:13:43,887 - __main__ - INFO - Epoch 2/50 (3.14s): Train Loss: 1.000402, Train Acc: 0.5702, Val Loss: 0.922021, Val Acc: 0.6148\n2025-12-02 23:13:43,899 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/models/best_model_epoch_2.pth\n2025-12-02 23:13:43,899 - __main__ - INFO - New best validation accuracy: 0.6148\n2025-12-02 23:13:47,179 - __main__ - INFO - Epoch 3/50 (3.28s): Train Loss: 0.988107, Train Acc: 0.5805, Val Loss: 0.954856, Val Acc: 0.5966\n2025-12-02 23:13:50,141 - __main__ - INFO - Epoch 4/50 (2.96s): Train Loss: 0.982897, Train Acc: 0.5814, Val Loss: 0.956088, Val Acc: 0.5904\n2025-12-02 23:13:53,354 - __main__ - INFO - Epoch 5/50 (3.21s): Train Loss: 0.982409, Train Acc: 0.5793, Val Loss: 0.945672, Val Acc: 0.6000\n2025-12-02 23:13:56,445 - __main__ - INFO - Epoch 6/50 (3.09s): Train Loss: 0.976102, Train Acc: 0.5852, Val Loss: 0.921872, Val Acc: 0.6128\n2025-12-02 23:13:59,629 - __main__ - INFO - Epoch 7/50 (3.18s): Train Loss: 0.970128, Train Acc: 0.5884, Val Loss: 0.905386, Val Acc: 0.6203\n2025-12-02 23:13:59,641 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/models/best_model_epoch_7.pth\n2025-12-02 23:13:59,641 - __main__ - INFO - New best validation accuracy: 0.6203\n2025-12-02 23:14:02,780 - __main__ - INFO - Epoch 8/50 (3.14s): Train Loss: 0.975824, Train Acc: 0.5864, Val Loss: 0.907070, Val Acc: 0.6248\n2025-12-02 23:14:02,792 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/models/best_model_epoch_8.pth\n2025-12-02 23:14:02,792 - __main__ - INFO - New best validation accuracy: 0.6248\n2025-12-02 23:14:05,871 - __main__ - INFO - Epoch 9/50 (3.08s): Train Loss: 0.970174, Train Acc: 0.5882, Val Loss: 0.900750, Val Acc: 0.6230\n2025-12-02 23:14:09,059 - __main__ - INFO - Epoch 10/50 (3.19s): Train Loss: 0.972637, Train Acc: 0.5879, Val Loss: 0.904543, Val Acc: 0.6234\n2025-12-02 23:14:09,071 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/models/checkpoint_epoch_10.pth\n2025-12-02 23:14:12,169 - __main__ - INFO - Epoch 11/50 (3.10s): Train Loss: 0.968210, Train Acc: 0.5914, Val Loss: 0.903188, Val Acc: 0.6228\n2025-12-02 23:14:15,417 - __main__ - INFO - Epoch 12/50 (3.25s): Train Loss: 0.965209, Train Acc: 0.5917, Val Loss: 0.927852, Val Acc: 0.6077\n2025-12-02 23:14:18,748 - __main__ - INFO - Epoch 13/50 (3.33s): Train Loss: 0.969222, Train Acc: 0.5899, Val Loss: 0.903700, Val Acc: 0.6235\n2025-12-02 23:14:21,957 - __main__ - INFO - Epoch 14/50 (3.21s): Train Loss: 0.964227, Train Acc: 0.5949, Val Loss: 0.908505, Val Acc: 0.6200\n2025-12-02 23:14:24,848 - __main__ - INFO - Epoch 15/50 (2.89s): Train Loss: 0.967150, Train Acc: 0.5924, Val Loss: 0.903226, Val Acc: 0.6224\n2025-12-02 23:14:28,078 - __main__ - INFO - Epoch 16/50 (3.23s): Train Loss: 0.964949, Train Acc: 0.5894, Val Loss: 0.972407, Val Acc: 0.5817\n2025-12-02 23:14:31,284 - __main__ - INFO - Epoch 17/50 (3.21s): Train Loss: 0.962158, Train Acc: 0.5902, Val Loss: 0.905353, Val Acc: 0.6245\n2025-12-02 23:14:34,432 - __main__ - INFO - Epoch 18/50 (3.15s): Train Loss: 0.964039, Train Acc: 0.5938, Val Loss: 0.928941, Val Acc: 0.6079\n2025-12-02 23:14:34,432 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 23:14:34,432 - __main__ - INFO - Training completed in 57.22s\n2025-12-02 23:14:34,432 - __main__ - INFO - Best validation accuracy: 0.6248\n2025-12-02 23:14:35,131 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/plots/training_history_20251202_231434.png\n2025-12-02 23:14:35,981 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/logs/classification_report_20251202_231435.json\n2025-12-02 23:14:35,982 - __main__ - INFO - Classification Results:\n2025-12-02 23:14:35,982 - __main__ - INFO -   Class 1: Precision=0.540, Recall=0.383, F1=0.448\n2025-12-02 23:14:35,982 - __main__ - INFO -   Class 4: Precision=0.743, Recall=0.702, F1=0.722\n2025-12-02 23:14:35,982 - __main__ - INFO -   Class 6: Precision=0.540, Recall=0.906, F1=0.677\n2025-12-02 23:14:35,982 - __main__ - INFO -   Class 12: Precision=0.660, Recall=0.441, F1=0.528\n2025-12-02 23:14:36,190 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/plots/confusion_matrix_20251202_231435.png\n2025-12-02 23:14:36,191 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:14:36,191 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:14:36,192 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:14:36,192 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:14:36,206 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:14:36,759 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:14:36,874 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:14:36,906 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:14:36,912 - __main__ - INFO - Loaded 22857 test patches in 0.72s\n2025-12-02 23:14:36,914 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:14:36,914 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:14:36,914 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:14:36,916 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:14:36,918 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:14:36,920 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:14:36,922 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:14:36,950 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:14:36,970 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:14:36,970 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:14:36,971 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:14:37,791 - __main__ - INFO - Test Results: Loss=0.924259, Accuracy=0.6127\n2025-12-02 23:14:37,810 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/logs/test_classification_report_20251202_231437.json\n2025-12-02 23:14:38,042 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/plots/test_confusion_matrix_20251202_231437.png\n2025-12-02 23:14:38,074 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/training_summary_20251202_231438.json\n2025-12-02 23:14:38,077 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/latest_results.txt\n2025-12-02 23:14:38,077 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:14:38,077 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_fdcd1b4f/training_summary_20251202_231438.json\n2025-12-02 23:14:38,077 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 493344/27408 = 18.0000 (1800.00%)\n2025-12-02 23:14:38,078 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.6248, Test Acc=0.6127\n",
      "return_code": 0
    },
    "config_zeromean_mean": {
      "config_name": "config_zeromean_mean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_mean.conf",
      "start_time": 1764717284.476832,
      "status": "success",
      "duration": 59.73247003555298,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:14:46,978 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:14:46,978 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_mean.conf\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=False, quantiles=False, aggregation=mean\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:14:46,980 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:14:46,981 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 23:14:46,981 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_mean.conf\n2025-12-02 23:14:46,981 - __main__ - INFO - Training Configuration:\n2025-12-02 23:14:46,981 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:14:46,981 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:14:46,981 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:14:46,981 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 23:14:46,981 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:14:47,634 - __main__ - INFO - Using device: cuda\n2025-12-02 23:14:47,636 - __main__ - INFO - Using config hash: b330c88b\n2025-12-02 23:14:47,636 - __main__ - INFO - Using run ID: b330c88b\n2025-12-02 23:14:47,636 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b\n2025-12-02 23:14:47,645 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/config_b330c88b.json\n2025-12-02 23:14:47,649 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 23:14:47,651 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-02 23:14:48,826 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-02 23:14:48,916 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 23:14:48,917 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-02 23:14:48,917 - __main__ - INFO - Preparing data...\n2025-12-02 23:14:48,917 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:14:48,917 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:14:48,918 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:15:00,530 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:15:00,530 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:15:00,531 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:15:01,189 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:15:02,228 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:15:02,228 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:15:02,234 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:15:02,235 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:15:02,239 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:15:02,239 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:15:02,239 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:15:02,239 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:15:02,241 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:15:02,241 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:15:02,258 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:15:02,258 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:15:02,259 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:15:02,259 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:15:02,263 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:15:02,263 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:15:02,263 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:15:02,267 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:15:02,267 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:15:02,267 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:15:02,271 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:15:02,271 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:15:02,271 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:15:02,274 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:15:02,274 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:15:02,284 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:15:02,287 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:15:02,297 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:15:02,301 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:15:02,301 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:15:02,302 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:15:02,302 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:15:02,312 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:15:02,314 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:15:02,324 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:15:02,328 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:15:02,339 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:15:02,340 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:15:02,347 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:15:02,348 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:15:02,348 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:15:02,499 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:15:03,445 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:15:03,980 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:15:04,041 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:15:04,056 - __main__ - INFO - Loaded 67828 train patches in 1.71s\n2025-12-02 23:15:04,059 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:15:04,059 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:15:04,059 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:15:04,063 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:15:04,070 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:15:04,076 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:15:04,082 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:15:04,149 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:15:04,220 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:15:04,220 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:15:04,220 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:15:04,220 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:15:04,233 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:15:04,592 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:15:04,686 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:15:04,704 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:15:04,709 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-02 23:15:04,710 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:15:04,710 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:15:04,710 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:15:04,711 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:15:04,713 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:15:04,715 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:15:04,717 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:15:04,736 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:15:04,753 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:15:04,753 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:15:04,753 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:15:04,753 - __main__ - INFO - Training batches: 857\n2025-12-02 23:15:04,753 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:15:04,753 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:15:04,753 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:15:07,973 - __main__ - INFO - Epoch 1/50 (3.22s): Train Loss: 1.386452, Train Acc: 0.2450, Val Loss: 1.386302, Val Acc: 0.2500\n2025-12-02 23:15:07,983 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/models/best_model_epoch_1.pth\n2025-12-02 23:15:07,983 - __main__ - INFO - New best validation accuracy: 0.2500\n2025-12-02 23:15:11,029 - __main__ - INFO - Epoch 2/50 (3.05s): Train Loss: 1.386431, Train Acc: 0.2447, Val Loss: 1.386308, Val Acc: 0.2500\n2025-12-02 23:15:13,999 - __main__ - INFO - Epoch 3/50 (2.97s): Train Loss: 1.386366, Train Acc: 0.2517, Val Loss: 1.386331, Val Acc: 0.2500\n2025-12-02 23:15:17,112 - __main__ - INFO - Epoch 4/50 (3.11s): Train Loss: 1.386438, Train Acc: 0.2462, Val Loss: 1.386296, Val Acc: 0.2500\n2025-12-02 23:15:20,232 - __main__ - INFO - Epoch 5/50 (3.12s): Train Loss: 1.386426, Train Acc: 0.2462, Val Loss: 1.386297, Val Acc: 0.2500\n2025-12-02 23:15:23,453 - __main__ - INFO - Epoch 6/50 (3.22s): Train Loss: 1.386404, Train Acc: 0.2475, Val Loss: 1.386297, Val Acc: 0.2500\n2025-12-02 23:15:26,518 - __main__ - INFO - Epoch 7/50 (3.07s): Train Loss: 1.386366, Train Acc: 0.2516, Val Loss: 1.386380, Val Acc: 0.2500\n2025-12-02 23:15:29,604 - __main__ - INFO - Epoch 8/50 (3.08s): Train Loss: 1.386444, Train Acc: 0.2431, Val Loss: 1.386312, Val Acc: 0.2500\n2025-12-02 23:15:32,638 - __main__ - INFO - Epoch 9/50 (3.03s): Train Loss: 1.386395, Train Acc: 0.2478, Val Loss: 1.386321, Val Acc: 0.2500\n2025-12-02 23:15:35,593 - __main__ - INFO - Epoch 10/50 (2.95s): Train Loss: 1.386379, Train Acc: 0.2493, Val Loss: 1.386308, Val Acc: 0.2500\n2025-12-02 23:15:35,601 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/models/checkpoint_epoch_10.pth\n2025-12-02 23:15:38,666 - __main__ - INFO - Epoch 11/50 (3.06s): Train Loss: 1.386388, Train Acc: 0.2493, Val Loss: 1.386363, Val Acc: 0.2500\n2025-12-02 23:15:38,667 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 23:15:38,667 - __main__ - INFO - Training completed in 33.91s\n2025-12-02 23:15:38,667 - __main__ - INFO - Best validation accuracy: 0.2500\n2025-12-02 23:15:39,359 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/plots/training_history_20251202_231538.png\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-02 23:15:40,184 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/logs/classification_report_20251202_231540.json\n2025-12-02 23:15:40,184 - __main__ - INFO - Classification Results:\n2025-12-02 23:15:40,184 - __main__ - INFO -   Class 1: Precision=0.250, Recall=1.000, F1=0.400\n2025-12-02 23:15:40,184 - __main__ - INFO -   Class 4: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:15:40,184 - __main__ - INFO -   Class 6: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:15:40,184 - __main__ - INFO -   Class 12: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:15:40,422 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/plots/confusion_matrix_20251202_231540.png\n2025-12-02 23:15:40,424 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:15:40,424 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:15:40,424 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:15:40,424 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:15:40,795 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:15:41,039 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:15:41,572 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:15:41,602 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:15:41,609 - __main__ - INFO - Loaded 22857 test patches in 1.19s\n2025-12-02 23:15:41,611 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:15:41,611 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:15:41,611 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:15:41,613 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:15:41,615 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:15:41,618 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:15:41,620 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:15:41,651 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:15:41,674 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:15:41,675 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:15:41,675 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:15:42,546 - __main__ - INFO - Test Results: Loss=1.386368, Accuracy=0.2500\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-02 23:15:42,569 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/logs/test_classification_report_20251202_231542.json\n2025-12-02 23:15:42,784 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/plots/test_confusion_matrix_20251202_231542.png\n2025-12-02 23:15:42,813 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/training_summary_20251202_231542.json\n2025-12-02 23:15:42,816 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/latest_results.txt\n2025-12-02 23:15:42,816 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:15:42,816 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b330c88b/training_summary_20251202_231542.json\n2025-12-02 23:15:42,816 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 301488/27408 = 11.0000 (1100.00%)\n2025-12-02 23:15:42,816 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.2500, Test Acc=0.2500\n",
      "return_code": 0
    },
    "config_zeromean_normalized": {
      "config_name": "config_zeromean_normalized",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized.conf",
      "start_time": 1764717349.2189012,
      "status": "success",
      "duration": 194.22323536872864,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:15:51,712 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:15:51,712 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized.conf\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=True, quantiles=False, aggregation=None\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:15:51,714 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 23:15:51,714 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized.conf\n2025-12-02 23:15:51,714 - __main__ - INFO - Training Configuration:\n2025-12-02 23:15:51,714 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:15:51,714 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:15:51,714 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:15:51,714 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 23:15:51,714 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:15:52,361 - __main__ - INFO - Using device: cuda\n2025-12-02 23:15:52,363 - __main__ - INFO - Using config hash: 3e2e78db\n2025-12-02 23:15:52,363 - __main__ - INFO - Using run ID: 3e2e78db\n2025-12-02 23:15:52,363 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db\n2025-12-02 23:15:52,372 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/config_3e2e78db.json\n2025-12-02 23:15:52,376 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 23:15:52,379 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 23:15:53,546 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 23:15:53,757 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 23:15:53,767 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 23:15:53,767 - __main__ - INFO - Preparing data...\n2025-12-02 23:15:53,768 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:15:53,768 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:15:53,768 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:16:05,299 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:16:05,300 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:16:05,301 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:16:05,952 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:16:07,487 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:16:07,487 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:16:07,494 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:16:07,494 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:16:07,499 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:16:07,499 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:16:07,499 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:16:07,499 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:16:07,502 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:16:07,502 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:16:07,519 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:16:07,519 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:16:07,520 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:16:07,521 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:16:07,526 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:16:07,526 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:16:07,526 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:16:07,529 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:16:07,530 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:16:07,530 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:16:07,533 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:16:07,533 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:16:07,533 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:16:07,537 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:16:07,537 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:16:07,548 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:16:07,551 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:16:07,563 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:16:07,566 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:16:07,566 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:16:07,567 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:16:07,568 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:16:07,578 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:16:07,580 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:16:07,591 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:16:07,595 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:16:07,607 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:16:07,608 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:16:07,616 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:16:07,616 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:16:07,616 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:16:07,617 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:16:07,617 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:16:07,617 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:16:07,617 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:16:07,617 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:16:07,617 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:16:07,849 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:16:09,101 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:16:09,865 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:16:09,950 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:16:09,975 - __main__ - INFO - Loaded 67828 train patches in 2.36s\n2025-12-02 23:16:09,978 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:16:09,978 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:16:09,978 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:16:09,982 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:16:09,990 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:16:09,997 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:16:10,004 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:16:10,105 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:16:10,200 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:16:10,200 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:16:10,200 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:16:10,200 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:16:10,215 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:16:10,728 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:16:10,846 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:16:10,871 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:16:10,877 - __main__ - INFO - Loaded 22192 validation patches in 0.68s\n2025-12-02 23:16:10,878 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:16:10,879 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:16:10,879 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:16:10,880 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:16:10,883 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:16:10,885 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:16:10,887 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:16:10,915 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:16:10,937 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:16:10,937 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:16:10,937 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:16:10,938 - __main__ - INFO - Training batches: 857\n2025-12-02 23:16:10,938 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:16:10,938 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:16:10,938 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:16:17,559 - __main__ - INFO - Epoch 1/50 (6.62s): Train Loss: 1.149681, Train Acc: 0.4656, Val Loss: 1.070936, Val Acc: 0.5183\n2025-12-02 23:16:17,572 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_1.pth\n2025-12-02 23:16:17,572 - __main__ - INFO - New best validation accuracy: 0.5183\n2025-12-02 23:16:23,845 - __main__ - INFO - Epoch 2/50 (6.27s): Train Loss: 1.078352, Train Acc: 0.5142, Val Loss: 1.048623, Val Acc: 0.5145\n2025-12-02 23:16:30,122 - __main__ - INFO - Epoch 3/50 (6.28s): Train Loss: 1.066567, Train Acc: 0.5229, Val Loss: 1.031722, Val Acc: 0.5418\n2025-12-02 23:16:30,135 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_3.pth\n2025-12-02 23:16:30,135 - __main__ - INFO - New best validation accuracy: 0.5418\n2025-12-02 23:16:36,394 - __main__ - INFO - Epoch 4/50 (6.26s): Train Loss: 1.063818, Train Acc: 0.5273, Val Loss: 1.031090, Val Acc: 0.5498\n2025-12-02 23:16:36,403 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_4.pth\n2025-12-02 23:16:36,403 - __main__ - INFO - New best validation accuracy: 0.5498\n2025-12-02 23:16:42,587 - __main__ - INFO - Epoch 5/50 (6.18s): Train Loss: 1.058818, Train Acc: 0.5293, Val Loss: 1.026148, Val Acc: 0.5399\n2025-12-02 23:16:48,820 - __main__ - INFO - Epoch 6/50 (6.23s): Train Loss: 1.053104, Train Acc: 0.5328, Val Loss: 1.017236, Val Acc: 0.5567\n2025-12-02 23:16:48,833 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_6.pth\n2025-12-02 23:16:48,833 - __main__ - INFO - New best validation accuracy: 0.5567\n2025-12-02 23:16:54,842 - __main__ - INFO - Epoch 7/50 (6.01s): Train Loss: 1.047994, Train Acc: 0.5377, Val Loss: 1.007568, Val Acc: 0.5699\n2025-12-02 23:16:54,854 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_7.pth\n2025-12-02 23:16:54,854 - __main__ - INFO - New best validation accuracy: 0.5699\n2025-12-02 23:17:00,956 - __main__ - INFO - Epoch 8/50 (6.10s): Train Loss: 1.046681, Train Acc: 0.5371, Val Loss: 1.023583, Val Acc: 0.5397\n2025-12-02 23:17:07,028 - __main__ - INFO - Epoch 9/50 (6.07s): Train Loss: 1.045090, Train Acc: 0.5379, Val Loss: 1.007096, Val Acc: 0.5710\n2025-12-02 23:17:07,040 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_9.pth\n2025-12-02 23:17:07,040 - __main__ - INFO - New best validation accuracy: 0.5710\n2025-12-02 23:17:13,200 - __main__ - INFO - Epoch 10/50 (6.16s): Train Loss: 1.044113, Train Acc: 0.5381, Val Loss: 1.007300, Val Acc: 0.5647\n2025-12-02 23:17:13,213 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/checkpoint_epoch_10.pth\n2025-12-02 23:17:19,422 - __main__ - INFO - Epoch 11/50 (6.21s): Train Loss: 1.041243, Train Acc: 0.5392, Val Loss: 1.000646, Val Acc: 0.5710\n2025-12-02 23:17:25,530 - __main__ - INFO - Epoch 12/50 (6.11s): Train Loss: 1.039530, Train Acc: 0.5425, Val Loss: 1.013897, Val Acc: 0.5534\n2025-12-02 23:17:31,654 - __main__ - INFO - Epoch 13/50 (6.12s): Train Loss: 1.034580, Train Acc: 0.5420, Val Loss: 1.003919, Val Acc: 0.5663\n2025-12-02 23:17:37,814 - __main__ - INFO - Epoch 14/50 (6.16s): Train Loss: 1.035947, Train Acc: 0.5460, Val Loss: 1.013764, Val Acc: 0.5490\n2025-12-02 23:17:43,826 - __main__ - INFO - Epoch 15/50 (6.01s): Train Loss: 1.032117, Train Acc: 0.5488, Val Loss: 0.999032, Val Acc: 0.5625\n2025-12-02 23:17:49,866 - __main__ - INFO - Epoch 16/50 (6.04s): Train Loss: 1.031107, Train Acc: 0.5457, Val Loss: 1.040176, Val Acc: 0.5455\n2025-12-02 23:17:55,915 - __main__ - INFO - Epoch 17/50 (6.05s): Train Loss: 1.030370, Train Acc: 0.5479, Val Loss: 0.997431, Val Acc: 0.5744\n2025-12-02 23:17:55,928 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/best_model_epoch_17.pth\n2025-12-02 23:17:55,928 - __main__ - INFO - New best validation accuracy: 0.5744\n2025-12-02 23:18:02,092 - __main__ - INFO - Epoch 18/50 (6.16s): Train Loss: 1.028367, Train Acc: 0.5459, Val Loss: 1.004186, Val Acc: 0.5659\n2025-12-02 23:18:08,097 - __main__ - INFO - Epoch 19/50 (6.00s): Train Loss: 1.029029, Train Acc: 0.5501, Val Loss: 0.996017, Val Acc: 0.5709\n2025-12-02 23:18:14,298 - __main__ - INFO - Epoch 20/50 (6.20s): Train Loss: 1.030582, Train Acc: 0.5502, Val Loss: 1.016968, Val Acc: 0.5597\n2025-12-02 23:18:14,310 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/models/checkpoint_epoch_20.pth\n2025-12-02 23:18:20,615 - __main__ - INFO - Epoch 21/50 (6.31s): Train Loss: 1.028222, Train Acc: 0.5461, Val Loss: 0.995841, Val Acc: 0.5658\n2025-12-02 23:18:26,744 - __main__ - INFO - Epoch 22/50 (6.13s): Train Loss: 1.026975, Train Acc: 0.5507, Val Loss: 0.996039, Val Acc: 0.5715\n2025-12-02 23:18:32,835 - __main__ - INFO - Epoch 23/50 (6.09s): Train Loss: 1.026505, Train Acc: 0.5485, Val Loss: 1.032305, Val Acc: 0.5497\n2025-12-02 23:18:38,947 - __main__ - INFO - Epoch 24/50 (6.11s): Train Loss: 1.028416, Train Acc: 0.5476, Val Loss: 0.989193, Val Acc: 0.5744\n2025-12-02 23:18:45,002 - __main__ - INFO - Epoch 25/50 (6.05s): Train Loss: 1.024696, Train Acc: 0.5491, Val Loss: 1.011090, Val Acc: 0.5637\n2025-12-02 23:18:50,980 - __main__ - INFO - Epoch 26/50 (5.98s): Train Loss: 1.024557, Train Acc: 0.5495, Val Loss: 1.019141, Val Acc: 0.5547\n2025-12-02 23:18:57,001 - __main__ - INFO - Epoch 27/50 (6.02s): Train Loss: 1.025642, Train Acc: 0.5474, Val Loss: 1.012808, Val Acc: 0.5581\n2025-12-02 23:18:57,001 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 23:18:57,001 - __main__ - INFO - Training completed in 166.06s\n2025-12-02 23:18:57,001 - __main__ - INFO - Best validation accuracy: 0.5744\n2025-12-02 23:18:57,691 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/plots/training_history_20251202_231857.png\n2025-12-02 23:18:59,434 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/logs/classification_report_20251202_231859.json\n2025-12-02 23:18:59,434 - __main__ - INFO - Classification Results:\n2025-12-02 23:18:59,434 - __main__ - INFO -   Class 1: Precision=0.506, Recall=0.448, F1=0.475\n2025-12-02 23:18:59,434 - __main__ - INFO -   Class 4: Precision=0.732, Recall=0.545, F1=0.625\n2025-12-02 23:18:59,434 - __main__ - INFO -   Class 6: Precision=0.485, Recall=0.882, F1=0.626\n2025-12-02 23:18:59,434 - __main__ - INFO -   Class 12: Precision=0.650, Recall=0.357, F1=0.461\n2025-12-02 23:18:59,638 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/plots/confusion_matrix_20251202_231859.png\n2025-12-02 23:18:59,639 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:18:59,639 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:18:59,639 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:18:59,639 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:18:59,652 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:19:00,060 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:19:00,157 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:19:00,181 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:19:00,185 - __main__ - INFO - Loaded 22857 test patches in 0.55s\n2025-12-02 23:19:00,187 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:19:00,187 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:19:00,187 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:19:00,188 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:19:00,191 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:19:00,192 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:19:00,194 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:19:00,213 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:19:00,227 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:19:00,227 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:19:00,227 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:19:01,879 - __main__ - INFO - Test Results: Loss=1.003710, Accuracy=0.5605\n2025-12-02 23:19:01,905 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/logs/test_classification_report_20251202_231901.json\n2025-12-02 23:19:02,107 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/plots/test_confusion_matrix_20251202_231901.png\n2025-12-02 23:19:02,130 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/training_summary_20251202_231902.json\n2025-12-02 23:19:02,133 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/latest_results.txt\n2025-12-02 23:19:02,133 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:19:02,134 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_3e2e78db/training_summary_20251202_231902.json\n2025-12-02 23:19:02,134 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 740016/27408 = 27.0000 (2700.00%)\n2025-12-02 23:19:02,134 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.5744, Test Acc=0.5605\n",
      "return_code": 0
    },
    "config_zeromean_normalized_mean": {
      "config_name": "config_zeromean_normalized_mean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_mean.conf",
      "start_time": 1764717548.4520812,
      "status": "success",
      "duration": 101.11091876029968,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:19:10,755 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:19:10,755 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_mean.conf\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=True, quantiles=False, aggregation=mean\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:19:10,758 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-02 23:19:10,758 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_mean.conf\n2025-12-02 23:19:10,758 - __main__ - INFO - Training Configuration:\n2025-12-02 23:19:10,758 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:19:10,758 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:19:10,758 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:19:10,758 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-02 23:19:10,758 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:19:11,256 - __main__ - INFO - Using device: cuda\n2025-12-02 23:19:11,258 - __main__ - INFO - Using config hash: b0f16eb2\n2025-12-02 23:19:11,258 - __main__ - INFO - Using run ID: b0f16eb2\n2025-12-02 23:19:11,258 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2\n2025-12-02 23:19:11,268 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/config_b0f16eb2.json\n2025-12-02 23:19:11,273 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-02 23:19:11,275 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-02 23:19:12,453 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-02 23:19:12,541 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-02 23:19:12,542 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-02 23:19:12,542 - __main__ - INFO - Preparing data...\n2025-12-02 23:19:12,542 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:19:12,542 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:19:12,542 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:19:24,083 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:19:24,084 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:19:24,085 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:19:24,743 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:19:26,336 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:19:26,337 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:19:26,344 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:19:26,344 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:19:26,348 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:19:26,348 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:19:26,348 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:19:26,348 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:19:26,352 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:19:26,353 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:19:26,372 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:19:26,372 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:19:26,373 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:19:26,373 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:19:26,379 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:19:26,379 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:19:26,379 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:19:26,383 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:19:26,383 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:19:26,383 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:19:26,387 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:19:26,387 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:19:26,388 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:19:26,392 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:19:26,392 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:19:26,404 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:19:26,406 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:19:26,418 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:19:26,422 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:19:26,422 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:19:26,423 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:19:26,424 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:19:26,433 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:19:26,436 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:19:26,447 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:19:26,451 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:19:26,463 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:19:26,464 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:19:26,472 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:19:26,472 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:19:26,473 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:19:26,473 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:19:26,473 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:19:26,473 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:19:26,473 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:19:26,473 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:19:26,473 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:19:26,709 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:19:27,961 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:19:28,732 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:19:28,820 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:19:28,845 - __main__ - INFO - Loaded 67828 train patches in 2.37s\n2025-12-02 23:19:28,848 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:19:28,848 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:19:28,848 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:19:28,852 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:19:28,860 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:19:28,867 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:19:28,873 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:19:28,974 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:19:29,069 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:19:29,070 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:19:29,070 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:19:29,070 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:19:29,085 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:19:29,595 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:19:29,710 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:19:29,737 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:19:29,743 - __main__ - INFO - Loaded 22192 validation patches in 0.67s\n2025-12-02 23:19:29,745 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:19:29,745 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:19:29,745 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:19:29,746 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:19:29,749 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:19:29,751 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:19:29,753 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:19:29,782 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:19:29,804 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:19:29,804 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:19:29,804 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:19:29,805 - __main__ - INFO - Training batches: 857\n2025-12-02 23:19:29,805 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:19:29,805 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:19:29,805 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:19:36,553 - __main__ - INFO - Epoch 1/50 (6.75s): Train Loss: 1.386437, Train Acc: 0.2474, Val Loss: 1.386302, Val Acc: 0.2500\n2025-12-02 23:19:36,563 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/models/best_model_epoch_1.pth\n2025-12-02 23:19:36,564 - __main__ - INFO - New best validation accuracy: 0.2500\n2025-12-02 23:19:43,187 - __main__ - INFO - Epoch 2/50 (6.62s): Train Loss: 1.386399, Train Acc: 0.2479, Val Loss: 1.386330, Val Acc: 0.2500\n2025-12-02 23:19:49,605 - __main__ - INFO - Epoch 3/50 (6.42s): Train Loss: 1.386401, Train Acc: 0.2491, Val Loss: 1.386322, Val Acc: 0.2500\n2025-12-02 23:19:55,993 - __main__ - INFO - Epoch 4/50 (6.39s): Train Loss: 1.386401, Train Acc: 0.2505, Val Loss: 1.386305, Val Acc: 0.2500\n2025-12-02 23:20:02,608 - __main__ - INFO - Epoch 5/50 (6.62s): Train Loss: 1.386435, Train Acc: 0.2458, Val Loss: 1.386302, Val Acc: 0.2500\n2025-12-02 23:20:09,246 - __main__ - INFO - Epoch 6/50 (6.64s): Train Loss: 1.386415, Train Acc: 0.2472, Val Loss: 1.386322, Val Acc: 0.2500\n2025-12-02 23:20:15,603 - __main__ - INFO - Epoch 7/50 (6.36s): Train Loss: 1.386400, Train Acc: 0.2480, Val Loss: 1.386305, Val Acc: 0.2500\n2025-12-02 23:20:22,056 - __main__ - INFO - Epoch 8/50 (6.45s): Train Loss: 1.386405, Train Acc: 0.2484, Val Loss: 1.386305, Val Acc: 0.2500\n2025-12-02 23:20:28,827 - __main__ - INFO - Epoch 9/50 (6.77s): Train Loss: 1.386388, Train Acc: 0.2511, Val Loss: 1.386357, Val Acc: 0.2500\n2025-12-02 23:20:35,434 - __main__ - INFO - Epoch 10/50 (6.61s): Train Loss: 1.386431, Train Acc: 0.2453, Val Loss: 1.386351, Val Acc: 0.2500\n2025-12-02 23:20:35,444 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/models/checkpoint_epoch_10.pth\n2025-12-02 23:20:41,830 - __main__ - INFO - Epoch 11/50 (6.39s): Train Loss: 1.386407, Train Acc: 0.2493, Val Loss: 1.386302, Val Acc: 0.2500\n2025-12-02 23:20:41,831 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 23:20:41,831 - __main__ - INFO - Training completed in 72.03s\n2025-12-02 23:20:41,831 - __main__ - INFO - Best validation accuracy: 0.2500\n2025-12-02 23:20:42,536 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/plots/training_history_20251202_232041.png\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-02 23:20:44,306 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/logs/classification_report_20251202_232044.json\n2025-12-02 23:20:44,306 - __main__ - INFO - Classification Results:\n2025-12-02 23:20:44,306 - __main__ - INFO -   Class 1: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:20:44,306 - __main__ - INFO -   Class 4: Precision=0.250, Recall=1.000, F1=0.400\n2025-12-02 23:20:44,307 - __main__ - INFO -   Class 6: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:20:44,307 - __main__ - INFO -   Class 12: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-02 23:20:44,885 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/plots/confusion_matrix_20251202_232044.png\n2025-12-02 23:20:44,886 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 23:20:44,886 - __main__ - INFO - Evaluating on test set...\n2025-12-02 23:20:44,887 - __main__ - INFO - Loading test dataset...\n2025-12-02 23:20:44,887 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 23:20:44,901 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 23:20:45,144 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 23:20:45,671 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 23:20:45,702 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 23:20:45,708 - __main__ - INFO - Loaded 22857 test patches in 0.82s\n2025-12-02 23:20:45,711 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 23:20:45,711 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 23:20:45,711 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 23:20:45,712 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 23:20:45,715 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 23:20:45,717 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 23:20:45,719 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 23:20:45,748 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:20:45,770 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 23:20:45,770 - __main__ - INFO - Total available patches: 8936\n2025-12-02 23:20:45,771 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 23:20:47,552 - __main__ - INFO - Test Results: Loss=1.386307, Accuracy=0.2500\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-02 23:20:47,572 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/logs/test_classification_report_20251202_232047.json\n2025-12-02 23:20:47,780 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/plots/test_confusion_matrix_20251202_232047.png\n2025-12-02 23:20:47,805 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/training_summary_20251202_232047.json\n2025-12-02 23:20:47,808 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/latest_results.txt\n2025-12-02 23:20:47,808 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 23:20:47,808 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_b0f16eb2/training_summary_20251202_232047.json\n2025-12-02 23:20:47,808 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 301488/27408 = 11.0000 (1100.00%)\n2025-12-02 23:20:47,808 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.2500, Test Acc=0.2500\n",
      "return_code": 0
    },
    "config_zeromean_normalized_quantiles": {
      "config_name": "config_zeromean_normalized_quantiles",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_quantiles.conf",
      "start_time": 1764717654.5726504,
      "status": "success",
      "duration": 3226.339333295822,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 23:20:56,895 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 23:20:56,895 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_quantiles.conf\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=True, quantiles=True, aggregation=None\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 23:20:56,897 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 23:20:56,897 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_quantiles.conf\n2025-12-02 23:20:56,897 - __main__ - INFO - Training Configuration:\n2025-12-02 23:20:56,897 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 23:20:56,897 - __main__ - INFO -   Patch size: 10\n2025-12-02 23:20:56,897 - __main__ - INFO -   Batch size: 32\n2025-12-02 23:20:56,897 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 23:20:56,897 - __main__ - INFO -   Optimizer: adam\n2025-12-02 23:20:57,395 - __main__ - INFO - Using device: cuda\n2025-12-02 23:20:57,398 - __main__ - INFO - Using config hash: 138f7607\n2025-12-02 23:20:57,398 - __main__ - INFO - Using run ID: 138f7607\n2025-12-02 23:20:57,398 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607\n2025-12-02 23:20:57,406 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/config_138f7607.json\n2025-12-02 23:20:57,411 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 23:20:57,414 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 23:20:58,591 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 23:20:58,807 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 23:20:58,817 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 23:20:58,817 - __main__ - INFO - Preparing data...\n2025-12-02 23:20:58,817 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 23:20:58,817 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 23:20:58,817 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 23:21:10,156 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 23:21:10,156 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 23:21:10,157 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 23:21:10,733 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 23:21:11,772 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 23:21:11,772 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 23:21:11,778 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 23:21:11,778 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 23:21:11,783 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 23:21:11,783 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 23:21:11,783 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 23:21:11,783 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 23:21:11,785 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 23:21:11,785 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 23:21:11,802 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 23:21:11,802 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 23:21:11,803 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 23:21:11,803 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 23:21:11,807 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 23:21:11,807 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 23:21:11,807 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 23:21:11,811 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 23:21:11,811 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 23:21:11,811 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 23:21:11,814 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 23:21:11,815 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 23:21:11,815 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 23:21:11,818 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 23:21:11,818 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 23:21:11,828 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:21:11,831 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 23:21:11,841 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 23:21:11,845 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 23:21:11,845 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 23:21:11,846 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 23:21:11,846 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 23:21:11,855 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 23:21:11,858 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 23:21:11,868 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 23:21:11,872 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 23:21:11,882 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 23:21:11,883 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 23:21:11,890 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 23:21:11,891 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 23:21:11,891 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 23:21:11,891 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 23:21:11,891 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 23:21:11,891 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 23:21:11,891 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 23:21:11,891 - __main__ - INFO - Loading train dataset...\n2025-12-02 23:21:11,892 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 23:21:12,041 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 23:21:12,991 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 23:21:13,525 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 23:21:13,586 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 23:21:13,601 - __main__ - INFO - Loaded 67828 train patches in 1.71s\n2025-12-02 23:21:13,604 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 23:21:13,604 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 23:21:13,604 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 23:21:13,608 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 23:21:13,615 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 23:21:13,621 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 23:21:13,627 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 23:21:13,690 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:21:13,755 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 23:21:13,755 - __main__ - INFO - Total available patches: 27408\n2025-12-02 23:21:13,755 - __main__ - INFO - Loading validation dataset...\n2025-12-02 23:21:13,755 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 23:21:13,768 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 23:21:14,125 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 23:21:14,218 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 23:21:14,236 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 23:21:14,240 - __main__ - INFO - Loaded 22192 validation patches in 0.48s\n2025-12-02 23:21:14,241 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 23:21:14,241 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 23:21:14,241 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 23:21:14,243 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 23:21:14,245 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 23:21:14,247 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 23:21:14,249 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 23:21:14,267 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:21:14,283 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 23:21:14,283 - __main__ - INFO - Total available patches: 8572\n2025-12-02 23:21:14,283 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 23:21:14,284 - __main__ - INFO - Training batches: 857\n2025-12-02 23:21:14,284 - __main__ - INFO - Validation batches: 268\n2025-12-02 23:21:14,284 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 23:21:14,284 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 23:22:41,236 - __main__ - INFO - Epoch 1/50 (86.95s): Train Loss: 1.262009, Train Acc: 0.3741, Val Loss: 1.215732, Val Acc: 0.4036\n2025-12-02 23:22:41,250 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_1.pth\n2025-12-02 23:22:41,250 - __main__ - INFO - New best validation accuracy: 0.4036\n2025-12-02 23:24:08,035 - __main__ - INFO - Epoch 2/50 (86.78s): Train Loss: 1.213430, Train Acc: 0.4087, Val Loss: 1.197005, Val Acc: 0.4265\n2025-12-02 23:24:08,047 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_2.pth\n2025-12-02 23:24:08,047 - __main__ - INFO - New best validation accuracy: 0.4265\n2025-12-02 23:25:34,579 - __main__ - INFO - Epoch 3/50 (86.53s): Train Loss: 1.209791, Train Acc: 0.4136, Val Loss: 1.191602, Val Acc: 0.4171\n2025-12-02 23:27:01,488 - __main__ - INFO - Epoch 4/50 (86.91s): Train Loss: 1.203221, Train Acc: 0.4179, Val Loss: 1.191426, Val Acc: 0.4225\n2025-12-02 23:28:29,383 - __main__ - INFO - Epoch 5/50 (87.89s): Train Loss: 1.202100, Train Acc: 0.4195, Val Loss: 1.185680, Val Acc: 0.4322\n2025-12-02 23:28:29,396 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_5.pth\n2025-12-02 23:28:29,396 - __main__ - INFO - New best validation accuracy: 0.4322\n2025-12-02 23:29:56,877 - __main__ - INFO - Epoch 6/50 (87.48s): Train Loss: 1.195364, Train Acc: 0.4213, Val Loss: 1.179229, Val Acc: 0.4381\n2025-12-02 23:29:56,890 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_6.pth\n2025-12-02 23:29:56,890 - __main__ - INFO - New best validation accuracy: 0.4381\n2025-12-02 23:31:23,522 - __main__ - INFO - Epoch 7/50 (86.63s): Train Loss: 1.192127, Train Acc: 0.4240, Val Loss: 1.176834, Val Acc: 0.4363\n2025-12-02 23:32:49,981 - __main__ - INFO - Epoch 8/50 (86.46s): Train Loss: 1.190379, Train Acc: 0.4264, Val Loss: 1.178280, Val Acc: 0.4424\n2025-12-02 23:32:49,993 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_8.pth\n2025-12-02 23:32:49,994 - __main__ - INFO - New best validation accuracy: 0.4424\n2025-12-02 23:34:17,343 - __main__ - INFO - Epoch 9/50 (87.35s): Train Loss: 1.184635, Train Acc: 0.4308, Val Loss: 1.169038, Val Acc: 0.4449\n2025-12-02 23:34:17,356 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_9.pth\n2025-12-02 23:34:17,357 - __main__ - INFO - New best validation accuracy: 0.4449\n2025-12-02 23:35:43,999 - __main__ - INFO - Epoch 10/50 (86.64s): Train Loss: 1.186993, Train Acc: 0.4287, Val Loss: 1.174672, Val Acc: 0.4272\n2025-12-02 23:35:44,012 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/checkpoint_epoch_10.pth\n2025-12-02 23:37:17,875 - __main__ - INFO - Epoch 11/50 (93.86s): Train Loss: 1.184909, Train Acc: 0.4306, Val Loss: 1.167003, Val Acc: 0.4493\n2025-12-02 23:37:17,888 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_11.pth\n2025-12-02 23:37:17,888 - __main__ - INFO - New best validation accuracy: 0.4493\n2025-12-02 23:38:57,344 - __main__ - INFO - Epoch 12/50 (99.46s): Train Loss: 1.180574, Train Acc: 0.4371, Val Loss: 1.173957, Val Acc: 0.4497\n2025-12-02 23:38:57,357 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_12.pth\n2025-12-02 23:38:57,357 - __main__ - INFO - New best validation accuracy: 0.4497\n2025-12-02 23:40:35,013 - __main__ - INFO - Epoch 13/50 (97.66s): Train Loss: 1.177816, Train Acc: 0.4393, Val Loss: 1.170006, Val Acc: 0.4453\n2025-12-02 23:42:01,750 - __main__ - INFO - Epoch 14/50 (86.74s): Train Loss: 1.177507, Train Acc: 0.4359, Val Loss: 1.159832, Val Acc: 0.4530\n2025-12-02 23:42:01,762 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_14.pth\n2025-12-02 23:42:01,762 - __main__ - INFO - New best validation accuracy: 0.4530\n2025-12-02 23:43:29,426 - __main__ - INFO - Epoch 15/50 (87.66s): Train Loss: 1.174974, Train Acc: 0.4387, Val Loss: 1.165623, Val Acc: 0.4558\n2025-12-02 23:43:29,435 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_15.pth\n2025-12-02 23:43:29,435 - __main__ - INFO - New best validation accuracy: 0.4558\n2025-12-02 23:44:56,965 - __main__ - INFO - Epoch 16/50 (87.53s): Train Loss: 1.172334, Train Acc: 0.4448, Val Loss: 1.160188, Val Acc: 0.4584\n2025-12-02 23:44:56,978 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_16.pth\n2025-12-02 23:44:56,978 - __main__ - INFO - New best validation accuracy: 0.4584\n2025-12-02 23:46:24,180 - __main__ - INFO - Epoch 17/50 (87.20s): Train Loss: 1.174006, Train Acc: 0.4396, Val Loss: 1.161035, Val Acc: 0.4565\n2025-12-02 23:47:50,922 - __main__ - INFO - Epoch 18/50 (86.74s): Train Loss: 1.168662, Train Acc: 0.4462, Val Loss: 1.172570, Val Acc: 0.4474\n2025-12-02 23:49:17,797 - __main__ - INFO - Epoch 19/50 (86.87s): Train Loss: 1.168970, Train Acc: 0.4429, Val Loss: 1.154813, Val Acc: 0.4592\n2025-12-02 23:49:17,810 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_19.pth\n2025-12-02 23:49:17,811 - __main__ - INFO - New best validation accuracy: 0.4592\n2025-12-02 23:50:44,747 - __main__ - INFO - Epoch 20/50 (86.94s): Train Loss: 1.169177, Train Acc: 0.4479, Val Loss: 1.156270, Val Acc: 0.4558\n2025-12-02 23:50:44,760 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/checkpoint_epoch_20.pth\n2025-12-02 23:52:11,545 - __main__ - INFO - Epoch 21/50 (86.78s): Train Loss: 1.166079, Train Acc: 0.4494, Val Loss: 1.159794, Val Acc: 0.4508\n2025-12-02 23:53:38,413 - __main__ - INFO - Epoch 22/50 (86.87s): Train Loss: 1.168151, Train Acc: 0.4476, Val Loss: 1.170103, Val Acc: 0.4572\n2025-12-02 23:55:05,450 - __main__ - INFO - Epoch 23/50 (87.04s): Train Loss: 1.168866, Train Acc: 0.4515, Val Loss: 1.157549, Val Acc: 0.4638\n2025-12-02 23:55:05,463 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_23.pth\n2025-12-02 23:55:05,463 - __main__ - INFO - New best validation accuracy: 0.4638\n2025-12-02 23:56:31,876 - __main__ - INFO - Epoch 24/50 (86.41s): Train Loss: 1.166638, Train Acc: 0.4469, Val Loss: 1.163983, Val Acc: 0.4411\n2025-12-02 23:57:58,304 - __main__ - INFO - Epoch 25/50 (86.43s): Train Loss: 1.167310, Train Acc: 0.4472, Val Loss: 1.157113, Val Acc: 0.4559\n2025-12-02 23:59:24,774 - __main__ - INFO - Epoch 26/50 (86.47s): Train Loss: 1.168019, Train Acc: 0.4513, Val Loss: 1.154154, Val Acc: 0.4665\n2025-12-02 23:59:24,787 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/best_model_epoch_26.pth\n2025-12-02 23:59:24,787 - __main__ - INFO - New best validation accuracy: 0.4665\n2025-12-03 00:00:51,928 - __main__ - INFO - Epoch 27/50 (87.14s): Train Loss: 1.166652, Train Acc: 0.4510, Val Loss: 1.153173, Val Acc: 0.4650\n2025-12-03 00:02:19,306 - __main__ - INFO - Epoch 28/50 (87.38s): Train Loss: 1.166329, Train Acc: 0.4517, Val Loss: 1.154706, Val Acc: 0.4630\n2025-12-03 00:03:45,814 - __main__ - INFO - Epoch 29/50 (86.51s): Train Loss: 1.164303, Train Acc: 0.4552, Val Loss: 1.180731, Val Acc: 0.4521\n2025-12-03 00:05:13,416 - __main__ - INFO - Epoch 30/50 (87.60s): Train Loss: 1.164480, Train Acc: 0.4541, Val Loss: 1.154257, Val Acc: 0.4579\n2025-12-03 00:05:13,430 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/models/checkpoint_epoch_30.pth\n2025-12-03 00:06:40,603 - __main__ - INFO - Epoch 31/50 (87.17s): Train Loss: 1.165477, Train Acc: 0.4494, Val Loss: 1.263168, Val Acc: 0.3969\n2025-12-03 00:08:07,406 - __main__ - INFO - Epoch 32/50 (86.80s): Train Loss: 1.163102, Train Acc: 0.4523, Val Loss: 1.153224, Val Acc: 0.4655\n2025-12-03 00:09:33,770 - __main__ - INFO - Epoch 33/50 (86.36s): Train Loss: 1.161922, Train Acc: 0.4534, Val Loss: 1.153895, Val Acc: 0.4615\n2025-12-03 00:11:00,691 - __main__ - INFO - Epoch 34/50 (86.92s): Train Loss: 1.162002, Train Acc: 0.4525, Val Loss: 1.180027, Val Acc: 0.4315\n2025-12-03 00:12:27,594 - __main__ - INFO - Epoch 35/50 (86.90s): Train Loss: 1.162447, Train Acc: 0.4508, Val Loss: 1.151760, Val Acc: 0.4634\n2025-12-03 00:13:55,107 - __main__ - INFO - Epoch 36/50 (87.51s): Train Loss: 1.162350, Train Acc: 0.4517, Val Loss: 1.155471, Val Acc: 0.4568\n2025-12-03 00:13:55,107 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 00:13:55,107 - __main__ - INFO - Training completed in 3160.82s\n2025-12-03 00:13:55,107 - __main__ - INFO - Best validation accuracy: 0.4665\n2025-12-03 00:13:55,808 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/plots/training_history_20251203_001355.png\n2025-12-03 00:14:16,668 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/logs/classification_report_20251203_001416.json\n2025-12-03 00:14:16,668 - __main__ - INFO - Classification Results:\n2025-12-03 00:14:16,668 - __main__ - INFO -   Class 1: Precision=0.506, Recall=0.183, F1=0.269\n2025-12-03 00:14:16,668 - __main__ - INFO -   Class 4: Precision=0.474, Recall=0.760, F1=0.583\n2025-12-03 00:14:16,668 - __main__ - INFO -   Class 6: Precision=0.425, Recall=0.348, F1=0.383\n2025-12-03 00:14:16,668 - __main__ - INFO -   Class 12: Precision=0.442, Recall=0.537, F1=0.485\n2025-12-03 00:14:16,904 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/plots/confusion_matrix_20251203_001416.png\n2025-12-03 00:14:16,905 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 00:14:16,905 - __main__ - INFO - Evaluating on test set...\n2025-12-03 00:14:16,905 - __main__ - INFO - Loading test dataset...\n2025-12-03 00:14:16,905 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 00:14:16,917 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 00:14:17,323 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 00:14:17,421 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 00:14:17,445 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 00:14:17,449 - __main__ - INFO - Loaded 22857 test patches in 0.54s\n2025-12-03 00:14:17,452 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 00:14:17,452 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 00:14:17,452 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 00:14:17,453 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 00:14:17,455 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 00:14:17,457 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 00:14:17,459 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 00:14:17,479 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:14:17,494 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:14:17,494 - __main__ - INFO - Total available patches: 8936\n2025-12-03 00:14:17,495 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 00:14:39,262 - __main__ - INFO - Test Results: Loss=1.152981, Accuracy=0.4569\n2025-12-03 00:14:39,282 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/logs/test_classification_report_20251203_001439.json\n2025-12-03 00:14:39,515 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/plots/test_confusion_matrix_20251203_001439.png\n2025-12-03 00:14:39,539 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/training_summary_20251203_001439.json\n2025-12-03 00:14:39,542 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/latest_results.txt\n2025-12-03 00:14:39,542 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 00:14:39,542 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_138f7607/training_summary_20251203_001439.json\n2025-12-03 00:14:39,542 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 986688/27408 = 36.0000 (3600.00%)\n2025-12-03 00:14:39,542 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4665, Test Acc=0.4569\n",
      "return_code": 0
    },
    "config_zeromean_normalized_shuffled": {
      "config_name": "config_zeromean_normalized_shuffled",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_shuffled.conf",
      "start_time": 1764720885.9239626,
      "status": "success",
      "duration": 342.9725890159607,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 00:14:48,430 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 00:14:48,430 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_shuffled.conf\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=True, zero_mean=True, normalized=True, quantiles=False, aggregation=None\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 00:14:48,433 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-03 00:14:48,433 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_shuffled.conf\n2025-12-03 00:14:48,433 - __main__ - INFO - Training Configuration:\n2025-12-03 00:14:48,433 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 00:14:48,433 - __main__ - INFO -   Patch size: 10\n2025-12-03 00:14:48,433 - __main__ - INFO -   Batch size: 32\n2025-12-03 00:14:48,433 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-03 00:14:48,433 - __main__ - INFO -   Optimizer: adam\n2025-12-03 00:14:49,113 - __main__ - INFO - Using device: cuda\n2025-12-03 00:14:49,116 - __main__ - INFO - Using config hash: f3fbc1ba\n2025-12-03 00:14:49,116 - __main__ - INFO - Using run ID: f3fbc1ba\n2025-12-03 00:14:49,116 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba\n2025-12-03 00:14:49,124 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/config_f3fbc1ba.json\n2025-12-03 00:14:49,129 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-03 00:14:49,132 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-03 00:14:50,300 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-03 00:14:50,514 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-03 00:14:50,524 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/plots/model_summary_test_conv2d_n2.txt\n2025-12-03 00:14:50,524 - __main__ - INFO - Preparing data...\n2025-12-03 00:14:50,524 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 00:14:50,524 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 00:14:50,525 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 00:15:02,122 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 00:15:02,123 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 00:15:02,124 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 00:15:02,777 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 00:15:03,832 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 00:15:03,833 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 00:15:03,847 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 00:15:03,847 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 00:15:03,851 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 00:15:03,851 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 00:15:03,852 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 00:15:03,852 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 00:15:03,854 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 00:15:03,854 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 00:15:04,237 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 00:15:04,237 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 00:15:04,238 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 00:15:04,239 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 00:15:04,244 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 00:15:04,244 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 00:15:04,244 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 00:15:04,248 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 00:15:04,248 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 00:15:04,249 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 00:15:04,252 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 00:15:04,252 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 00:15:04,253 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 00:15:04,256 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 00:15:04,256 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 00:15:04,267 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:15:04,269 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:15:04,280 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 00:15:04,283 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 00:15:04,283 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 00:15:04,284 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 00:15:04,285 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 00:15:04,294 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 00:15:04,296 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 00:15:04,306 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 00:15:04,310 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 00:15:04,320 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 00:15:04,321 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 00:15:04,328 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 00:15:04,329 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 00:15:04,329 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 00:15:04,329 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 00:15:04,329 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 00:15:04,329 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 00:15:04,329 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 00:15:04,330 - __main__ - INFO - Loading train dataset...\n2025-12-03 00:15:04,330 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 00:15:04,481 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 00:15:05,435 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 00:15:05,992 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 00:15:06,079 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 00:15:06,103 - __main__ - INFO - Loaded 67828 train patches in 1.77s\n2025-12-03 00:15:06,106 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 00:15:06,107 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 00:15:06,107 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 00:15:06,111 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 00:15:06,119 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 00:15:06,126 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 00:15:06,133 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 00:15:06,232 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:15:06,324 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:15:06,324 - __main__ - INFO - Total available patches: 27408\n2025-12-03 00:15:06,324 - __main__ - INFO - Loading validation dataset...\n2025-12-03 00:15:06,324 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 00:15:06,339 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 00:15:06,847 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 00:15:06,960 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 00:15:06,987 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 00:15:06,994 - __main__ - INFO - Loaded 22192 validation patches in 0.67s\n2025-12-03 00:15:06,995 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 00:15:06,995 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 00:15:06,995 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 00:15:06,996 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 00:15:06,999 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 00:15:07,001 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 00:15:07,003 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 00:15:07,033 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:15:07,055 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:15:07,055 - __main__ - INFO - Total available patches: 8572\n2025-12-03 00:15:07,055 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 00:15:07,056 - __main__ - INFO - Training batches: 857\n2025-12-03 00:15:07,056 - __main__ - INFO - Validation batches: 268\n2025-12-03 00:15:07,056 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 00:15:07,056 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 00:15:13,641 - __main__ - INFO - Epoch 1/50 (6.59s): Train Loss: 1.208245, Train Acc: 0.4110, Val Loss: 1.156897, Val Acc: 0.4554\n2025-12-03 00:15:13,656 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_1.pth\n2025-12-03 00:15:13,656 - __main__ - INFO - New best validation accuracy: 0.4554\n2025-12-03 00:15:19,938 - __main__ - INFO - Epoch 2/50 (6.28s): Train Loss: 1.156996, Train Acc: 0.4483, Val Loss: 1.129631, Val Acc: 0.4809\n2025-12-03 00:15:19,951 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_2.pth\n2025-12-03 00:15:19,951 - __main__ - INFO - New best validation accuracy: 0.4809\n2025-12-03 00:15:26,061 - __main__ - INFO - Epoch 3/50 (6.11s): Train Loss: 1.136144, Train Acc: 0.4711, Val Loss: 1.105503, Val Acc: 0.5050\n2025-12-03 00:15:26,073 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_3.pth\n2025-12-03 00:15:26,073 - __main__ - INFO - New best validation accuracy: 0.5050\n2025-12-03 00:15:32,404 - __main__ - INFO - Epoch 4/50 (6.33s): Train Loss: 1.125098, Train Acc: 0.4830, Val Loss: 1.093441, Val Acc: 0.5099\n2025-12-03 00:15:32,412 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_4.pth\n2025-12-03 00:15:32,412 - __main__ - INFO - New best validation accuracy: 0.5099\n2025-12-03 00:15:38,578 - __main__ - INFO - Epoch 5/50 (6.17s): Train Loss: 1.115695, Train Acc: 0.4910, Val Loss: 1.075203, Val Acc: 0.5269\n2025-12-03 00:15:38,591 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_5.pth\n2025-12-03 00:15:38,591 - __main__ - INFO - New best validation accuracy: 0.5269\n2025-12-03 00:15:44,841 - __main__ - INFO - Epoch 6/50 (6.25s): Train Loss: 1.110225, Train Acc: 0.4942, Val Loss: 1.079372, Val Acc: 0.5276\n2025-12-03 00:15:44,853 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_6.pth\n2025-12-03 00:15:44,853 - __main__ - INFO - New best validation accuracy: 0.5276\n2025-12-03 00:15:51,087 - __main__ - INFO - Epoch 7/50 (6.23s): Train Loss: 1.103166, Train Acc: 0.4967, Val Loss: 1.072365, Val Acc: 0.5194\n2025-12-03 00:15:57,304 - __main__ - INFO - Epoch 8/50 (6.22s): Train Loss: 1.104021, Train Acc: 0.4967, Val Loss: 1.069808, Val Acc: 0.5218\n2025-12-03 00:16:03,736 - __main__ - INFO - Epoch 9/50 (6.43s): Train Loss: 1.103270, Train Acc: 0.5007, Val Loss: 1.081474, Val Acc: 0.5127\n2025-12-03 00:16:10,155 - __main__ - INFO - Epoch 10/50 (6.42s): Train Loss: 1.100064, Train Acc: 0.5003, Val Loss: 1.069706, Val Acc: 0.5301\n2025-12-03 00:16:10,167 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_10.pth\n2025-12-03 00:16:10,167 - __main__ - INFO - New best validation accuracy: 0.5301\n2025-12-03 00:16:10,175 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/checkpoint_epoch_10.pth\n2025-12-03 00:16:16,469 - __main__ - INFO - Epoch 11/50 (6.29s): Train Loss: 1.098959, Train Acc: 0.5046, Val Loss: 1.068514, Val Acc: 0.5184\n2025-12-03 00:16:22,810 - __main__ - INFO - Epoch 12/50 (6.34s): Train Loss: 1.095170, Train Acc: 0.5043, Val Loss: 1.065390, Val Acc: 0.5345\n2025-12-03 00:16:22,822 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_12.pth\n2025-12-03 00:16:22,822 - __main__ - INFO - New best validation accuracy: 0.5345\n2025-12-03 00:16:29,109 - __main__ - INFO - Epoch 13/50 (6.29s): Train Loss: 1.097480, Train Acc: 0.5061, Val Loss: 1.061335, Val Acc: 0.5391\n2025-12-03 00:16:29,121 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_13.pth\n2025-12-03 00:16:29,121 - __main__ - INFO - New best validation accuracy: 0.5391\n2025-12-03 00:16:35,464 - __main__ - INFO - Epoch 14/50 (6.34s): Train Loss: 1.093829, Train Acc: 0.5044, Val Loss: 1.060584, Val Acc: 0.5344\n2025-12-03 00:16:41,625 - __main__ - INFO - Epoch 15/50 (6.16s): Train Loss: 1.091403, Train Acc: 0.5064, Val Loss: 1.072026, Val Acc: 0.5302\n2025-12-03 00:16:48,330 - __main__ - INFO - Epoch 16/50 (6.70s): Train Loss: 1.089234, Train Acc: 0.5108, Val Loss: 1.061243, Val Acc: 0.5373\n2025-12-03 00:16:54,663 - __main__ - INFO - Epoch 17/50 (6.33s): Train Loss: 1.088778, Train Acc: 0.5101, Val Loss: 1.054276, Val Acc: 0.5420\n2025-12-03 00:16:54,675 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_17.pth\n2025-12-03 00:16:54,675 - __main__ - INFO - New best validation accuracy: 0.5420\n2025-12-03 00:17:00,972 - __main__ - INFO - Epoch 18/50 (6.30s): Train Loss: 1.085856, Train Acc: 0.5119, Val Loss: 1.063342, Val Acc: 0.5226\n2025-12-03 00:17:07,163 - __main__ - INFO - Epoch 19/50 (6.19s): Train Loss: 1.084510, Train Acc: 0.5108, Val Loss: 1.054121, Val Acc: 0.5367\n2025-12-03 00:17:13,593 - __main__ - INFO - Epoch 20/50 (6.43s): Train Loss: 1.086207, Train Acc: 0.5115, Val Loss: 1.064766, Val Acc: 0.5203\n2025-12-03 00:17:13,605 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/checkpoint_epoch_20.pth\n2025-12-03 00:17:19,968 - __main__ - INFO - Epoch 21/50 (6.36s): Train Loss: 1.084960, Train Acc: 0.5110, Val Loss: 1.050434, Val Acc: 0.5350\n2025-12-03 00:17:26,486 - __main__ - INFO - Epoch 22/50 (6.52s): Train Loss: 1.075497, Train Acc: 0.5191, Val Loss: 1.049683, Val Acc: 0.5366\n2025-12-03 00:17:32,705 - __main__ - INFO - Epoch 23/50 (6.22s): Train Loss: 1.082050, Train Acc: 0.5127, Val Loss: 1.048943, Val Acc: 0.5448\n2025-12-03 00:17:32,717 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_23.pth\n2025-12-03 00:17:32,717 - __main__ - INFO - New best validation accuracy: 0.5448\n2025-12-03 00:17:39,022 - __main__ - INFO - Epoch 24/50 (6.30s): Train Loss: 1.080013, Train Acc: 0.5145, Val Loss: 1.047738, Val Acc: 0.5435\n2025-12-03 00:17:45,405 - __main__ - INFO - Epoch 25/50 (6.38s): Train Loss: 1.076490, Train Acc: 0.5174, Val Loss: 1.051455, Val Acc: 0.5486\n2025-12-03 00:17:45,417 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_25.pth\n2025-12-03 00:17:45,417 - __main__ - INFO - New best validation accuracy: 0.5486\n2025-12-03 00:17:51,740 - __main__ - INFO - Epoch 26/50 (6.32s): Train Loss: 1.076560, Train Acc: 0.5224, Val Loss: 1.048261, Val Acc: 0.5435\n2025-12-03 00:17:57,971 - __main__ - INFO - Epoch 27/50 (6.23s): Train Loss: 1.077151, Train Acc: 0.5187, Val Loss: 1.044635, Val Acc: 0.5384\n2025-12-03 00:18:04,328 - __main__ - INFO - Epoch 28/50 (6.36s): Train Loss: 1.075448, Train Acc: 0.5222, Val Loss: 1.044226, Val Acc: 0.5432\n2025-12-03 00:18:10,607 - __main__ - INFO - Epoch 29/50 (6.28s): Train Loss: 1.073666, Train Acc: 0.5203, Val Loss: 1.046153, Val Acc: 0.5484\n2025-12-03 00:18:16,830 - __main__ - INFO - Epoch 30/50 (6.22s): Train Loss: 1.070959, Train Acc: 0.5177, Val Loss: 1.041916, Val Acc: 0.5426\n2025-12-03 00:18:16,842 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/checkpoint_epoch_30.pth\n2025-12-03 00:18:23,241 - __main__ - INFO - Epoch 31/50 (6.40s): Train Loss: 1.074390, Train Acc: 0.5167, Val Loss: 1.045828, Val Acc: 0.5442\n2025-12-03 00:18:29,482 - __main__ - INFO - Epoch 32/50 (6.24s): Train Loss: 1.073021, Train Acc: 0.5223, Val Loss: 1.042624, Val Acc: 0.5474\n2025-12-03 00:18:35,813 - __main__ - INFO - Epoch 33/50 (6.33s): Train Loss: 1.074324, Train Acc: 0.5170, Val Loss: 1.047212, Val Acc: 0.5499\n2025-12-03 00:18:35,826 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_33.pth\n2025-12-03 00:18:35,826 - __main__ - INFO - New best validation accuracy: 0.5499\n2025-12-03 00:18:42,198 - __main__ - INFO - Epoch 34/50 (6.37s): Train Loss: 1.071138, Train Acc: 0.5236, Val Loss: 1.038771, Val Acc: 0.5464\n2025-12-03 00:18:48,384 - __main__ - INFO - Epoch 35/50 (6.19s): Train Loss: 1.072648, Train Acc: 0.5222, Val Loss: 1.040875, Val Acc: 0.5500\n2025-12-03 00:18:48,396 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_35.pth\n2025-12-03 00:18:48,397 - __main__ - INFO - New best validation accuracy: 0.5500\n2025-12-03 00:18:54,741 - __main__ - INFO - Epoch 36/50 (6.34s): Train Loss: 1.072264, Train Acc: 0.5222, Val Loss: 1.040095, Val Acc: 0.5469\n2025-12-03 00:19:01,039 - __main__ - INFO - Epoch 37/50 (6.30s): Train Loss: 1.069193, Train Acc: 0.5226, Val Loss: 1.039413, Val Acc: 0.5414\n2025-12-03 00:19:07,394 - __main__ - INFO - Epoch 38/50 (6.35s): Train Loss: 1.070543, Train Acc: 0.5211, Val Loss: 1.045579, Val Acc: 0.5477\n2025-12-03 00:19:13,725 - __main__ - INFO - Epoch 39/50 (6.33s): Train Loss: 1.072630, Train Acc: 0.5208, Val Loss: 1.041448, Val Acc: 0.5516\n2025-12-03 00:19:13,734 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_39.pth\n2025-12-03 00:19:13,734 - __main__ - INFO - New best validation accuracy: 0.5516\n2025-12-03 00:19:20,154 - __main__ - INFO - Epoch 40/50 (6.42s): Train Loss: 1.067140, Train Acc: 0.5254, Val Loss: 1.042706, Val Acc: 0.5537\n2025-12-03 00:19:20,163 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/best_model_epoch_40.pth\n2025-12-03 00:19:20,163 - __main__ - INFO - New best validation accuracy: 0.5537\n2025-12-03 00:19:20,168 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/models/checkpoint_epoch_40.pth\n2025-12-03 00:19:26,376 - __main__ - INFO - Epoch 41/50 (6.21s): Train Loss: 1.071064, Train Acc: 0.5236, Val Loss: 1.040661, Val Acc: 0.5489\n2025-12-03 00:19:32,809 - __main__ - INFO - Epoch 42/50 (6.43s): Train Loss: 1.069368, Train Acc: 0.5235, Val Loss: 1.038126, Val Acc: 0.5462\n2025-12-03 00:19:39,022 - __main__ - INFO - Epoch 43/50 (6.21s): Train Loss: 1.069190, Train Acc: 0.5246, Val Loss: 1.038400, Val Acc: 0.5462\n2025-12-03 00:19:45,294 - __main__ - INFO - Epoch 44/50 (6.27s): Train Loss: 1.069401, Train Acc: 0.5229, Val Loss: 1.042034, Val Acc: 0.5456\n2025-12-03 00:19:51,623 - __main__ - INFO - Epoch 45/50 (6.33s): Train Loss: 1.066595, Train Acc: 0.5240, Val Loss: 1.040071, Val Acc: 0.5492\n2025-12-03 00:19:57,874 - __main__ - INFO - Epoch 46/50 (6.25s): Train Loss: 1.067358, Train Acc: 0.5251, Val Loss: 1.038341, Val Acc: 0.5497\n2025-12-03 00:20:04,082 - __main__ - INFO - Epoch 47/50 (6.21s): Train Loss: 1.065853, Train Acc: 0.5260, Val Loss: 1.036680, Val Acc: 0.5450\n2025-12-03 00:20:10,242 - __main__ - INFO - Epoch 48/50 (6.16s): Train Loss: 1.066349, Train Acc: 0.5247, Val Loss: 1.041600, Val Acc: 0.5390\n2025-12-03 00:20:16,294 - __main__ - INFO - Epoch 49/50 (6.05s): Train Loss: 1.069106, Train Acc: 0.5235, Val Loss: 1.033942, Val Acc: 0.5516\n2025-12-03 00:20:22,461 - __main__ - INFO - Epoch 50/50 (6.17s): Train Loss: 1.065652, Train Acc: 0.5257, Val Loss: 1.038194, Val Acc: 0.5496\n2025-12-03 00:20:22,462 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 00:20:22,462 - __main__ - INFO - Training completed in 315.41s\n2025-12-03 00:20:22,462 - __main__ - INFO - Best validation accuracy: 0.5537\n2025-12-03 00:20:23,138 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/plots/training_history_20251203_002022.png\n2025-12-03 00:20:24,804 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/logs/classification_report_20251203_002024.json\n2025-12-03 00:20:24,804 - __main__ - INFO - Classification Results:\n2025-12-03 00:20:24,804 - __main__ - INFO -   Class 1: Precision=0.506, Recall=0.389, F1=0.440\n2025-12-03 00:20:24,804 - __main__ - INFO -   Class 4: Precision=0.617, Recall=0.636, F1=0.626\n2025-12-03 00:20:24,804 - __main__ - INFO -   Class 6: Precision=0.496, Recall=0.711, F1=0.584\n2025-12-03 00:20:24,804 - __main__ - INFO -   Class 12: Precision=0.602, Recall=0.462, F1=0.523\n2025-12-03 00:20:25,009 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/plots/confusion_matrix_20251203_002024.png\n2025-12-03 00:20:25,010 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 00:20:25,010 - __main__ - INFO - Evaluating on test set...\n2025-12-03 00:20:25,010 - __main__ - INFO - Loading test dataset...\n2025-12-03 00:20:25,010 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 00:20:25,024 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 00:20:25,437 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 00:20:25,533 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 00:20:25,558 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 00:20:25,562 - __main__ - INFO - Loaded 22857 test patches in 0.55s\n2025-12-03 00:20:25,564 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 00:20:25,564 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 00:20:25,564 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 00:20:25,566 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 00:20:25,568 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 00:20:25,570 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 00:20:25,572 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 00:20:25,591 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:20:25,606 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:20:25,606 - __main__ - INFO - Total available patches: 8936\n2025-12-03 00:20:25,606 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 00:20:27,315 - __main__ - INFO - Test Results: Loss=1.032720, Accuracy=0.5401\n2025-12-03 00:20:27,336 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/logs/test_classification_report_20251203_002027.json\n2025-12-03 00:20:27,551 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/plots/test_confusion_matrix_20251203_002027.png\n2025-12-03 00:20:27,573 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/training_summary_20251203_002027.json\n2025-12-03 00:20:27,576 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/latest_results.txt\n2025-12-03 00:20:27,576 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 00:20:27,576 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_f3fbc1ba/training_summary_20251203_002027.json\n2025-12-03 00:20:27,576 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 1370400/27408 = 50.0000 (5000.00%)\n2025-12-03 00:20:27,576 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.5537, Test Acc=0.5401\n",
      "return_code": 0
    },
    "config_zeromean_normalized_std": {
      "config_name": "config_zeromean_normalized_std",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_std.conf",
      "start_time": 1764721233.9072785,
      "status": "success",
      "duration": 102.41539144515991,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 00:20:36,383 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 00:20:36,384 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_std.conf\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=True, quantiles=False, aggregation=std\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 00:20:36,386 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-03 00:20:36,386 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_std.conf\n2025-12-03 00:20:36,386 - __main__ - INFO - Training Configuration:\n2025-12-03 00:20:36,386 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 00:20:36,386 - __main__ - INFO -   Patch size: 10\n2025-12-03 00:20:36,386 - __main__ - INFO -   Batch size: 32\n2025-12-03 00:20:36,386 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-03 00:20:36,386 - __main__ - INFO -   Optimizer: adam\n2025-12-03 00:20:37,034 - __main__ - INFO - Using device: cuda\n2025-12-03 00:20:37,037 - __main__ - INFO - Using config hash: cd39e900\n2025-12-03 00:20:37,037 - __main__ - INFO - Using run ID: cd39e900\n2025-12-03 00:20:37,037 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900\n2025-12-03 00:20:37,046 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/config_cd39e900.json\n2025-12-03 00:20:37,050 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-03 00:20:37,053 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-03 00:20:38,220 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-03 00:20:38,311 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-03 00:20:38,312 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-03 00:20:38,313 - __main__ - INFO - Preparing data...\n2025-12-03 00:20:38,313 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 00:20:38,313 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 00:20:38,313 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 00:20:49,582 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 00:20:49,582 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 00:20:49,583 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 00:20:50,173 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 00:20:51,209 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 00:20:51,209 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 00:20:51,215 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 00:20:51,215 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 00:20:51,219 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 00:20:51,219 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 00:20:51,219 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 00:20:51,219 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 00:20:51,221 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 00:20:51,222 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 00:20:51,239 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 00:20:51,239 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 00:20:51,240 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 00:20:51,240 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 00:20:51,245 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 00:20:51,245 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 00:20:51,246 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 00:20:51,249 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 00:20:51,250 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 00:20:51,250 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 00:20:51,254 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 00:20:51,254 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 00:20:51,254 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 00:20:51,258 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 00:20:51,258 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 00:20:51,268 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:20:51,270 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:20:51,281 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 00:20:51,284 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 00:20:51,284 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 00:20:51,285 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 00:20:51,286 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 00:20:51,295 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 00:20:51,297 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 00:20:51,307 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 00:20:51,311 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 00:20:51,322 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 00:20:51,322 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 00:20:51,322 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 00:20:51,322 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 00:20:51,322 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 00:20:51,322 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 00:20:51,323 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 00:20:51,323 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 00:20:51,329 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 00:20:51,330 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 00:20:51,330 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 00:20:51,330 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 00:20:51,330 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 00:20:51,330 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 00:20:51,331 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 00:20:51,331 - __main__ - INFO - Loading train dataset...\n2025-12-03 00:20:51,331 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 00:20:51,480 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 00:20:52,422 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 00:20:52,946 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 00:20:53,008 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 00:20:53,023 - __main__ - INFO - Loaded 67828 train patches in 1.69s\n2025-12-03 00:20:53,026 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 00:20:53,026 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 00:20:53,026 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 00:20:53,030 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 00:20:53,037 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 00:20:53,043 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 00:20:53,049 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 00:20:53,113 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:20:53,178 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:20:53,178 - __main__ - INFO - Total available patches: 27408\n2025-12-03 00:20:53,178 - __main__ - INFO - Loading validation dataset...\n2025-12-03 00:20:53,178 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 00:20:53,192 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 00:20:53,552 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 00:20:53,646 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 00:20:53,666 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 00:20:53,670 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-03 00:20:53,671 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 00:20:53,671 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 00:20:53,671 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 00:20:53,672 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 00:20:53,675 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 00:20:53,677 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 00:20:53,679 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 00:20:53,697 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:20:53,713 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:20:53,713 - __main__ - INFO - Total available patches: 8572\n2025-12-03 00:20:53,713 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 00:20:53,714 - __main__ - INFO - Training batches: 857\n2025-12-03 00:20:53,714 - __main__ - INFO - Validation batches: 268\n2025-12-03 00:20:53,714 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 00:20:53,714 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 00:21:00,681 - __main__ - INFO - Epoch 1/50 (6.97s): Train Loss: 1.389515, Train Acc: 0.2487, Val Loss: 1.387215, Val Acc: 0.2500\n2025-12-03 00:21:00,692 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/models/best_model_epoch_1.pth\n2025-12-03 00:21:00,692 - __main__ - INFO - New best validation accuracy: 0.2500\n2025-12-03 00:21:07,483 - __main__ - INFO - Epoch 2/50 (6.79s): Train Loss: 1.387790, Train Acc: 0.2465, Val Loss: 1.386898, Val Acc: 0.2500\n2025-12-03 00:21:14,440 - __main__ - INFO - Epoch 3/50 (6.96s): Train Loss: 1.387086, Train Acc: 0.2480, Val Loss: 1.386796, Val Acc: 0.2500\n2025-12-03 00:21:21,291 - __main__ - INFO - Epoch 4/50 (6.85s): Train Loss: 1.386871, Train Acc: 0.2489, Val Loss: 1.386819, Val Acc: 0.2500\n2025-12-03 00:21:28,516 - __main__ - INFO - Epoch 5/50 (7.22s): Train Loss: 1.386560, Train Acc: 0.2501, Val Loss: 1.386405, Val Acc: 0.2500\n2025-12-03 00:21:35,227 - __main__ - INFO - Epoch 6/50 (6.71s): Train Loss: 1.386392, Train Acc: 0.2493, Val Loss: 1.386366, Val Acc: 0.2500\n2025-12-03 00:21:41,911 - __main__ - INFO - Epoch 7/50 (6.68s): Train Loss: 1.386433, Train Acc: 0.2483, Val Loss: 1.386430, Val Acc: 0.2500\n2025-12-03 00:21:48,731 - __main__ - INFO - Epoch 8/50 (6.82s): Train Loss: 1.386472, Train Acc: 0.2450, Val Loss: 1.386297, Val Acc: 0.2500\n2025-12-03 00:21:55,663 - __main__ - INFO - Epoch 9/50 (6.93s): Train Loss: 1.386401, Train Acc: 0.2469, Val Loss: 1.386364, Val Acc: 0.2500\n2025-12-03 00:22:02,466 - __main__ - INFO - Epoch 10/50 (6.80s): Train Loss: 1.386449, Train Acc: 0.2456, Val Loss: 1.386311, Val Acc: 0.2500\n2025-12-03 00:22:02,475 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/models/checkpoint_epoch_10.pth\n2025-12-03 00:22:09,227 - __main__ - INFO - Epoch 11/50 (6.75s): Train Loss: 1.386425, Train Acc: 0.2449, Val Loss: 1.386313, Val Acc: 0.2500\n2025-12-03 00:22:09,227 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 00:22:09,227 - __main__ - INFO - Training completed in 75.51s\n2025-12-03 00:22:09,228 - __main__ - INFO - Best validation accuracy: 0.2500\n2025-12-03 00:22:09,888 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/plots/training_history_20251203_002209.png\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-03 00:22:11,747 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/logs/classification_report_20251203_002211.json\n2025-12-03 00:22:11,747 - __main__ - INFO - Classification Results:\n2025-12-03 00:22:11,747 - __main__ - INFO -   Class 1: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-03 00:22:11,747 - __main__ - INFO -   Class 4: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-03 00:22:11,747 - __main__ - INFO -   Class 6: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-03 00:22:11,747 - __main__ - INFO -   Class 12: Precision=0.250, Recall=1.000, F1=0.400\n2025-12-03 00:22:12,180 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/plots/confusion_matrix_20251203_002211.png\n2025-12-03 00:22:12,182 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 00:22:12,182 - __main__ - INFO - Evaluating on test set...\n2025-12-03 00:22:12,182 - __main__ - INFO - Loading test dataset...\n2025-12-03 00:22:12,182 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 00:22:12,193 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 00:22:12,416 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 00:22:12,746 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 00:22:12,769 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 00:22:12,774 - __main__ - INFO - Loaded 22857 test patches in 0.59s\n2025-12-03 00:22:12,776 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 00:22:12,776 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 00:22:12,776 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 00:22:12,777 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 00:22:12,780 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 00:22:12,782 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 00:22:12,784 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 00:22:12,803 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:22:12,819 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:22:12,819 - __main__ - INFO - Total available patches: 8936\n2025-12-03 00:22:12,820 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 00:22:14,694 - __main__ - INFO - Test Results: Loss=1.386312, Accuracy=0.2500\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-03 00:22:14,714 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/logs/test_classification_report_20251203_002214.json\n2025-12-03 00:22:14,933 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/plots/test_confusion_matrix_20251203_002214.png\n2025-12-03 00:22:14,956 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/training_summary_20251203_002214.json\n2025-12-03 00:22:14,959 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/latest_results.txt\n2025-12-03 00:22:14,959 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 00:22:14,959 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_cd39e900/training_summary_20251203_002214.json\n2025-12-03 00:22:14,959 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 301488/27408 = 11.0000 (1100.00%)\n2025-12-03 00:22:14,959 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.2500, Test Acc=0.2500\n",
      "return_code": 0
    },
    "config_zeromean_normalized_stdandmean": {
      "config_name": "config_zeromean_normalized_stdandmean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_stdandmean.conf",
      "start_time": 1764721341.3342366,
      "status": "success",
      "duration": 102.90274453163147,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 00:22:23,673 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 00:22:23,673 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_stdandmean.conf\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=True, quantiles=False, aggregation=stdandmean\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 00:22:23,675 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-03 00:22:23,675 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_normalized_stdandmean.conf\n2025-12-03 00:22:23,675 - __main__ - INFO - Training Configuration:\n2025-12-03 00:22:23,675 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 00:22:23,675 - __main__ - INFO -   Patch size: 10\n2025-12-03 00:22:23,675 - __main__ - INFO -   Batch size: 32\n2025-12-03 00:22:23,675 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-03 00:22:23,675 - __main__ - INFO -   Optimizer: adam\n2025-12-03 00:22:24,171 - __main__ - INFO - Using device: cuda\n2025-12-03 00:22:24,174 - __main__ - INFO - Using config hash: d4b873ed\n2025-12-03 00:22:24,174 - __main__ - INFO - Using run ID: d4b873ed\n2025-12-03 00:22:24,174 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed\n2025-12-03 00:22:24,181 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/config_d4b873ed.json\n2025-12-03 00:22:24,185 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 4\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-03 00:22:24,188 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 580\n2025-12-03 00:22:25,172 - __main__ - INFO - Model initialized with 580 parameters\n2025-12-03 00:22:25,259 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-03 00:22:25,260 - __main__ - WARNING - Could not create model summary: Expected 4 input features, got 200\n2025-12-03 00:22:25,260 - __main__ - INFO - Preparing data...\n2025-12-03 00:22:25,260 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 00:22:25,260 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 00:22:25,260 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 00:22:36,404 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 00:22:36,404 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 00:22:36,405 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 00:22:36,979 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 00:22:38,009 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 00:22:38,009 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 00:22:38,015 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 00:22:38,015 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 00:22:38,019 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 00:22:38,019 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 00:22:38,019 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 00:22:38,019 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 00:22:38,021 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 00:22:38,021 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 00:22:38,039 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 00:22:38,039 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 00:22:38,040 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 00:22:38,040 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 00:22:38,045 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 00:22:38,045 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 00:22:38,045 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 00:22:38,049 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 00:22:38,049 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 00:22:38,049 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 00:22:38,053 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 00:22:38,053 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 00:22:38,053 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 00:22:38,057 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 00:22:38,057 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 00:22:38,067 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:22:38,070 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:22:38,080 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 00:22:38,083 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 00:22:38,083 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 00:22:38,084 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 00:22:38,085 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 00:22:38,094 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 00:22:38,097 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 00:22:38,107 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 00:22:38,110 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 00:22:38,121 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 00:22:38,122 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 00:22:38,129 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 00:22:38,130 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 00:22:38,130 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 00:22:38,130 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 00:22:38,130 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 00:22:38,130 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 00:22:38,130 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 00:22:38,131 - __main__ - INFO - Loading train dataset...\n2025-12-03 00:22:38,131 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 00:22:38,280 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 00:22:39,224 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 00:22:39,750 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 00:22:39,812 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 00:22:39,827 - __main__ - INFO - Loaded 67828 train patches in 1.70s\n2025-12-03 00:22:39,830 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 00:22:39,830 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 00:22:39,830 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 00:22:39,834 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 00:22:39,841 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 00:22:39,847 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 00:22:39,853 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 00:22:39,917 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:22:39,985 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:22:39,985 - __main__ - INFO - Total available patches: 27408\n2025-12-03 00:22:39,985 - __main__ - INFO - Loading validation dataset...\n2025-12-03 00:22:39,985 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 00:22:39,998 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 00:22:40,355 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 00:22:40,446 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 00:22:40,465 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 00:22:40,470 - __main__ - INFO - Loaded 22192 validation patches in 0.48s\n2025-12-03 00:22:40,471 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 00:22:40,471 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 00:22:40,471 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 00:22:40,472 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 00:22:40,474 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 00:22:40,476 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 00:22:40,478 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 00:22:40,497 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:22:40,513 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:22:40,513 - __main__ - INFO - Total available patches: 8572\n2025-12-03 00:22:40,513 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 00:22:40,513 - __main__ - INFO - Training batches: 857\n2025-12-03 00:22:40,513 - __main__ - INFO - Validation batches: 268\n2025-12-03 00:22:40,513 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 00:22:40,513 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 00:22:47,682 - __main__ - INFO - Epoch 1/50 (7.17s): Train Loss: 1.389993, Train Acc: 0.2494, Val Loss: 1.386521, Val Acc: 0.2500\n2025-12-03 00:22:47,692 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/models/best_model_epoch_1.pth\n2025-12-03 00:22:47,692 - __main__ - INFO - New best validation accuracy: 0.2500\n2025-12-03 00:22:54,673 - __main__ - INFO - Epoch 2/50 (6.98s): Train Loss: 1.387727, Train Acc: 0.2459, Val Loss: 1.386471, Val Acc: 0.2500\n2025-12-03 00:23:01,513 - __main__ - INFO - Epoch 3/50 (6.84s): Train Loss: 1.386727, Train Acc: 0.2533, Val Loss: 1.386539, Val Acc: 0.2500\n2025-12-03 00:23:08,450 - __main__ - INFO - Epoch 4/50 (6.94s): Train Loss: 1.386882, Train Acc: 0.2521, Val Loss: 1.386430, Val Acc: 0.2500\n2025-12-03 00:23:15,642 - __main__ - INFO - Epoch 5/50 (7.19s): Train Loss: 1.386585, Train Acc: 0.2499, Val Loss: 1.386666, Val Acc: 0.2500\n2025-12-03 00:23:22,469 - __main__ - INFO - Epoch 6/50 (6.83s): Train Loss: 1.386527, Train Acc: 0.2505, Val Loss: 1.386423, Val Acc: 0.2500\n2025-12-03 00:23:29,358 - __main__ - INFO - Epoch 7/50 (6.89s): Train Loss: 1.386503, Train Acc: 0.2471, Val Loss: 1.386318, Val Acc: 0.2500\n2025-12-03 00:23:36,244 - __main__ - INFO - Epoch 8/50 (6.89s): Train Loss: 1.386514, Train Acc: 0.2423, Val Loss: 1.386307, Val Acc: 0.2500\n2025-12-03 00:23:43,045 - __main__ - INFO - Epoch 9/50 (6.80s): Train Loss: 1.386425, Train Acc: 0.2497, Val Loss: 1.386304, Val Acc: 0.2500\n2025-12-03 00:23:49,859 - __main__ - INFO - Epoch 10/50 (6.81s): Train Loss: 1.386435, Train Acc: 0.2435, Val Loss: 1.386304, Val Acc: 0.2500\n2025-12-03 00:23:49,868 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/models/checkpoint_epoch_10.pth\n2025-12-03 00:23:56,788 - __main__ - INFO - Epoch 11/50 (6.92s): Train Loss: 1.386397, Train Acc: 0.2479, Val Loss: 1.386303, Val Acc: 0.2500\n2025-12-03 00:23:56,788 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 00:23:56,788 - __main__ - INFO - Training completed in 76.28s\n2025-12-03 00:23:56,788 - __main__ - INFO - Best validation accuracy: 0.2500\n2025-12-03 00:23:57,482 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/plots/training_history_20251203_002356.png\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-03 00:23:59,321 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/logs/classification_report_20251203_002359.json\n2025-12-03 00:23:59,321 - __main__ - INFO - Classification Results:\n2025-12-03 00:23:59,321 - __main__ - INFO -   Class 1: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-03 00:23:59,321 - __main__ - INFO -   Class 4: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-03 00:23:59,321 - __main__ - INFO -   Class 6: Precision=0.000, Recall=0.000, F1=0.000\n2025-12-03 00:23:59,321 - __main__ - INFO -   Class 12: Precision=0.250, Recall=1.000, F1=0.400\n2025-12-03 00:23:59,539 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/plots/confusion_matrix_20251203_002359.png\n2025-12-03 00:23:59,541 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 00:23:59,541 - __main__ - INFO - Evaluating on test set...\n2025-12-03 00:23:59,541 - __main__ - INFO - Loading test dataset...\n2025-12-03 00:23:59,541 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 00:23:59,910 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 00:24:00,155 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 00:24:00,674 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 00:24:00,705 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 00:24:00,713 - __main__ - INFO - Loaded 22857 test patches in 1.17s\n2025-12-03 00:24:00,716 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 00:24:00,716 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 00:24:00,716 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 00:24:00,717 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 00:24:00,720 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 00:24:00,723 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 00:24:00,725 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 00:24:00,759 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:24:00,781 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 00:24:00,781 - __main__ - INFO - Total available patches: 8936\n2025-12-03 00:24:00,781 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 00:24:02,620 - __main__ - INFO - Test Results: Loss=1.386298, Accuracy=0.2500\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n/home/davideidmann/.cache/pypoetry/virtualenvs/lc-specific-speckle-analysis-KaNOSvWU-py3.12/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", result.shape[0])\n2025-12-03 00:24:02,640 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/logs/test_classification_report_20251203_002402.json\n2025-12-03 00:24:02,844 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/plots/test_confusion_matrix_20251203_002402.png\n2025-12-03 00:24:02,879 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/training_summary_20251203_002402.json\n2025-12-03 00:24:02,883 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/latest_results.txt\n2025-12-03 00:24:02,883 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 00:24:02,883 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d4b873ed/training_summary_20251203_002402.json\n2025-12-03 00:24:02,883 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 301488/27408 = 11.0000 (1100.00%)\n2025-12-03 00:24:02,883 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.2500, Test Acc=0.2500\n",
      "return_code": 0
    },
    "config_zeromean_quantiles": {
      "config_name": "config_zeromean_quantiles",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_quantiles.conf",
      "start_time": 1764721449.2475486,
      "status": "success",
      "duration": 2493.9639823436737,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 00:24:11,743 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 00:24:11,743 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_quantiles.conf\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=False, quantiles=True, aggregation=None\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 00:24:11,745 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 00:24:11,746 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 00:24:11,746 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 00:24:11,746 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-03 00:24:11,746 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_quantiles.conf\n2025-12-03 00:24:11,746 - __main__ - INFO - Training Configuration:\n2025-12-03 00:24:11,746 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 00:24:11,746 - __main__ - INFO -   Patch size: 10\n2025-12-03 00:24:11,746 - __main__ - INFO -   Batch size: 32\n2025-12-03 00:24:11,746 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-03 00:24:11,746 - __main__ - INFO -   Optimizer: adam\n2025-12-03 00:24:12,399 - __main__ - INFO - Using device: cuda\n2025-12-03 00:24:12,401 - __main__ - INFO - Using config hash: bf39702c\n2025-12-03 00:24:12,402 - __main__ - INFO - Using run ID: bf39702c\n2025-12-03 00:24:12,402 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c\n2025-12-03 00:24:12,411 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/config_bf39702c.json\n2025-12-03 00:24:12,416 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-03 00:24:12,420 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-03 00:24:13,596 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-03 00:24:13,814 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-03 00:24:13,824 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/plots/model_summary_test_conv2d_n2.txt\n2025-12-03 00:24:13,824 - __main__ - INFO - Preparing data...\n2025-12-03 00:24:13,824 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 00:24:13,824 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 00:24:13,825 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 00:24:25,206 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 00:24:25,206 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 00:24:25,207 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 00:24:25,784 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 00:24:26,813 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 00:24:26,814 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 00:24:26,820 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 00:24:26,820 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 00:24:26,824 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 00:24:26,824 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 00:24:26,824 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 00:24:26,824 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 00:24:26,826 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 00:24:26,827 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 00:24:26,844 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 00:24:26,844 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 00:24:26,845 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 00:24:26,845 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 00:24:26,851 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 00:24:26,851 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 00:24:26,851 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 00:24:26,855 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 00:24:26,855 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 00:24:26,855 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 00:24:26,859 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 00:24:26,859 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 00:24:26,859 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 00:24:26,863 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 00:24:26,863 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 00:24:26,873 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:24:26,875 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 00:24:26,886 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 00:24:26,889 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 00:24:26,889 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 00:24:26,890 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 00:24:26,891 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 00:24:26,900 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 00:24:26,903 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 00:24:26,913 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 00:24:26,916 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 00:24:26,927 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 00:24:26,928 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 00:24:26,935 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 00:24:26,936 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 00:24:26,936 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 00:24:26,936 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 00:24:26,936 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 00:24:26,936 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 00:24:26,936 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 00:24:26,937 - __main__ - INFO - Loading train dataset...\n2025-12-03 00:24:26,937 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 00:24:27,088 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 00:24:28,038 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 00:24:28,570 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 00:24:28,632 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 00:24:28,648 - __main__ - INFO - Loaded 67828 train patches in 1.71s\n2025-12-03 00:24:28,651 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 00:24:28,651 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 00:24:28,651 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 00:24:28,655 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 00:24:28,662 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 00:24:28,667 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 00:24:28,674 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 00:24:28,738 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:24:28,801 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 00:24:28,801 - __main__ - INFO - Total available patches: 27408\n2025-12-03 00:24:28,801 - __main__ - INFO - Loading validation dataset...\n2025-12-03 00:24:28,801 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 00:24:28,815 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 00:24:29,170 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 00:24:29,263 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 00:24:29,283 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 00:24:29,287 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-03 00:24:29,288 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 00:24:29,288 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 00:24:29,289 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 00:24:29,290 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 00:24:29,292 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 00:24:29,294 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 00:24:29,296 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 00:24:29,315 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:24:29,331 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 00:24:29,331 - __main__ - INFO - Total available patches: 8572\n2025-12-03 00:24:29,331 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 00:24:29,331 - __main__ - INFO - Training batches: 857\n2025-12-03 00:24:29,331 - __main__ - INFO - Validation batches: 268\n2025-12-03 00:24:29,331 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 00:24:29,331 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 00:25:51,739 - __main__ - INFO - Epoch 1/50 (82.41s): Train Loss: 1.261619, Train Acc: 0.3870, Val Loss: 1.231755, Val Acc: 0.4213\n2025-12-03 00:25:51,752 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_1.pth\n2025-12-03 00:25:51,752 - __main__ - INFO - New best validation accuracy: 0.4213\n2025-12-03 00:27:15,759 - __main__ - INFO - Epoch 2/50 (84.01s): Train Loss: 1.209514, Train Acc: 0.4127, Val Loss: 1.218048, Val Acc: 0.4216\n2025-12-03 00:27:15,771 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_2.pth\n2025-12-03 00:27:15,771 - __main__ - INFO - New best validation accuracy: 0.4216\n2025-12-03 00:28:38,689 - __main__ - INFO - Epoch 3/50 (82.92s): Train Loss: 1.203115, Train Acc: 0.4221, Val Loss: 1.237813, Val Acc: 0.4232\n2025-12-03 00:28:38,701 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_3.pth\n2025-12-03 00:28:38,701 - __main__ - INFO - New best validation accuracy: 0.4232\n2025-12-03 00:30:01,327 - __main__ - INFO - Epoch 4/50 (82.63s): Train Loss: 1.194735, Train Acc: 0.4252, Val Loss: 1.237155, Val Acc: 0.4158\n2025-12-03 00:31:32,324 - __main__ - INFO - Epoch 5/50 (91.00s): Train Loss: 1.193809, Train Acc: 0.4263, Val Loss: 1.313652, Val Acc: 0.3987\n2025-12-03 00:33:06,441 - __main__ - INFO - Epoch 6/50 (94.12s): Train Loss: 1.192472, Train Acc: 0.4236, Val Loss: 1.206594, Val Acc: 0.4011\n2025-12-03 00:34:38,289 - __main__ - INFO - Epoch 7/50 (91.85s): Train Loss: 1.192982, Train Acc: 0.4252, Val Loss: 1.175784, Val Acc: 0.4451\n2025-12-03 00:34:38,298 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_7.pth\n2025-12-03 00:34:38,298 - __main__ - INFO - New best validation accuracy: 0.4451\n2025-12-03 00:36:01,103 - __main__ - INFO - Epoch 8/50 (82.81s): Train Loss: 1.191396, Train Acc: 0.4285, Val Loss: 1.183096, Val Acc: 0.4323\n2025-12-03 00:37:23,592 - __main__ - INFO - Epoch 9/50 (82.49s): Train Loss: 1.188284, Train Acc: 0.4306, Val Loss: 1.181350, Val Acc: 0.4417\n2025-12-03 00:38:45,993 - __main__ - INFO - Epoch 10/50 (82.40s): Train Loss: 1.188057, Train Acc: 0.4291, Val Loss: 1.177021, Val Acc: 0.4299\n2025-12-03 00:38:46,001 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/checkpoint_epoch_10.pth\n2025-12-03 00:40:08,109 - __main__ - INFO - Epoch 11/50 (82.11s): Train Loss: 1.188464, Train Acc: 0.4299, Val Loss: 1.175909, Val Acc: 0.4439\n2025-12-03 00:41:30,281 - __main__ - INFO - Epoch 12/50 (82.17s): Train Loss: 1.188029, Train Acc: 0.4290, Val Loss: 1.175610, Val Acc: 0.4455\n2025-12-03 00:41:30,290 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_12.pth\n2025-12-03 00:41:30,290 - __main__ - INFO - New best validation accuracy: 0.4455\n2025-12-03 00:42:53,344 - __main__ - INFO - Epoch 13/50 (83.05s): Train Loss: 1.188456, Train Acc: 0.4305, Val Loss: 1.191721, Val Acc: 0.4309\n2025-12-03 00:44:16,173 - __main__ - INFO - Epoch 14/50 (82.83s): Train Loss: 1.186418, Train Acc: 0.4316, Val Loss: 1.174504, Val Acc: 0.4402\n2025-12-03 00:45:40,020 - __main__ - INFO - Epoch 15/50 (83.85s): Train Loss: 1.185714, Train Acc: 0.4312, Val Loss: 1.183009, Val Acc: 0.4333\n2025-12-03 00:47:02,484 - __main__ - INFO - Epoch 16/50 (82.46s): Train Loss: 1.181474, Train Acc: 0.4332, Val Loss: 1.192855, Val Acc: 0.4365\n2025-12-03 00:48:25,312 - __main__ - INFO - Epoch 17/50 (82.83s): Train Loss: 1.178039, Train Acc: 0.4367, Val Loss: 1.169621, Val Acc: 0.4354\n2025-12-03 00:49:48,284 - __main__ - INFO - Epoch 18/50 (82.97s): Train Loss: 1.179459, Train Acc: 0.4361, Val Loss: 1.169280, Val Acc: 0.4489\n2025-12-03 00:49:48,293 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_18.pth\n2025-12-03 00:49:48,293 - __main__ - INFO - New best validation accuracy: 0.4489\n2025-12-03 00:51:10,634 - __main__ - INFO - Epoch 19/50 (82.34s): Train Loss: 1.178035, Train Acc: 0.4391, Val Loss: 1.167664, Val Acc: 0.4531\n2025-12-03 00:51:10,642 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/best_model_epoch_19.pth\n2025-12-03 00:51:10,643 - __main__ - INFO - New best validation accuracy: 0.4531\n2025-12-03 00:52:33,562 - __main__ - INFO - Epoch 20/50 (82.92s): Train Loss: 1.176480, Train Acc: 0.4432, Val Loss: 1.168431, Val Acc: 0.4495\n2025-12-03 00:52:33,571 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/models/checkpoint_epoch_20.pth\n2025-12-03 00:53:55,755 - __main__ - INFO - Epoch 21/50 (82.18s): Train Loss: 1.178458, Train Acc: 0.4358, Val Loss: 1.166021, Val Acc: 0.4480\n2025-12-03 00:55:19,334 - __main__ - INFO - Epoch 22/50 (83.58s): Train Loss: 1.174754, Train Acc: 0.4419, Val Loss: 1.167768, Val Acc: 0.4363\n2025-12-03 00:56:42,478 - __main__ - INFO - Epoch 23/50 (83.14s): Train Loss: 1.174142, Train Acc: 0.4417, Val Loss: 1.161563, Val Acc: 0.4525\n2025-12-03 00:58:05,196 - __main__ - INFO - Epoch 24/50 (82.72s): Train Loss: 1.171478, Train Acc: 0.4460, Val Loss: 1.171414, Val Acc: 0.4502\n2025-12-03 00:59:28,308 - __main__ - INFO - Epoch 25/50 (83.11s): Train Loss: 1.171513, Train Acc: 0.4463, Val Loss: 1.161131, Val Acc: 0.4487\n2025-12-03 01:00:51,074 - __main__ - INFO - Epoch 26/50 (82.77s): Train Loss: 1.172031, Train Acc: 0.4417, Val Loss: 1.190901, Val Acc: 0.4220\n2025-12-03 01:02:13,610 - __main__ - INFO - Epoch 27/50 (82.54s): Train Loss: 1.169539, Train Acc: 0.4465, Val Loss: 1.157898, Val Acc: 0.4494\n2025-12-03 01:03:35,975 - __main__ - INFO - Epoch 28/50 (82.36s): Train Loss: 1.167530, Train Acc: 0.4479, Val Loss: 1.172139, Val Acc: 0.4308\n2025-12-03 01:04:58,364 - __main__ - INFO - Epoch 29/50 (82.39s): Train Loss: 1.170165, Train Acc: 0.4444, Val Loss: 1.156988, Val Acc: 0.4502\n2025-12-03 01:04:58,365 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 01:04:58,365 - __main__ - INFO - Training completed in 2429.03s\n2025-12-03 01:04:58,365 - __main__ - INFO - Best validation accuracy: 0.4531\n2025-12-03 01:04:59,086 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/plots/training_history_20251203_010458.png\n2025-12-03 01:05:18,909 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/logs/classification_report_20251203_010518.json\n2025-12-03 01:05:18,909 - __main__ - INFO - Classification Results:\n2025-12-03 01:05:18,909 - __main__ - INFO -   Class 1: Precision=0.432, Recall=0.517, F1=0.471\n2025-12-03 01:05:18,909 - __main__ - INFO -   Class 4: Precision=0.464, Recall=0.785, F1=0.584\n2025-12-03 01:05:18,909 - __main__ - INFO -   Class 6: Precision=0.429, Recall=0.285, F1=0.343\n2025-12-03 01:05:18,909 - __main__ - INFO -   Class 12: Precision=0.476, Recall=0.213, F1=0.295\n2025-12-03 01:05:19,151 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/plots/confusion_matrix_20251203_010518.png\n2025-12-03 01:05:19,152 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 01:05:19,152 - __main__ - INFO - Evaluating on test set...\n2025-12-03 01:05:19,152 - __main__ - INFO - Loading test dataset...\n2025-12-03 01:05:19,152 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 01:05:19,187 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 01:05:20,381 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 01:05:20,506 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 01:05:20,542 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 01:05:20,549 - __main__ - INFO - Loaded 22857 test patches in 1.40s\n2025-12-03 01:05:20,551 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 01:05:20,551 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 01:05:20,552 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 01:05:20,553 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 01:05:20,556 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 01:05:20,558 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 01:05:20,560 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 01:05:20,591 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:05:20,614 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:05:20,614 - __main__ - INFO - Total available patches: 8936\n2025-12-03 01:05:20,614 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 01:05:41,439 - __main__ - INFO - Test Results: Loss=1.157410, Accuracy=0.4416\n2025-12-03 01:05:41,461 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/logs/test_classification_report_20251203_010541.json\n2025-12-03 01:05:41,699 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/plots/test_confusion_matrix_20251203_010541.png\n2025-12-03 01:05:41,751 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/training_summary_20251203_010541.json\n2025-12-03 01:05:41,755 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/latest_results.txt\n2025-12-03 01:05:41,755 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 01:05:41,755 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bf39702c/training_summary_20251203_010541.json\n2025-12-03 01:05:41,755 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 794832/27408 = 29.0000 (2900.00%)\n2025-12-03 01:05:41,755 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4531, Test Acc=0.4416\n",
      "return_code": 0
    },
    "config_zeromean_shuffled": {
      "config_name": "config_zeromean_shuffled",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_shuffled.conf",
      "start_time": 1764723948.2229087,
      "status": "success",
      "duration": 112.94417572021484,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 01:05:50,578 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 01:05:50,578 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_shuffled.conf\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=True, zero_mean=True, normalized=False, quantiles=False, aggregation=None\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 01:05:50,581 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-03 01:05:50,581 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_shuffled.conf\n2025-12-03 01:05:50,581 - __main__ - INFO - Training Configuration:\n2025-12-03 01:05:50,581 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 01:05:50,581 - __main__ - INFO -   Patch size: 10\n2025-12-03 01:05:50,581 - __main__ - INFO -   Batch size: 32\n2025-12-03 01:05:50,581 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-03 01:05:50,581 - __main__ - INFO -   Optimizer: adam\n2025-12-03 01:05:51,079 - __main__ - INFO - Using device: cuda\n2025-12-03 01:05:51,082 - __main__ - INFO - Using config hash: 9c003a06\n2025-12-03 01:05:51,082 - __main__ - INFO - Using run ID: 9c003a06\n2025-12-03 01:05:51,082 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06\n2025-12-03 01:05:51,090 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/config_9c003a06.json\n2025-12-03 01:05:51,094 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-03 01:05:51,097 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-03 01:05:51,098 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-03 01:05:52,100 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-03 01:05:52,311 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-03 01:05:52,321 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/plots/model_summary_test_conv2d_n2.txt\n2025-12-03 01:05:52,321 - __main__ - INFO - Preparing data...\n2025-12-03 01:05:52,321 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 01:05:52,321 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 01:05:52,322 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 01:06:03,567 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 01:06:03,567 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 01:06:03,568 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 01:06:04,153 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 01:06:05,204 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 01:06:05,204 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 01:06:05,210 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 01:06:05,210 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 01:06:05,214 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 01:06:05,214 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 01:06:05,214 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 01:06:05,215 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 01:06:05,217 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 01:06:05,218 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 01:06:05,235 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 01:06:05,235 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 01:06:05,236 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 01:06:05,236 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 01:06:05,241 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 01:06:05,241 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 01:06:05,241 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 01:06:05,245 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 01:06:05,245 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 01:06:05,246 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 01:06:05,249 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 01:06:05,249 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 01:06:05,250 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 01:06:05,253 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 01:06:05,253 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 01:06:05,264 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 01:06:05,266 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 01:06:05,277 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 01:06:05,280 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 01:06:05,280 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 01:06:05,281 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 01:06:05,282 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 01:06:05,291 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 01:06:05,293 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 01:06:05,303 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 01:06:05,307 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 01:06:05,318 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 01:06:05,318 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 01:06:05,318 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 01:06:05,318 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 01:06:05,318 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 01:06:05,318 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 01:06:05,319 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 01:06:05,319 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 01:06:05,325 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 01:06:05,326 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 01:06:05,326 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 01:06:05,326 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 01:06:05,326 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 01:06:05,327 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 01:06:05,327 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 01:06:05,327 - __main__ - INFO - Loading train dataset...\n2025-12-03 01:06:05,327 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 01:06:05,479 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 01:06:06,434 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 01:06:06,970 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 01:06:07,033 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 01:06:07,049 - __main__ - INFO - Loaded 67828 train patches in 1.72s\n2025-12-03 01:06:07,052 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 01:06:07,052 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 01:06:07,052 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 01:06:07,056 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 01:06:07,063 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 01:06:07,069 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 01:06:07,075 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 01:06:07,140 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 01:06:07,205 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 01:06:07,205 - __main__ - INFO - Total available patches: 27408\n2025-12-03 01:06:07,205 - __main__ - INFO - Loading validation dataset...\n2025-12-03 01:06:07,205 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 01:06:07,219 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 01:06:07,581 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 01:06:07,675 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 01:06:07,694 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 01:06:07,699 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-03 01:06:07,700 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 01:06:07,700 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 01:06:07,700 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 01:06:07,701 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 01:06:07,703 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 01:06:07,705 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 01:06:07,707 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 01:06:07,727 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 01:06:07,744 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 01:06:07,744 - __main__ - INFO - Total available patches: 8572\n2025-12-03 01:06:07,744 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 01:06:07,744 - __main__ - INFO - Training batches: 857\n2025-12-03 01:06:07,744 - __main__ - INFO - Validation batches: 268\n2025-12-03 01:06:07,744 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 01:06:07,744 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 01:06:11,359 - __main__ - INFO - Epoch 1/50 (3.61s): Train Loss: 1.108231, Train Acc: 0.5131, Val Loss: 0.993906, Val Acc: 0.5793\n2025-12-03 01:06:11,369 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_1.pth\n2025-12-03 01:06:11,369 - __main__ - INFO - New best validation accuracy: 0.5793\n2025-12-03 01:06:14,509 - __main__ - INFO - Epoch 2/50 (3.14s): Train Loss: 1.021211, Train Acc: 0.5644, Val Loss: 0.957269, Val Acc: 0.5962\n2025-12-03 01:06:14,518 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_2.pth\n2025-12-03 01:06:14,518 - __main__ - INFO - New best validation accuracy: 0.5962\n2025-12-03 01:06:17,683 - __main__ - INFO - Epoch 3/50 (3.17s): Train Loss: 1.016156, Train Acc: 0.5638, Val Loss: 0.948508, Val Acc: 0.5986\n2025-12-03 01:06:17,691 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_3.pth\n2025-12-03 01:06:17,691 - __main__ - INFO - New best validation accuracy: 0.5986\n2025-12-03 01:06:20,926 - __main__ - INFO - Epoch 4/50 (3.23s): Train Loss: 1.012596, Train Acc: 0.5664, Val Loss: 0.948971, Val Acc: 0.5973\n2025-12-03 01:06:24,176 - __main__ - INFO - Epoch 5/50 (3.25s): Train Loss: 1.001242, Train Acc: 0.5748, Val Loss: 0.952450, Val Acc: 0.5981\n2025-12-03 01:06:27,409 - __main__ - INFO - Epoch 6/50 (3.23s): Train Loss: 1.002500, Train Acc: 0.5708, Val Loss: 0.943006, Val Acc: 0.5989\n2025-12-03 01:06:27,417 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_6.pth\n2025-12-03 01:06:27,417 - __main__ - INFO - New best validation accuracy: 0.5989\n2025-12-03 01:06:30,810 - __main__ - INFO - Epoch 7/50 (3.39s): Train Loss: 1.002889, Train Acc: 0.5726, Val Loss: 0.945296, Val Acc: 0.6011\n2025-12-03 01:06:30,817 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_7.pth\n2025-12-03 01:06:30,817 - __main__ - INFO - New best validation accuracy: 0.6011\n2025-12-03 01:06:34,040 - __main__ - INFO - Epoch 8/50 (3.22s): Train Loss: 0.994405, Train Acc: 0.5784, Val Loss: 0.936630, Val Acc: 0.6064\n2025-12-03 01:06:34,048 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_8.pth\n2025-12-03 01:06:34,049 - __main__ - INFO - New best validation accuracy: 0.6064\n2025-12-03 01:06:37,319 - __main__ - INFO - Epoch 9/50 (3.27s): Train Loss: 0.994033, Train Acc: 0.5766, Val Loss: 0.928131, Val Acc: 0.6092\n2025-12-03 01:06:37,328 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_9.pth\n2025-12-03 01:06:37,328 - __main__ - INFO - New best validation accuracy: 0.6092\n2025-12-03 01:06:40,726 - __main__ - INFO - Epoch 10/50 (3.40s): Train Loss: 0.993476, Train Acc: 0.5749, Val Loss: 0.942222, Val Acc: 0.6000\n2025-12-03 01:06:40,734 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/checkpoint_epoch_10.pth\n2025-12-03 01:06:43,946 - __main__ - INFO - Epoch 11/50 (3.21s): Train Loss: 0.992792, Train Acc: 0.5772, Val Loss: 0.932059, Val Acc: 0.6093\n2025-12-03 01:06:43,954 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_11.pth\n2025-12-03 01:06:43,954 - __main__ - INFO - New best validation accuracy: 0.6093\n2025-12-03 01:06:47,209 - __main__ - INFO - Epoch 12/50 (3.25s): Train Loss: 0.994863, Train Acc: 0.5762, Val Loss: 0.934297, Val Acc: 0.6050\n2025-12-03 01:06:50,438 - __main__ - INFO - Epoch 13/50 (3.23s): Train Loss: 0.989028, Train Acc: 0.5758, Val Loss: 0.929944, Val Acc: 0.6098\n2025-12-03 01:06:50,447 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_13.pth\n2025-12-03 01:06:50,447 - __main__ - INFO - New best validation accuracy: 0.6098\n2025-12-03 01:06:53,646 - __main__ - INFO - Epoch 14/50 (3.20s): Train Loss: 0.987942, Train Acc: 0.5799, Val Loss: 0.928319, Val Acc: 0.6097\n2025-12-03 01:06:56,901 - __main__ - INFO - Epoch 15/50 (3.26s): Train Loss: 0.991380, Train Acc: 0.5782, Val Loss: 0.944199, Val Acc: 0.6011\n2025-12-03 01:07:00,192 - __main__ - INFO - Epoch 16/50 (3.29s): Train Loss: 0.985372, Train Acc: 0.5820, Val Loss: 0.937704, Val Acc: 0.6028\n2025-12-03 01:07:03,485 - __main__ - INFO - Epoch 17/50 (3.29s): Train Loss: 0.987339, Train Acc: 0.5789, Val Loss: 0.927071, Val Acc: 0.6129\n2025-12-03 01:07:03,493 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/best_model_epoch_17.pth\n2025-12-03 01:07:03,493 - __main__ - INFO - New best validation accuracy: 0.6129\n2025-12-03 01:07:06,817 - __main__ - INFO - Epoch 18/50 (3.32s): Train Loss: 0.983929, Train Acc: 0.5793, Val Loss: 0.929821, Val Acc: 0.6076\n2025-12-03 01:07:10,060 - __main__ - INFO - Epoch 19/50 (3.24s): Train Loss: 0.984808, Train Acc: 0.5834, Val Loss: 0.929043, Val Acc: 0.6123\n2025-12-03 01:07:13,297 - __main__ - INFO - Epoch 20/50 (3.24s): Train Loss: 0.985103, Train Acc: 0.5801, Val Loss: 0.934028, Val Acc: 0.6072\n2025-12-03 01:07:13,305 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/models/checkpoint_epoch_20.pth\n2025-12-03 01:07:16,555 - __main__ - INFO - Epoch 21/50 (3.25s): Train Loss: 0.986017, Train Acc: 0.5814, Val Loss: 0.927105, Val Acc: 0.6067\n2025-12-03 01:07:19,722 - __main__ - INFO - Epoch 22/50 (3.17s): Train Loss: 0.985707, Train Acc: 0.5809, Val Loss: 0.926674, Val Acc: 0.6106\n2025-12-03 01:07:23,100 - __main__ - INFO - Epoch 23/50 (3.38s): Train Loss: 0.986217, Train Acc: 0.5826, Val Loss: 0.923782, Val Acc: 0.6118\n2025-12-03 01:07:26,330 - __main__ - INFO - Epoch 24/50 (3.23s): Train Loss: 0.983037, Train Acc: 0.5838, Val Loss: 0.926576, Val Acc: 0.6101\n2025-12-03 01:07:29,574 - __main__ - INFO - Epoch 25/50 (3.24s): Train Loss: 0.985169, Train Acc: 0.5814, Val Loss: 0.921202, Val Acc: 0.6108\n2025-12-03 01:07:32,849 - __main__ - INFO - Epoch 26/50 (3.28s): Train Loss: 0.986301, Train Acc: 0.5791, Val Loss: 0.924293, Val Acc: 0.6122\n2025-12-03 01:07:36,050 - __main__ - INFO - Epoch 27/50 (3.20s): Train Loss: 0.984997, Train Acc: 0.5817, Val Loss: 0.926200, Val Acc: 0.6093\n2025-12-03 01:07:36,051 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 01:07:36,051 - __main__ - INFO - Training completed in 88.31s\n2025-12-03 01:07:36,051 - __main__ - INFO - Best validation accuracy: 0.6129\n2025-12-03 01:07:36,749 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/plots/training_history_20251203_010736.png\n2025-12-03 01:07:37,722 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/logs/classification_report_20251203_010737.json\n2025-12-03 01:07:37,722 - __main__ - INFO - Classification Results:\n2025-12-03 01:07:37,722 - __main__ - INFO -   Class 1: Precision=0.541, Recall=0.328, F1=0.408\n2025-12-03 01:07:37,722 - __main__ - INFO -   Class 4: Precision=0.713, Recall=0.731, F1=0.722\n2025-12-03 01:07:37,722 - __main__ - INFO -   Class 6: Precision=0.583, Recall=0.802, F1=0.675\n2025-12-03 01:07:37,722 - __main__ - INFO -   Class 12: Precision=0.580, Recall=0.576, F1=0.578\n2025-12-03 01:07:37,960 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/plots/confusion_matrix_20251203_010737.png\n2025-12-03 01:07:37,961 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 01:07:37,961 - __main__ - INFO - Evaluating on test set...\n2025-12-03 01:07:37,961 - __main__ - INFO - Loading test dataset...\n2025-12-03 01:07:37,961 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 01:07:37,974 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 01:07:38,387 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 01:07:38,482 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 01:07:38,505 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 01:07:38,509 - __main__ - INFO - Loaded 22857 test patches in 0.55s\n2025-12-03 01:07:38,512 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 01:07:38,512 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 01:07:38,512 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 01:07:38,513 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 01:07:38,515 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 01:07:38,517 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 01:07:38,519 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 01:07:38,538 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:07:38,552 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:07:38,552 - __main__ - INFO - Total available patches: 8936\n2025-12-03 01:07:38,552 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 01:07:39,543 - __main__ - INFO - Test Results: Loss=0.932063, Accuracy=0.6072\n2025-12-03 01:07:39,562 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/logs/test_classification_report_20251203_010739.json\n2025-12-03 01:07:39,798 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/plots/test_confusion_matrix_20251203_010739.png\n2025-12-03 01:07:39,840 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/training_summary_20251203_010739.json\n2025-12-03 01:07:39,843 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/latest_results.txt\n2025-12-03 01:07:39,843 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 01:07:39,843 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_9c003a06/training_summary_20251203_010739.json\n2025-12-03 01:07:39,843 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 740016/27408 = 27.0000 (2700.00%)\n2025-12-03 01:07:39,843 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.6129, Test Acc=0.6072\n",
      "return_code": 0
    },
    "config_zeromean_std": {
      "config_name": "config_zeromean_std",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_std.conf",
      "start_time": 1764724066.1787243,
      "status": "success",
      "duration": 78.87590026855469,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 01:07:48,501 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 01:07:48,501 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_std.conf\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=False, quantiles=False, aggregation=std\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 01:07:48,503 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 01:07:48,504 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-03 01:07:48,504 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_std.conf\n2025-12-03 01:07:48,504 - __main__ - INFO - Training Configuration:\n2025-12-03 01:07:48,504 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 01:07:48,504 - __main__ - INFO -   Patch size: 10\n2025-12-03 01:07:48,504 - __main__ - INFO -   Batch size: 32\n2025-12-03 01:07:48,504 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-03 01:07:48,504 - __main__ - INFO -   Optimizer: adam\n2025-12-03 01:07:49,003 - __main__ - INFO - Using device: cuda\n2025-12-03 01:07:49,006 - __main__ - INFO - Using config hash: 1c5684d3\n2025-12-03 01:07:49,006 - __main__ - INFO - Using run ID: 1c5684d3\n2025-12-03 01:07:49,006 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3\n2025-12-03 01:07:49,016 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/config_1c5684d3.json\n2025-12-03 01:07:49,020 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 2\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-03 01:07:49,023 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 452\n2025-12-03 01:07:50,011 - __main__ - INFO - Model initialized with 452 parameters\n2025-12-03 01:07:50,096 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-03 01:07:50,097 - __main__ - WARNING - Could not create model summary: Expected 2 input features, got 200\n2025-12-03 01:07:50,097 - __main__ - INFO - Preparing data...\n2025-12-03 01:07:50,097 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 01:07:50,097 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 01:07:50,098 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 01:08:01,333 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 01:08:01,333 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 01:08:01,334 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 01:08:01,916 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 01:08:02,970 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 01:08:02,970 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 01:08:02,981 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 01:08:02,981 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 01:08:02,986 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 01:08:02,986 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 01:08:02,986 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 01:08:02,986 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 01:08:02,988 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 01:08:02,988 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 01:08:03,006 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 01:08:03,006 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 01:08:03,006 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 01:08:03,006 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 01:08:03,011 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 01:08:03,011 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 01:08:03,011 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 01:08:03,015 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 01:08:03,015 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 01:08:03,015 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 01:08:03,019 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 01:08:03,019 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 01:08:03,019 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 01:08:03,023 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 01:08:03,023 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 01:08:03,033 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 01:08:03,035 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 01:08:03,046 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 01:08:03,049 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 01:08:03,049 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 01:08:03,050 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 01:08:03,050 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 01:08:03,059 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 01:08:03,062 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 01:08:03,072 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 01:08:03,076 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 01:08:03,087 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 01:08:03,087 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 01:08:03,087 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 01:08:03,087 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 01:08:03,087 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 01:08:03,087 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 01:08:03,088 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 01:08:03,088 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 01:08:03,094 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 01:08:03,095 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 01:08:03,095 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 01:08:03,095 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 01:08:03,095 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 01:08:03,095 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 01:08:03,095 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 01:08:03,096 - __main__ - INFO - Loading train dataset...\n2025-12-03 01:08:03,096 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 01:08:03,247 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 01:08:04,192 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 01:08:04,718 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 01:08:04,781 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 01:08:04,796 - __main__ - INFO - Loaded 67828 train patches in 1.70s\n2025-12-03 01:08:04,799 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 01:08:04,799 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 01:08:04,799 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 01:08:04,803 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 01:08:04,810 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 01:08:04,816 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 01:08:04,822 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 01:08:04,886 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 01:08:04,954 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 01:08:04,954 - __main__ - INFO - Total available patches: 27408\n2025-12-03 01:08:04,954 - __main__ - INFO - Loading validation dataset...\n2025-12-03 01:08:04,954 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 01:08:04,967 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 01:08:05,323 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 01:08:05,416 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 01:08:05,435 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 01:08:05,439 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-03 01:08:05,440 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 01:08:05,441 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 01:08:05,441 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 01:08:05,442 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 01:08:05,444 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 01:08:05,446 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 01:08:05,448 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 01:08:05,467 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 01:08:05,483 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 01:08:05,483 - __main__ - INFO - Total available patches: 8572\n2025-12-03 01:08:05,484 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 01:08:05,484 - __main__ - INFO - Training batches: 857\n2025-12-03 01:08:05,484 - __main__ - INFO - Validation batches: 268\n2025-12-03 01:08:05,484 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 01:08:05,484 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 01:08:09,386 - __main__ - INFO - Epoch 1/50 (3.90s): Train Loss: 1.356251, Train Acc: 0.3222, Val Loss: 1.281355, Val Acc: 0.4081\n2025-12-03 01:08:09,395 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/models/best_model_epoch_1.pth\n2025-12-03 01:08:09,395 - __main__ - INFO - New best validation accuracy: 0.4081\n2025-12-03 01:08:12,867 - __main__ - INFO - Epoch 2/50 (3.47s): Train Loss: 1.283087, Train Acc: 0.3874, Val Loss: 1.250922, Val Acc: 0.4222\n2025-12-03 01:08:12,874 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/models/best_model_epoch_2.pth\n2025-12-03 01:08:12,874 - __main__ - INFO - New best validation accuracy: 0.4222\n2025-12-03 01:08:16,326 - __main__ - INFO - Epoch 3/50 (3.45s): Train Loss: 1.269284, Train Acc: 0.3961, Val Loss: 1.248292, Val Acc: 0.4185\n2025-12-03 01:08:19,761 - __main__ - INFO - Epoch 4/50 (3.43s): Train Loss: 1.265442, Train Acc: 0.4033, Val Loss: 1.240961, Val Acc: 0.4231\n2025-12-03 01:08:19,768 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/models/best_model_epoch_4.pth\n2025-12-03 01:08:19,768 - __main__ - INFO - New best validation accuracy: 0.4231\n2025-12-03 01:08:23,540 - __main__ - INFO - Epoch 5/50 (3.77s): Train Loss: 1.262754, Train Acc: 0.4058, Val Loss: 1.239247, Val Acc: 0.4252\n2025-12-03 01:08:23,546 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/models/best_model_epoch_5.pth\n2025-12-03 01:08:23,546 - __main__ - INFO - New best validation accuracy: 0.4252\n2025-12-03 01:08:27,099 - __main__ - INFO - Epoch 6/50 (3.55s): Train Loss: 1.260011, Train Acc: 0.4074, Val Loss: 1.238500, Val Acc: 0.4221\n2025-12-03 01:08:30,644 - __main__ - INFO - Epoch 7/50 (3.54s): Train Loss: 1.260573, Train Acc: 0.4113, Val Loss: 1.239228, Val Acc: 0.4239\n2025-12-03 01:08:34,145 - __main__ - INFO - Epoch 8/50 (3.50s): Train Loss: 1.259443, Train Acc: 0.4102, Val Loss: 1.237419, Val Acc: 0.4242\n2025-12-03 01:08:37,764 - __main__ - INFO - Epoch 9/50 (3.62s): Train Loss: 1.258204, Train Acc: 0.4117, Val Loss: 1.237495, Val Acc: 0.4166\n2025-12-03 01:08:41,362 - __main__ - INFO - Epoch 10/50 (3.60s): Train Loss: 1.257436, Train Acc: 0.4115, Val Loss: 1.238079, Val Acc: 0.4214\n2025-12-03 01:08:41,369 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/models/checkpoint_epoch_10.pth\n2025-12-03 01:08:45,036 - __main__ - INFO - Epoch 11/50 (3.67s): Train Loss: 1.258531, Train Acc: 0.4083, Val Loss: 1.239328, Val Acc: 0.4188\n2025-12-03 01:08:48,539 - __main__ - INFO - Epoch 12/50 (3.50s): Train Loss: 1.257612, Train Acc: 0.4107, Val Loss: 1.236962, Val Acc: 0.4237\n2025-12-03 01:08:52,600 - __main__ - INFO - Epoch 13/50 (4.06s): Train Loss: 1.258478, Train Acc: 0.4086, Val Loss: 1.236313, Val Acc: 0.4227\n2025-12-03 01:08:56,111 - __main__ - INFO - Epoch 14/50 (3.51s): Train Loss: 1.256436, Train Acc: 0.4138, Val Loss: 1.236979, Val Acc: 0.4214\n2025-12-03 01:08:59,683 - __main__ - INFO - Epoch 15/50 (3.57s): Train Loss: 1.258088, Train Acc: 0.4090, Val Loss: 1.236886, Val Acc: 0.4182\n2025-12-03 01:08:59,683 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 01:08:59,683 - __main__ - INFO - Training completed in 54.20s\n2025-12-03 01:08:59,683 - __main__ - INFO - Best validation accuracy: 0.4252\n2025-12-03 01:09:00,392 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/plots/training_history_20251203_010859.png\n2025-12-03 01:09:01,416 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/logs/classification_report_20251203_010901.json\n2025-12-03 01:09:01,416 - __main__ - INFO - Classification Results:\n2025-12-03 01:09:01,416 - __main__ - INFO -   Class 1: Precision=0.377, Recall=0.253, F1=0.303\n2025-12-03 01:09:01,416 - __main__ - INFO -   Class 4: Precision=0.502, Recall=0.675, F1=0.576\n2025-12-03 01:09:01,416 - __main__ - INFO -   Class 6: Precision=0.369, Recall=0.592, F1=0.454\n2025-12-03 01:09:01,416 - __main__ - INFO -   Class 12: Precision=0.404, Recall=0.153, F1=0.222\n2025-12-03 01:09:01,653 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/plots/confusion_matrix_20251203_010901.png\n2025-12-03 01:09:01,654 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 01:09:01,654 - __main__ - INFO - Evaluating on test set...\n2025-12-03 01:09:01,654 - __main__ - INFO - Loading test dataset...\n2025-12-03 01:09:01,654 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 01:09:01,666 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 01:09:02,171 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 01:09:02,269 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 01:09:02,292 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 01:09:02,296 - __main__ - INFO - Loaded 22857 test patches in 0.64s\n2025-12-03 01:09:02,299 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 01:09:02,299 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 01:09:02,299 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 01:09:02,300 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 01:09:02,302 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 01:09:02,304 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 01:09:02,306 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 01:09:02,326 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:09:02,342 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:09:02,343 - __main__ - INFO - Total available patches: 8936\n2025-12-03 01:09:02,343 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 01:09:03,442 - __main__ - INFO - Test Results: Loss=1.252134, Accuracy=0.4126\n2025-12-03 01:09:03,469 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/logs/test_classification_report_20251203_010903.json\n2025-12-03 01:09:03,704 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/plots/test_confusion_matrix_20251203_010903.png\n2025-12-03 01:09:03,743 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/training_summary_20251203_010903.json\n2025-12-03 01:09:03,746 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/latest_results.txt\n2025-12-03 01:09:03,746 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 01:09:03,746 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_1c5684d3/training_summary_20251203_010903.json\n2025-12-03 01:09:03,746 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 411120/27408 = 15.0000 (1500.00%)\n2025-12-03 01:09:03,746 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4252, Test Acc=0.4126\n",
      "return_code": 0
    },
    "config_zeromean_stdandmean": {
      "config_name": "config_zeromean_stdandmean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_stdandmean.conf",
      "start_time": 1764724150.0662482,
      "status": "success",
      "duration": 131.10384345054626,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-03 01:09:12,442 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-03 01:09:12,442 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_stdandmean.conf\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=True, normalized=False, quantiles=False, aggregation=stdandmean\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-03 01:09:12,445 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-03 01:09:12,446 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-03 01:09:12,446 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-03 01:09:12,446 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-03 01:09:12,446 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-03 01:09:12,446 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-03 01:09:12,446 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: linear_stats_net\n2025-12-03 01:09:12,446 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_zeromean_stdandmean.conf\n2025-12-03 01:09:12,446 - __main__ - INFO - Training Configuration:\n2025-12-03 01:09:12,446 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-03 01:09:12,446 - __main__ - INFO -   Patch size: 10\n2025-12-03 01:09:12,446 - __main__ - INFO -   Batch size: 32\n2025-12-03 01:09:12,446 - __main__ - INFO -   Architecture: linear_stats_net\n2025-12-03 01:09:12,446 - __main__ - INFO -   Optimizer: adam\n2025-12-03 01:09:12,945 - __main__ - INFO - Using device: cuda\n2025-12-03 01:09:12,947 - __main__ - INFO - Using config hash: d15bc838\n2025-12-03 01:09:12,947 - __main__ - INFO - Using run ID: d15bc838\n2025-12-03 01:09:12,947 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838\n2025-12-03 01:09:12,956 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/config_d15bc838.json\n2025-12-03 01:09:12,960 - __main__ - INFO - Using requested statistical architecture: linear_stats_net\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO - LinearStatsNet initialized:\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Input features: 4\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Hidden size: 64\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Output classes: 4\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Dropout rate: 0.2\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Activation: relu\n2025-12-03 01:09:12,962 - src.lc_speckle_analysis.network_architectures.linear_stats_net - INFO -   - Total parameters: 580\n2025-12-03 01:09:13,977 - __main__ - INFO - Model initialized with 580 parameters\n2025-12-03 01:09:14,066 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/plots/network_structure_linear_stats_net.png/.pdf\n2025-12-03 01:09:14,067 - __main__ - WARNING - Could not create model summary: Expected 4 input features, got 200\n2025-12-03 01:09:14,067 - __main__ - INFO - Preparing data...\n2025-12-03 01:09:14,067 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-03 01:09:14,067 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-03 01:09:14,068 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-03 01:09:25,345 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-03 01:09:25,346 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-03 01:09:25,347 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-03 01:09:25,947 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-03 01:09:27,006 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-03 01:09:27,006 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-03 01:09:27,012 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-03 01:09:27,012 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-03 01:09:27,017 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-03 01:09:27,017 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-03 01:09:27,017 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-03 01:09:27,017 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-03 01:09:27,019 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-03 01:09:27,019 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-03 01:09:27,035 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-03 01:09:27,035 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-03 01:09:27,037 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-03 01:09:27,037 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-03 01:09:27,041 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-03 01:09:27,041 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-03 01:09:27,041 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-03 01:09:27,045 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-03 01:09:27,045 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-03 01:09:27,045 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-03 01:09:27,048 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-03 01:09:27,048 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-03 01:09:27,048 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-03 01:09:27,052 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-03 01:09:27,052 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-03 01:09:27,062 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-03 01:09:27,064 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-03 01:09:27,075 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-03 01:09:27,079 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-03 01:09:27,079 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-03 01:09:27,080 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-03 01:09:27,080 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-03 01:09:27,090 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-03 01:09:27,092 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-03 01:09:27,103 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-03 01:09:27,106 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-03 01:09:27,118 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-03 01:09:27,125 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-03 01:09:27,126 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-03 01:09:27,126 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-03 01:09:27,126 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-03 01:09:27,126 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-03 01:09:27,126 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-03 01:09:27,126 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-03 01:09:27,127 - __main__ - INFO - Loading train dataset...\n2025-12-03 01:09:27,127 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-03 01:09:27,277 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-03 01:09:28,229 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-03 01:09:28,758 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-03 01:09:28,821 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-03 01:09:28,836 - __main__ - INFO - Loaded 67828 train patches in 1.71s\n2025-12-03 01:09:28,839 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-03 01:09:28,839 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-03 01:09:28,839 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-03 01:09:28,843 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-03 01:09:28,850 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-03 01:09:28,856 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-03 01:09:28,862 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-03 01:09:28,927 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 01:09:28,997 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-03 01:09:28,997 - __main__ - INFO - Total available patches: 27408\n2025-12-03 01:09:28,997 - __main__ - INFO - Loading validation dataset...\n2025-12-03 01:09:28,997 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-03 01:09:29,010 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-03 01:09:29,364 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-03 01:09:29,458 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-03 01:09:29,476 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-03 01:09:29,481 - __main__ - INFO - Loaded 22192 validation patches in 0.48s\n2025-12-03 01:09:29,482 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-03 01:09:29,482 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-03 01:09:29,482 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-03 01:09:29,483 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-03 01:09:29,486 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-03 01:09:29,487 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-03 01:09:29,490 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-03 01:09:29,509 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 01:09:29,525 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-03 01:09:29,525 - __main__ - INFO - Total available patches: 8572\n2025-12-03 01:09:29,525 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-03 01:09:29,526 - __main__ - INFO - Training batches: 857\n2025-12-03 01:09:29,526 - __main__ - INFO - Validation batches: 268\n2025-12-03 01:09:29,526 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-03 01:09:29,526 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-03 01:09:33,555 - __main__ - INFO - Epoch 1/50 (4.03s): Train Loss: 1.368420, Train Acc: 0.3195, Val Loss: 1.289514, Val Acc: 0.4178\n2025-12-03 01:09:33,564 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/best_model_epoch_1.pth\n2025-12-03 01:09:33,564 - __main__ - INFO - New best validation accuracy: 0.4178\n2025-12-03 01:09:37,363 - __main__ - INFO - Epoch 2/50 (3.80s): Train Loss: 1.284523, Train Acc: 0.3862, Val Loss: 1.253992, Val Acc: 0.3962\n2025-12-03 01:09:41,066 - __main__ - INFO - Epoch 3/50 (3.70s): Train Loss: 1.268411, Train Acc: 0.4007, Val Loss: 1.246824, Val Acc: 0.4147\n2025-12-03 01:09:44,719 - __main__ - INFO - Epoch 4/50 (3.65s): Train Loss: 1.265084, Train Acc: 0.4022, Val Loss: 1.241724, Val Acc: 0.4188\n2025-12-03 01:09:44,726 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/best_model_epoch_4.pth\n2025-12-03 01:09:44,726 - __main__ - INFO - New best validation accuracy: 0.4188\n2025-12-03 01:09:48,668 - __main__ - INFO - Epoch 5/50 (3.94s): Train Loss: 1.262206, Train Acc: 0.4088, Val Loss: 1.242300, Val Acc: 0.4178\n2025-12-03 01:09:52,391 - __main__ - INFO - Epoch 6/50 (3.72s): Train Loss: 1.262269, Train Acc: 0.4082, Val Loss: 1.238186, Val Acc: 0.4222\n2025-12-03 01:09:52,398 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/best_model_epoch_6.pth\n2025-12-03 01:09:52,398 - __main__ - INFO - New best validation accuracy: 0.4222\n2025-12-03 01:09:56,086 - __main__ - INFO - Epoch 7/50 (3.69s): Train Loss: 1.261265, Train Acc: 0.4087, Val Loss: 1.238725, Val Acc: 0.4186\n2025-12-03 01:09:59,824 - __main__ - INFO - Epoch 8/50 (3.74s): Train Loss: 1.259010, Train Acc: 0.4090, Val Loss: 1.240011, Val Acc: 0.4201\n2025-12-03 01:10:03,476 - __main__ - INFO - Epoch 9/50 (3.65s): Train Loss: 1.259540, Train Acc: 0.4099, Val Loss: 1.239926, Val Acc: 0.4207\n2025-12-03 01:10:07,217 - __main__ - INFO - Epoch 10/50 (3.74s): Train Loss: 1.259468, Train Acc: 0.4092, Val Loss: 1.242147, Val Acc: 0.4154\n2025-12-03 01:10:07,224 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/checkpoint_epoch_10.pth\n2025-12-03 01:10:10,924 - __main__ - INFO - Epoch 11/50 (3.70s): Train Loss: 1.257721, Train Acc: 0.4104, Val Loss: 1.236688, Val Acc: 0.4200\n2025-12-03 01:10:14,965 - __main__ - INFO - Epoch 12/50 (4.04s): Train Loss: 1.257771, Train Acc: 0.4102, Val Loss: 1.235232, Val Acc: 0.4216\n2025-12-03 01:10:18,637 - __main__ - INFO - Epoch 13/50 (3.67s): Train Loss: 1.257774, Train Acc: 0.4116, Val Loss: 1.236113, Val Acc: 0.4230\n2025-12-03 01:10:18,644 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/best_model_epoch_13.pth\n2025-12-03 01:10:18,644 - __main__ - INFO - New best validation accuracy: 0.4230\n2025-12-03 01:10:22,352 - __main__ - INFO - Epoch 14/50 (3.71s): Train Loss: 1.257269, Train Acc: 0.4122, Val Loss: 1.246638, Val Acc: 0.4146\n2025-12-03 01:10:26,304 - __main__ - INFO - Epoch 15/50 (3.95s): Train Loss: 1.257613, Train Acc: 0.4100, Val Loss: 1.237233, Val Acc: 0.4195\n2025-12-03 01:10:30,334 - __main__ - INFO - Epoch 16/50 (4.03s): Train Loss: 1.258090, Train Acc: 0.4102, Val Loss: 1.237457, Val Acc: 0.4206\n2025-12-03 01:10:34,128 - __main__ - INFO - Epoch 17/50 (3.79s): Train Loss: 1.257925, Train Acc: 0.4096, Val Loss: 1.240237, Val Acc: 0.4201\n2025-12-03 01:10:37,853 - __main__ - INFO - Epoch 18/50 (3.73s): Train Loss: 1.256838, Train Acc: 0.4117, Val Loss: 1.235113, Val Acc: 0.4248\n2025-12-03 01:10:37,860 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/best_model_epoch_18.pth\n2025-12-03 01:10:37,860 - __main__ - INFO - New best validation accuracy: 0.4248\n2025-12-03 01:10:41,556 - __main__ - INFO - Epoch 19/50 (3.70s): Train Loss: 1.256742, Train Acc: 0.4112, Val Loss: 1.238355, Val Acc: 0.4178\n2025-12-03 01:10:45,337 - __main__ - INFO - Epoch 20/50 (3.78s): Train Loss: 1.257285, Train Acc: 0.4118, Val Loss: 1.235719, Val Acc: 0.4228\n2025-12-03 01:10:45,345 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/models/checkpoint_epoch_20.pth\n2025-12-03 01:10:49,427 - __main__ - INFO - Epoch 21/50 (4.08s): Train Loss: 1.256490, Train Acc: 0.4106, Val Loss: 1.236804, Val Acc: 0.4209\n2025-12-03 01:10:53,164 - __main__ - INFO - Epoch 22/50 (3.74s): Train Loss: 1.257590, Train Acc: 0.4096, Val Loss: 1.237316, Val Acc: 0.4189\n2025-12-03 01:10:57,010 - __main__ - INFO - Epoch 23/50 (3.85s): Train Loss: 1.256905, Train Acc: 0.4114, Val Loss: 1.238267, Val Acc: 0.4173\n2025-12-03 01:11:00,625 - __main__ - INFO - Epoch 24/50 (3.61s): Train Loss: 1.256524, Train Acc: 0.4125, Val Loss: 1.235954, Val Acc: 0.4213\n2025-12-03 01:11:04,412 - __main__ - INFO - Epoch 25/50 (3.79s): Train Loss: 1.257125, Train Acc: 0.4113, Val Loss: 1.237061, Val Acc: 0.4178\n2025-12-03 01:11:08,121 - __main__ - INFO - Epoch 26/50 (3.71s): Train Loss: 1.255973, Train Acc: 0.4097, Val Loss: 1.234797, Val Acc: 0.4243\n2025-12-03 01:11:11,792 - __main__ - INFO - Epoch 27/50 (3.67s): Train Loss: 1.257695, Train Acc: 0.4114, Val Loss: 1.239303, Val Acc: 0.4165\n2025-12-03 01:11:15,424 - __main__ - INFO - Epoch 28/50 (3.63s): Train Loss: 1.255892, Train Acc: 0.4110, Val Loss: 1.235490, Val Acc: 0.4215\n2025-12-03 01:11:15,424 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-03 01:11:15,424 - __main__ - INFO - Training completed in 105.90s\n2025-12-03 01:11:15,424 - __main__ - INFO - Best validation accuracy: 0.4248\n2025-12-03 01:11:16,124 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/plots/training_history_20251203_011115.png\n2025-12-03 01:11:17,238 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/logs/classification_report_20251203_011117.json\n2025-12-03 01:11:17,238 - __main__ - INFO - Classification Results:\n2025-12-03 01:11:17,238 - __main__ - INFO -   Class 1: Precision=0.381, Recall=0.292, F1=0.331\n2025-12-03 01:11:17,238 - __main__ - INFO -   Class 4: Precision=0.503, Recall=0.677, F1=0.577\n2025-12-03 01:11:17,238 - __main__ - INFO -   Class 6: Precision=0.370, Recall=0.562, F1=0.446\n2025-12-03 01:11:17,238 - __main__ - INFO -   Class 12: Precision=0.420, Recall=0.155, F1=0.227\n2025-12-03 01:11:17,477 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/plots/confusion_matrix_20251203_011117.png\n2025-12-03 01:11:17,478 - __main__ - INFO - Starting test set evaluation...\n2025-12-03 01:11:17,478 - __main__ - INFO - Evaluating on test set...\n2025-12-03 01:11:17,479 - __main__ - INFO - Loading test dataset...\n2025-12-03 01:11:17,479 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-03 01:11:17,490 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-03 01:11:18,050 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-03 01:11:18,149 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-03 01:11:18,172 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-03 01:11:18,176 - __main__ - INFO - Loaded 22857 test patches in 0.70s\n2025-12-03 01:11:18,178 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-03 01:11:18,178 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-03 01:11:18,178 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-03 01:11:18,180 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-03 01:11:18,182 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-03 01:11:18,184 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-03 01:11:18,186 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-03 01:11:18,205 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:11:18,224 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-03 01:11:18,224 - __main__ - INFO - Total available patches: 8936\n2025-12-03 01:11:18,224 - __main__ - INFO - Loaded 8936 test patches\n2025-12-03 01:11:19,377 - __main__ - INFO - Test Results: Loss=1.251977, Accuracy=0.4126\n2025-12-03 01:11:19,407 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/logs/test_classification_report_20251203_011119.json\n2025-12-03 01:11:19,646 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/plots/test_confusion_matrix_20251203_011119.png\n2025-12-03 01:11:19,684 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/training_summary_20251203_011119.json\n2025-12-03 01:11:19,688 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/latest_results.txt\n2025-12-03 01:11:19,688 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-03 01:11:19,688 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_d15bc838/training_summary_20251203_011119.json\n2025-12-03 01:11:19,688 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 767424/27408 = 28.0000 (2800.00%)\n2025-12-03 01:11:19,688 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.4248, Test Acc=0.4126\n",
      "return_code": 0
    }
  }
}