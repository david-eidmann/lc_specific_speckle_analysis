{
  "total_configs": 2,
  "successful": 1,
  "failed": 1,
  "success_rate": 50.0,
  "successful_configs": [
    "config_base"
  ],
  "failed_configs": [
    "config_base_mean"
  ],
  "detailed_results": {
    "config_base": {
      "config_name": "config_base",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base.conf",
      "start_time": 1764703263.411338,
      "status": "success",
      "duration": 72.30795955657959,
      "error_message": null,
      "stdout": "",
      "stderr": "2025-12-02 19:21:05,907 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 19:21:05,907 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base.conf\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=False, aggregation=None\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 19:21:05,909 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: test_conv2d_n2\n2025-12-02 19:21:05,909 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base.conf\n2025-12-02 19:21:05,909 - __main__ - INFO - Training Configuration:\n2025-12-02 19:21:05,909 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 19:21:05,909 - __main__ - INFO -   Patch size: 10\n2025-12-02 19:21:05,909 - __main__ - INFO -   Batch size: 32\n2025-12-02 19:21:05,909 - __main__ - INFO -   Architecture: test_conv2d_n2\n2025-12-02 19:21:05,909 - __main__ - INFO -   Optimizer: adam\n2025-12-02 19:21:06,411 - __main__ - INFO - Using device: cuda\n2025-12-02 19:21:06,414 - __main__ - INFO - Using config hash: 0f3b0fea\n2025-12-02 19:21:06,414 - __main__ - INFO - Using run ID: 0f3b0fea\n2025-12-02 19:21:06,414 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea\n2025-12-02 19:21:06,422 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/config_0f3b0fea.json\n2025-12-02 19:21:06,427 - __main__ - INFO - Using requested spatial architecture: test_conv2d_n2\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO - TestConv2D_N2 network initialized:\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Input size: 2\u00d710\u00d710\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Conv layers: 2\u21928\u219216 channels\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Kernel size: 3\u00d73 with padding=1\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Global average pooling: 16\u00d7H\u00d7W \u2192 16\u00d71\u00d71\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Output classes: 4\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Dropout rate: 0.2\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Total parameters: 1,436\n2025-12-02 19:21:06,430 - src.lc_speckle_analysis.network_architectures.test_conv2d_n2 - INFO -   Trainable parameters: 1,436\n2025-12-02 19:21:07,440 - __main__ - INFO - Model initialized with 1,436 parameters\n2025-12-02 19:21:07,647 - __main__ - INFO - Network structure saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/network_structure_test_conv2d_n2.png/.pdf\n2025-12-02 19:21:07,657 - __main__ - INFO - Model summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/model_summary_test_conv2d_n2.txt\n2025-12-02 19:21:07,657 - __main__ - INFO - Preparing data...\n2025-12-02 19:21:07,657 - src.lc_speckle_analysis.config - INFO - PatchYielder initialized with patch size: 10\n2025-12-02 19:21:07,657 - src.lc_speckle_analysis.config - INFO - Target EPSG: EPSG:32632\n2025-12-02 19:21:07,657 - src.lc_speckle_analysis.config - INFO - Loading processed training data from cache: processed_training_data_bb54014e_c02a_epsg32632.gpkg\n2025-12-02 19:21:18,783 - src.lc_speckle_analysis.config - INFO - Loaded 962908 polygons from cache\n2025-12-02 19:21:18,783 - src.lc_speckle_analysis.config - INFO - Buffering all polygons globally for minimum patch size requirements\n2025-12-02 19:21:18,784 - src.lc_speckle_analysis.config - INFO - Global buffer: inward 141.4m for minimum viable polygon size (patch size 10)\n2025-12-02 19:21:19,351 - src.lc_speckle_analysis.config - INFO - Loading globally filtered polygons from cache: global_filtered_polygons_NRW_2022_Niedersachsen_2022_patch10_epsg32632_1da55510.gpkg\n2025-12-02 19:21:20,361 - src.lc_speckle_analysis.config - INFO - Final polygon count for global processing: 11769\n2025-12-02 19:21:20,361 - src.lc_speckle_analysis.config - INFO - Finding VV/VH image pairs\n2025-12-02 19:21:20,367 - src.lc_speckle_analysis.data_config - INFO - Found 396 files for orbit D139\n2025-12-02 19:21:20,367 - src.lc_speckle_analysis.config - INFO - Found 396 satellite files\n2025-12-02 19:21:20,372 - src.lc_speckle_analysis.config - INFO - Created 198 VV/VH image pairs\n2025-12-02 19:21:20,372 - src.lc_speckle_analysis.config - INFO - Filtered to 7 image tuples for specified dates\n2025-12-02 19:21:20,372 - src.lc_speckle_analysis.config - INFO - Using 7 image tuples for processing\n2025-12-02 19:21:20,372 - src.lc_speckle_analysis.config - INFO - Filtering image tuples by bounds intersection and class availability\n2025-12-02 19:21:20,374 - src.lc_speckle_analysis.config - INFO - Training data bounds: [ 282269.80607631 5580412.27482326  671183.6318982  5968613.04092416]\n2025-12-02 19:21:20,375 - src.lc_speckle_analysis.config - INFO - Loading discarded images from cache: discarded_images_eee178ee.json\n2025-12-02 19:21:20,392 - src.lc_speckle_analysis.config - INFO - Filtered image tuples: 7 \u2192 4 (discarded 3)\n2025-12-02 19:21:20,392 - src.lc_speckle_analysis.config - INFO - Computing valid AOIs for 4 image tuples\n2025-12-02 19:21:20,393 - src.lc_speckle_analysis.config - INFO - Processing tuple 1/4: 20220611\n2025-12-02 19:21:20,393 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_30c805.gpkg\n2025-12-02 19:21:20,398 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054221_30c805: area=39991.6 km\u00b2\n2025-12-02 19:21:20,398 - src.lc_speckle_analysis.config - INFO - Processing tuple 2/4: 20220611\n2025-12-02 19:21:20,399 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_3a45d5.gpkg\n2025-12-02 19:21:20,403 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054246_3a45d5: area=40079.7 km\u00b2\n2025-12-02 19:21:20,403 - src.lc_speckle_analysis.config - INFO - Processing tuple 3/4: 20220611\n2025-12-02 19:21:20,403 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_82bc33.gpkg\n2025-12-02 19:21:20,407 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054156_82bc33: area=40050.2 km\u00b2\n2025-12-02 19:21:20,407 - src.lc_speckle_analysis.config - INFO - Processing tuple 4/4: 20220611\n2025-12-02 19:21:20,407 - src.lc_speckle_analysis.config - INFO - Loading AOI from cache for 20220611: valid_aoi_D139_S1A_IW_GRDH_20c64d.gpkg\n2025-12-02 19:21:20,411 - src.lc_speckle_analysis.config - INFO - AOI for 20220611_054131_20c64d: area=40036.3 km\u00b2\n2025-12-02 19:21:20,411 - src.lc_speckle_analysis.config - INFO - Filtering AOIs by class availability\n2025-12-02 19:21:20,421 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805 has all required classes: {1, 12, 4, 6}\n2025-12-02 19:21:20,424 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5 has all required classes: {1, 12, 4, 6}\n2025-12-02 19:21:20,434 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33 has all required classes: {1, 4, 12, 6}\n2025-12-02 19:21:20,438 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d accepted with 3/4 classes (missing: {6})\n2025-12-02 19:21:20,438 - src.lc_speckle_analysis.config - INFO - Filtered AOIs by class availability: 4 \u2192 4 (discarded 0)\n2025-12-02 19:21:20,439 - src.lc_speckle_analysis.config - INFO - Combined AOI area: 160157.8 km\u00b2\n2025-12-02 19:21:20,439 - src.lc_speckle_analysis.config - INFO - Filtering polygons by individual valid AOIs\n2025-12-02 19:21:20,449 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054221_30c805: 2072 intersecting polygons\n2025-12-02 19:21:20,451 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054246_3a45d5: 226 intersecting polygons\n2025-12-02 19:21:20,461 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054156_82bc33: 5016 intersecting polygons\n2025-12-02 19:21:20,465 - src.lc_speckle_analysis.config - INFO - AOI 20220611_054131_20c64d: 171 intersecting polygons\n2025-12-02 19:21:20,475 - src.lc_speckle_analysis.config - INFO - Filtered from 11769 to 7485 polygons (63.6% remaining)\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO - Class distribution after AOI filtering: {1: 917, 4: 3290, 6: 740, 12: 2538}\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO - Per-image intersection statistics:\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO -   20220611_054221_30c805: 2072 polygons\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO -   20220611_054246_3a45d5: 226 polygons\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO -   20220611_054156_82bc33: 5016 polygons\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO -   20220611_054131_20c64d: 171 polygons\n2025-12-02 19:21:20,476 - src.lc_speckle_analysis.config - INFO - Splitting data into train/validation/test sets\n2025-12-02 19:21:20,483 - src.lc_speckle_analysis.config - INFO - train: 4491 polygons\n2025-12-02 19:21:20,484 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 550, 4: 1974, 6: 444, 12: 1523}\n2025-12-02 19:21:20,484 - src.lc_speckle_analysis.config - INFO - validation: 1497 polygons\n2025-12-02 19:21:20,484 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 184, 4: 658, 6: 148, 12: 507}\n2025-12-02 19:21:20,484 - src.lc_speckle_analysis.config - INFO - test: 1497 polygons\n2025-12-02 19:21:20,484 - src.lc_speckle_analysis.config - INFO -   Class distribution: {1: 183, 4: 658, 6: 148, 12: 508}\n2025-12-02 19:21:20,484 - src.lc_speckle_analysis.config - INFO - Active classes for training: [1, 4, 6, 12]\n2025-12-02 19:21:20,485 - __main__ - INFO - Loading train dataset...\n2025-12-02 19:21:20,485 - src.lc_speckle_analysis.config - INFO - Loading cached patches for train mode\n2025-12-02 19:21:20,636 - src.lc_speckle_analysis.config - INFO - Loaded 1941 cached patches for 20220611 from train_aa5350f93fc9.pkl\n2025-12-02 19:21:21,579 - src.lc_speckle_analysis.config - INFO - Loaded 45163 cached patches for 20220611 from train_d7550288dd2d.pkl\n2025-12-02 19:21:22,107 - src.lc_speckle_analysis.config - INFO - Loaded 18692 cached patches for 20220611 from train_b39e7fd94ea5.pkl\n2025-12-02 19:21:22,170 - src.lc_speckle_analysis.config - INFO - Loaded 2032 cached patches for 20220611 from train_b50ca13f7f5a.pkl\n2025-12-02 19:21:22,185 - __main__ - INFO - Loaded 67828 train patches in 1.70s\n2025-12-02 19:21:22,188 - __main__ - INFO - Balancing classes to minimum count: 6852\n2025-12-02 19:21:22,188 - __main__ - INFO - Original class distribution: {1: 9214, 4: 28512, 6: 6852, 12: 23250}\n2025-12-02 19:21:22,188 - __main__ - INFO - Available patches before balancing: 67828\n2025-12-02 19:21:22,192 - __main__ - INFO - Class 1: Downsampling from 9214 to 6852 samples\n2025-12-02 19:21:22,199 - __main__ - INFO - Class 4: Downsampling from 28512 to 6852 samples\n2025-12-02 19:21:22,204 - __main__ - INFO - Class 6: Downsampling from 6852 to 6852 samples\n2025-12-02 19:21:22,211 - __main__ - INFO - Class 12: Downsampling from 23250 to 6852 samples\n2025-12-02 19:21:22,274 - __main__ - INFO - Balanced class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 19:21:22,340 - __main__ - INFO - train class distribution: {1: 6852, 4: 6852, 6: 6852, 12: 6852}\n2025-12-02 19:21:22,340 - __main__ - INFO - Total available patches: 27408\n2025-12-02 19:21:22,340 - __main__ - INFO - Loading validation dataset...\n2025-12-02 19:21:22,340 - src.lc_speckle_analysis.config - INFO - Loading cached patches for validation mode\n2025-12-02 19:21:22,354 - src.lc_speckle_analysis.config - INFO - Loaded 833 cached patches for 20220611 from validation_e46498d69852.pkl\n2025-12-02 19:21:22,711 - src.lc_speckle_analysis.config - INFO - Loaded 14869 cached patches for 20220611 from validation_ce48cae6c802.pkl\n2025-12-02 19:21:22,806 - src.lc_speckle_analysis.config - INFO - Loaded 5882 cached patches for 20220611 from validation_f1b90b36e296.pkl\n2025-12-02 19:21:22,826 - src.lc_speckle_analysis.config - INFO - Loaded 608 cached patches for 20220611 from validation_3f15ecdfbc7c.pkl\n2025-12-02 19:21:22,830 - __main__ - INFO - Loaded 22192 validation patches in 0.49s\n2025-12-02 19:21:22,831 - __main__ - INFO - Balancing classes to minimum count: 2143\n2025-12-02 19:21:22,832 - __main__ - INFO - Original class distribution: {1: 2902, 4: 9360, 6: 2143, 12: 7787}\n2025-12-02 19:21:22,832 - __main__ - INFO - Available patches before balancing: 22192\n2025-12-02 19:21:22,833 - __main__ - INFO - Class 1: Downsampling from 2902 to 2143 samples\n2025-12-02 19:21:22,835 - __main__ - INFO - Class 4: Downsampling from 9360 to 2143 samples\n2025-12-02 19:21:22,837 - __main__ - INFO - Class 6: Downsampling from 2143 to 2143 samples\n2025-12-02 19:21:22,839 - __main__ - INFO - Class 12: Downsampling from 7787 to 2143 samples\n2025-12-02 19:21:22,858 - __main__ - INFO - Balanced class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 19:21:22,873 - __main__ - INFO - validation class distribution: {1: 2143, 4: 2143, 6: 2143, 12: 2143}\n2025-12-02 19:21:22,873 - __main__ - INFO - Total available patches: 8572\n2025-12-02 19:21:22,873 - __main__ - INFO - Patch usage tracking initialized: 0/27408 patches used\n2025-12-02 19:21:22,874 - __main__ - INFO - Training batches: 857\n2025-12-02 19:21:22,874 - __main__ - INFO - Validation batches: 268\n2025-12-02 19:21:22,874 - __main__ - INFO - Starting training for 50 epochs...\n2025-12-02 19:21:22,874 - __main__ - INFO - Early stopping patience: 10 epochs\n2025-12-02 19:21:25,970 - __main__ - INFO - Epoch 1/50 (3.10s): Train Loss: 0.796737, Train Acc: 0.6468, Val Loss: 0.647839, Val Acc: 0.6941\n2025-12-02 19:21:25,985 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_1.pth\n2025-12-02 19:21:25,985 - __main__ - INFO - New best validation accuracy: 0.6941\n2025-12-02 19:21:28,793 - __main__ - INFO - Epoch 2/50 (2.81s): Train Loss: 0.714516, Train Acc: 0.6734, Val Loss: 0.634634, Val Acc: 0.7074\n2025-12-02 19:21:28,805 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_2.pth\n2025-12-02 19:21:28,805 - __main__ - INFO - New best validation accuracy: 0.7074\n2025-12-02 19:21:31,696 - __main__ - INFO - Epoch 3/50 (2.89s): Train Loss: 0.705155, Train Acc: 0.6797, Val Loss: 0.620524, Val Acc: 0.7183\n2025-12-02 19:21:31,708 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_3.pth\n2025-12-02 19:21:31,708 - __main__ - INFO - New best validation accuracy: 0.7183\n2025-12-02 19:21:34,531 - __main__ - INFO - Epoch 4/50 (2.82s): Train Loss: 0.700878, Train Acc: 0.6793, Val Loss: 0.625911, Val Acc: 0.7077\n2025-12-02 19:21:37,214 - __main__ - INFO - Epoch 5/50 (2.68s): Train Loss: 0.700995, Train Acc: 0.6821, Val Loss: 0.608099, Val Acc: 0.7201\n2025-12-02 19:21:37,226 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_5.pth\n2025-12-02 19:21:37,227 - __main__ - INFO - New best validation accuracy: 0.7201\n2025-12-02 19:21:39,950 - __main__ - INFO - Epoch 6/50 (2.72s): Train Loss: 0.695862, Train Acc: 0.6864, Val Loss: 0.617760, Val Acc: 0.7084\n2025-12-02 19:21:42,653 - __main__ - INFO - Epoch 7/50 (2.70s): Train Loss: 0.693665, Train Acc: 0.6865, Val Loss: 0.604951, Val Acc: 0.7221\n2025-12-02 19:21:42,665 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/best_model_epoch_7.pth\n2025-12-02 19:21:42,665 - __main__ - INFO - New best validation accuracy: 0.7221\n2025-12-02 19:21:45,583 - __main__ - INFO - Epoch 8/50 (2.92s): Train Loss: 0.694084, Train Acc: 0.6865, Val Loss: 0.662032, Val Acc: 0.6885\n2025-12-02 19:21:48,355 - __main__ - INFO - Epoch 9/50 (2.77s): Train Loss: 0.690416, Train Acc: 0.6875, Val Loss: 0.603690, Val Acc: 0.7208\n2025-12-02 19:21:51,169 - __main__ - INFO - Epoch 10/50 (2.81s): Train Loss: 0.690698, Train Acc: 0.6894, Val Loss: 0.698451, Val Acc: 0.6724\n2025-12-02 19:21:51,181 - __main__ - INFO - Model saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/models/checkpoint_epoch_10.pth\n2025-12-02 19:21:54,070 - __main__ - INFO - Epoch 11/50 (2.89s): Train Loss: 0.694531, Train Acc: 0.6842, Val Loss: 0.619240, Val Acc: 0.7099\n2025-12-02 19:21:56,901 - __main__ - INFO - Epoch 12/50 (2.83s): Train Loss: 0.693497, Train Acc: 0.6871, Val Loss: 0.607742, Val Acc: 0.7164\n2025-12-02 19:21:59,863 - __main__ - INFO - Epoch 13/50 (2.96s): Train Loss: 0.691723, Train Acc: 0.6863, Val Loss: 0.618182, Val Acc: 0.7140\n2025-12-02 19:22:02,805 - __main__ - INFO - Epoch 14/50 (2.94s): Train Loss: 0.688268, Train Acc: 0.6902, Val Loss: 0.606463, Val Acc: 0.7180\n2025-12-02 19:22:05,570 - __main__ - INFO - Epoch 15/50 (2.77s): Train Loss: 0.691041, Train Acc: 0.6878, Val Loss: 0.631238, Val Acc: 0.7058\n2025-12-02 19:22:08,444 - __main__ - INFO - Epoch 16/50 (2.87s): Train Loss: 0.689378, Train Acc: 0.6908, Val Loss: 0.625875, Val Acc: 0.7106\n2025-12-02 19:22:11,273 - __main__ - INFO - Epoch 17/50 (2.83s): Train Loss: 0.691228, Train Acc: 0.6906, Val Loss: 0.620858, Val Acc: 0.7123\n2025-12-02 19:22:11,273 - __main__ - INFO - Early stopping after 10 epochs without improvement\n2025-12-02 19:22:11,273 - __main__ - INFO - Training completed in 48.40s\n2025-12-02 19:22:11,273 - __main__ - INFO - Best validation accuracy: 0.7221\n2025-12-02 19:22:11,988 - __main__ - INFO - Training history plot saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/training_history_20251202_192211.png\n2025-12-02 19:22:12,637 - __main__ - INFO - Classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/logs/classification_report_20251202_192212.json\n2025-12-02 19:22:12,637 - __main__ - INFO - Classification Results:\n2025-12-02 19:22:12,637 - __main__ - INFO -   Class 1: Precision=0.536, Recall=0.582, F1=0.558\n2025-12-02 19:22:12,637 - __main__ - INFO -   Class 4: Precision=0.876, Recall=0.695, F1=0.775\n2025-12-02 19:22:12,637 - __main__ - INFO -   Class 6: Precision=0.935, Recall=0.949, F1=0.942\n2025-12-02 19:22:12,637 - __main__ - INFO -   Class 12: Precision=0.564, Recall=0.623, F1=0.592\n2025-12-02 19:22:12,845 - __main__ - INFO - Confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/confusion_matrix_20251202_192212.png\n2025-12-02 19:22:12,846 - __main__ - INFO - Starting test set evaluation...\n2025-12-02 19:22:12,846 - __main__ - INFO - Evaluating on test set...\n2025-12-02 19:22:12,846 - __main__ - INFO - Loading test dataset...\n2025-12-02 19:22:12,846 - src.lc_speckle_analysis.config - INFO - Loading cached patches for test mode\n2025-12-02 19:22:12,859 - src.lc_speckle_analysis.config - INFO - Loaded 589 cached patches for 20220611 from test_d435fe6280a1.pkl\n2025-12-02 19:22:13,266 - src.lc_speckle_analysis.config - INFO - Loaded 15342 cached patches for 20220611 from test_b0b69acfe68f.pkl\n2025-12-02 19:22:13,363 - src.lc_speckle_analysis.config - INFO - Loaded 6092 cached patches for 20220611 from test_1e32281e0ad8.pkl\n2025-12-02 19:22:13,386 - src.lc_speckle_analysis.config - INFO - Loaded 834 cached patches for 20220611 from test_6e9bc269bcdf.pkl\n2025-12-02 19:22:13,390 - __main__ - INFO - Loaded 22857 test patches in 0.54s\n2025-12-02 19:22:13,392 - __main__ - INFO - Balancing classes to minimum count: 2234\n2025-12-02 19:22:13,392 - __main__ - INFO - Original class distribution: {1: 3167, 4: 9733, 6: 2234, 12: 7723}\n2025-12-02 19:22:13,393 - __main__ - INFO - Available patches before balancing: 22857\n2025-12-02 19:22:13,394 - __main__ - INFO - Class 1: Downsampling from 3167 to 2234 samples\n2025-12-02 19:22:13,396 - __main__ - INFO - Class 4: Downsampling from 9733 to 2234 samples\n2025-12-02 19:22:13,398 - __main__ - INFO - Class 6: Downsampling from 2234 to 2234 samples\n2025-12-02 19:22:13,400 - __main__ - INFO - Class 12: Downsampling from 7723 to 2234 samples\n2025-12-02 19:22:13,418 - __main__ - INFO - Balanced class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 19:22:13,432 - __main__ - INFO - test class distribution: {1: 2234, 4: 2234, 6: 2234, 12: 2234}\n2025-12-02 19:22:13,432 - __main__ - INFO - Total available patches: 8936\n2025-12-02 19:22:13,433 - __main__ - INFO - Loaded 8936 test patches\n2025-12-02 19:22:14,132 - __main__ - INFO - Test Results: Loss=0.625701, Accuracy=0.7069\n2025-12-02 19:22:14,151 - __main__ - INFO - Test classification report saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/logs/test_classification_report_20251202_192214.json\n2025-12-02 19:22:14,360 - __main__ - INFO - Test confusion matrix saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/plots/test_confusion_matrix_20251202_192214.png\n2025-12-02 19:22:14,379 - __main__ - INFO - Training summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/training_summary_20251202_192214.json\n2025-12-02 19:22:14,382 - __main__ - INFO - Simple summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/latest_results.txt\n2025-12-02 19:22:14,382 - __main__ - INFO - \u2705 Training and evaluation completed successfully!\n2025-12-02 19:22:14,382 - __main__ - INFO - \ud83d\udcca Summary saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_0f3b0fea/training_summary_20251202_192214.json\n2025-12-02 19:22:14,382 - __main__ - INFO - \ud83d\udcc8 Patch Usage: 465936/27408 = 17.0000 (1700.00%)\n2025-12-02 19:22:14,382 - __main__ - INFO - \ud83c\udfaf Final Results: Val Acc=0.7221, Test Acc=0.7069\n",
      "return_code": 0
    },
    "config_base_mean": {
      "config_name": "config_base_mean",
      "config_path": "/home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_mean.conf",
      "start_time": 1764703340.7250156,
      "status": "failed",
      "duration": 3.8955066204071045,
      "error_message": "Process returned code 1",
      "stdout": "",
      "stderr": "2025-12-02 19:22:23,228 - __main__ - INFO - Starting TestFlat2Layers training script...\n2025-12-02 19:22:23,229 - src.lc_speckle_analysis.data_config - INFO - Reading configuration from /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_mean.conf\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Data processing config: shuffled=False, zero_mean=False, normalized=False, quantiles=False, aggregation=mean\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Training data paths: ['/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/Niedersachsen_2022/Niedersachsen_2022_InvekosDataset_c823cf0c.gpkg', '/mnt/ssddata/PbNNMod/label_preparation/classification/crop_classification/cldef_5/NRW_2022/NRW_2022_InvekosDataset_0fba3793.gpkg']\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Column ID: cora_id\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Classes: [1, 4, 6, 12]\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Data processing modus: None\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Equal class distribution: True\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Shuffle labels: False\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Orbits: ['D139']\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - Dates: ['20220611']\n2025-12-02 19:22:23,231 - src.lc_speckle_analysis.data_config - INFO - File pattern: /mnt/cephfs/data/CorDAu/S1/download/preproc_1/data/UTMZ_32N/2022/{orbit}/*.tif\n2025-12-02 19:22:23,232 - src.lc_speckle_analysis.data_config - INFO - Processing config - Workers: 4, Memory: 2048MB, Format: npz\n2025-12-02 19:22:23,232 - src.lc_speckle_analysis.data_config - INFO - Patch extraction - Per feature: 50, Per area ratio: 1.0\n2025-12-02 19:22:23,232 - src.lc_speckle_analysis.data_config - INFO - Neural network config - Patch size: 10, Batch size: 32, Architecture: LinearStatsNet\n2025-12-02 19:22:23,232 - __main__ - INFO - Using configuration from: /home/davideidmann/code/lc_specific_speckle_analysis/configs/config_base_mean.conf\n2025-12-02 19:22:23,232 - __main__ - INFO - Training Configuration:\n2025-12-02 19:22:23,232 - __main__ - INFO -   Classes: [1, 4, 6, 12]\n2025-12-02 19:22:23,232 - __main__ - INFO -   Patch size: 10\n2025-12-02 19:22:23,232 - __main__ - INFO -   Batch size: 32\n2025-12-02 19:22:23,232 - __main__ - INFO -   Architecture: LinearStatsNet\n2025-12-02 19:22:23,232 - __main__ - INFO -   Optimizer: adam\n2025-12-02 19:22:23,880 - __main__ - INFO - Using device: cuda\n2025-12-02 19:22:23,882 - __main__ - INFO - Using config hash: bdac9f26\n2025-12-02 19:22:23,882 - __main__ - INFO - Using run ID: bdac9f26\n2025-12-02 19:22:23,882 - __main__ - INFO - Training output directory: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bdac9f26\n2025-12-02 19:22:23,890 - __main__ - INFO - Configuration saved to: /mnt/ssddata/users/david/code/lc_specific_speckle_analysis/data/training_output/run_bdac9f26/config_bdac9f26.json\n2025-12-02 19:22:23,894 - __main__ - INFO - Auto-selecting linear_stats_net for statistical features (aggregation=mean)\n2025-12-02 19:22:23,894 - __main__ - ERROR - \u274c Training failed: cannot import name 'get_expected_input_size' from 'src.lc_speckle_analysis.modular_processing' (/mnt/ssddata/users/david/code/lc_specific_speckle_analysis/src/lc_speckle_analysis/modular_processing.py)\nTraceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/mnt/ssddata/users/david/code/lc_specific_speckle_analysis/src/lc_speckle_analysis/train_model.py\", line 1177, in <module>\n    main()\n  File \"/mnt/ssddata/users/david/code/lc_specific_speckle_analysis/src/lc_speckle_analysis/train_model.py\", line 1143, in main\n    trainer = ModelTrainer(config, run_id=args.run_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/ssddata/users/david/code/lc_specific_speckle_analysis/src/lc_speckle_analysis/train_model.py\", line 306, in __init__\n    self.model = self._create_model(config).to(self.device)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mnt/ssddata/users/david/code/lc_specific_speckle_analysis/src/lc_speckle_analysis/train_model.py\", line 361, in _create_model\n    from .modular_processing import get_expected_input_size\nImportError: cannot import name 'get_expected_input_size' from 'src.lc_speckle_analysis.modular_processing' (/mnt/ssddata/users/david/code/lc_specific_speckle_analysis/src/lc_speckle_analysis/modular_processing.py)\n",
      "return_code": 1
    }
  }
}